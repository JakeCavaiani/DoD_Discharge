#### READ ME ####
# The purpose of this script is to prepare DoD data for hysteresis analysis and, specifically, the hysteresisMetrics function.
# Step 1: Load in processed SUNA and EXO data from DoD_2020 script within DoD->AK Sensors->2020-> SUNA->Processed & DoD->AK Sensors->2020-> EXO->Processed 
# Step 2: fill gaps in nitrate, fDOM, SpCond, and turbidity data
# Step 3: Define baseflow in each catchment.
# Step 4: Set criteria for storm delineation for each catchment based on some percentage over baseflow.
# Step 5: Delineate storms in each catchment.
# Step 6: IN PYTHON: convert R discharge df to pandas df containing a datetime column named 'valuedatetime', and discharge values in a column 'datavalue'
# Step 7: IN PYTHON: convert R response df(s) to pandas df(s) containing a datetime column named 'valuedatetime', and response values in a column 'datavalue'


library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(plyr)
library(imputeTS)
library(TSA)
library(bbmle)
library(zoo)
library(xts)
library(forecast)
library(stats)
library(lattice)
library(nlme)
library(geosphere)
library(car)
library(EcoHydRology)

#### Load from google drive ####
#suna.2020.url <- "https://drive.google.com/drive/u/1/folders/1QGwlgWHBQI_AeLuMGNzD4qWB90UqlykK"

#SUNA_new <- drive_get(as_id(suna.2020.url))
#EXO_new <- drive_get(as_id(exo.2020.url))

#SUNA_glist <- drive_ls(SUNA_new, type = "csv")
#EXO_glist <- drive_ls(EXO_new, type = "csv")

#SUNAfile_list <- list.files(path = "")

#SUNA.ALL <- lapply(SUNA_glist)
#read.csv(SUNA_glist)

### Load from local machine ###
EXO_ALL <- read_csv("~/Documents/DoD_2020/EXO_data/from_internal_harddrive/processed/EXO.ALL.csv")

EXO_ALL$Site <- EXO_ALL$site.ID
EXO_ALL$DateTime <- as.POSIXct(EXO_ALL$DateTime)

ALL <- full_join(EXO_ALL, final_discharge_2020)

SUNA_ALL <- read_csv("~/Documents/DoD_2020/SUNA_data/from_internal_harddrive/processed/SUNA.processed.csv")
SUNA_ALL <- SUNA_ALL[, -(14:269)] # Remove channels
SUNA_ALL$Site <- SUNA_ALL$site.ID
SUNA_ALL$DateTime <- SUNA_ALL$datetimeAK

ALL <- full_join(ALL, SUNA_ALL)


#### subset data by site ####
FRCH <-  subset(ALL, Site == "FRCH")
head(FRCH$DateTime)
STRT = subset(ALL, Site == "STRT")
head(STRT$DateTime)
POKE = subset(ALL, Site == "POKE")
head(POKE$DateTime)
VAUL = subset(ALL, Site == "VAUL")
head(VAUL$DateTime)
MOOS = subset(ALL, Site == "MOOS")
head(MOOS$DateTime)

FRCH_Q = as.data.frame(Q.daily$FRCH)
FRCH_Q$day = as.Date(rownames(Q.daily))
names(FRCH_Q) = c("Discharge_Lsec", "day")
write.csv(FRCH_Q, "Predicted_Discharge/processed/FRCH_Q_2020.csv", row.names = FALSE)

STRT_Q = as.data.frame(Q.daily$STRT)
STRT_Q$day = as.Date(rownames(Q.daily))
names(STRT_Q) = c("Discharge_Lsec", "day")

POKE_Q = as.data.frame(Q.daily$POKE)
POKE_Q$day = as.Date(rownames(Q.daily))
names(POKE_Q) = c("Discharge_Lsec", "day")

VAUL_Q = as.data.frame(Q.daily$VAUL)
VAUL_Q$day = as.Date(rownames(Q.daily))
names(VAUL_Q) = c("Discharge_Lsec", "day")

MOOS_Q = as.data.frame(Q.daily$MOOS)
MOOS_Q$day = as.Date(rownames(Q.daily))
names(MOOS_Q) = c("Discharge_Lsec", "day")


#### data wrangling - fill gaps ####
# fxn #
fillgaps15 = function(df, dat, datquotes, largegap.num){
  ## Document gaps >= largegap.num (1 largegap.num = 15 min) ##
  # (note - the criteria of what constitutes a "large" gap should be reevaluated depending on the trend being characterized)
  is.na.rle <- rle(is.na(dat))
  is.na.rle$values <- is.na.rle$values & is.na.rle$lengths >= (largegap.num)
  biggaps = df[inverse.rle(is.na.rle), ]
  tz(biggaps$DateTime) = "America/Anchorage"
  biggaps = subset(biggaps, select = "DateTime")
  # Make univariate time series, covert to zoo, then to ts #
  ts.xts = subset(df, select = c("DateTime",datquotes))
  ts.xts<-read.zoo(ts.xts, index.column=1, format="%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
  ts.xts<-as.xts(ts.xts)
  # remove leading and trailing NAs #
  ts.xts = na.trim(ts.xts, is.na="any")
  # Apply auto.arima and kalman filter to impute missing values #
  fit2 = auto.arima(ts.xts) 
  kal = KalmanSmooth(ts.xts, fit2$model)
  id.na<-which(is.na(ts.xts))
  for(i in id.na) 
    ts.xts[i]<-fit2$model$Z %*% kal$smooth[i,]
  # revert to dataframe #
  ts.df = as.data.frame((ts.xts))
  ts.df$date_timeAK = as.POSIXct(row.names(ts.df), tz="America/Anchorage")
  names(ts.df) = c("dat_filled", "DateTime")
  # remove large gaps # 
  ts.df$dat_filled[ts.df$date_timeAK %in% as.POSIXct(biggaps$DateTime)] = NA
  # Replace large gaps with linear interpolation #
  ts.df$dat_filled = na.interpolation(ts.df$dat_filled)
  ts.df = subset(ts.df, select = c("dat_filled", "DateTime"))
  return(ts.df)
}


# FRCH # 
FRCH$Date <- mdy(FRCH$Date)
FRCH$DateTime <- as.POSIXct(paste(FRCH$Date, FRCH$Time), format="%Y-%m-%d %H:%M:%S") # make datetime column
head(FRCH$DateTime)
#FRCH.no3 <- subset(FRCH, select = c("DateTime","nitrateuM"))
#FRCH.no3 <-  fillgaps15(FRCH.no3, FRCH.no3$nitrateuM, "nitrateuM", 16)


FRCH.fDOM = subset(FRCH, select = c("DateTime","fDOM.QSU"))
#FRCH.fDOM = fillgaps15(FRCH.fDOM, FRCH.fDOM$fDOM.RFU, "fDOM.RFU", 16)



frch.fdom.final = aggregate(fDOM.QSU ~ DateTime, FUN=mean, data = FRCH.fDOM) # Averaging 15 minute intervals
frch.fdom.1 <- cut(FRCH.fDOM$DateTime, breaks = "15 min")
frch.fdom.final <- as.data.frame(aggregate(fDOM.QSU ~ frch.fdom.1, data = FRCH.fDOM, FUN = mean)) # Averaging 15 minute intervals
frch.fdom.final$DateTime <-as.POSIXct(frch.fdom.final$frch.fdom.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_SUNA_processed <- read_csv("~/Documents/DoD_2020/SUNA_data/from_internal_harddrive/processed/FRCH_SUNA_processed.csv") # import FRCH SUNA data 
FRCH_SUNA_processed <- FRCH_SUNA_processed[, -(14:287)]  #Removing channels

FRCH.no3 <- subset(FRCH_SUNA_processed, select = c("nitrateuM", "datetimeAK"))
FRCH.no3$DateTime <-mdy_hm(FRCH_SUNA_processed$datetimeAK, tz = "GMT") 
attributes(FRCH.no3$DateTime)$tzone <- 'America/Anchorage'

frch.no3.final <- as.data.frame(aggregate(nitrateuM ~ DateTime, data = FRCH.no3, FUN = mean)) # Averaging 15 minute intervals


FRCH = left_join(frch.final.discharge, frch.fdom.final, by="DateTime")
FRCH = left_join(FRCH, frch.no3.final, by="DateTime")
write.csv(FRCH, "Output for analysis/FRCH_final_chem_2020.csv")

#FRCH.SpCond = subset(FRCH, select = c("date_timeAK","SpCond_uScm"))
#FRCH.SpCond = fillgaps15(FRCH.SpCond, FRCH.SpCond$SpCond_uScm, "SpCond_uScm", 16)
#plot(FRCH.SpCond$dat_filled, type="l")
#plot(FRCH$SpCond.uScm ~ FRCH$Date)
#names(FRCH.SpCond) = c("SpCond_uScm_filled", "date_timeAK")

#FRCH.turb = subset(FRCH, select = c("date_timeAK","Turbidity_FNU"))
#FRCH.turb = fillgaps15(FRCH.turb, FRCH.turb$Turbidity_FNU, "Turbidity_FNU", 16)
#plot(FRCH.turb$dat_filled, type="l")
#names(FRCH.turb) = c("Turbidity_FNU_filled", "date_timeAK")

#
### STRT ###
STRT.no3 <- subset(STRT, select = c("DateTime", "nitrateuM"))
plot(STRT.no3$dat_filled, type="l")
names(STRT.no3) = c("DateTime", "nitrateuM")

STRT.fDOM = subset(STRT, select = c("DateTime","fDOM.QSU"))
#STRT.fDOM.1 = fillgaps15(strt.fdom.final, strt.fdom.final$fDOM.QSU, "fDOM.QSU", 16)
plot(STRT$dat_filled, type="l")
names(STRT.fDOM) = c("DateTime", "fDOM.QSU")
str(STRT.fDOM)
#strt.fdom.1 <- STRT.fDOM[, list]
#data[,list(avg=mean(temperature)),by=hour]

strt.fdom.final = aggregate(fDOM.QSU ~ DateTime, FUN=mean, data = STRT.fDOM) # Averaging 15 minute intervals



strt.no3.1 <- cut(STRT.no3$DateTime, breaks="15 min")
strt.no3.final <- as.data.frame(aggregate(nitrateuM ~ strt.no3.1, data = STRT.no3, FUN = mean)) # Averaging 15 minute intervals
strt.no3.final$DateTime <-as.POSIXct(strt.no3.final$strt.no3.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

#STRT.no3.1 = fillgaps15(strt.no3.final, strt.no3.final$nitrateuM, "nitrateuM", 16)

STRT = left_join(strt.final.discharge, strt.fdom.final, by="DateTime")
STRT = left_join(STRT, strt.no3.final, by="DateTime")

write.csv(STRT, "Output for analysis/STRT_final_chem_2020.csv")

### POKE ### 
POKE.no3 <- subset(POKE, select = c("DateTime", "nitrateuM"))
POKE.no3 <- POKE.no3[!is.na(POKE.no3$DateTime), ]
#POKE.no3.fill.gaps <-  fillgaps15(poke.no3.final, poke.no3.final$nitrateuM, "nitrateuM", 16)
#plot(POKE.no3$dat_filled, type="l")
#names(POKE.no3) = c("nitrate_uM_filled", "DateTime")

POKE.fDOM = subset(POKE, select = c("DateTime","fDOM.RFU"))
#POKE.fDOM = fillgaps15(POKE.fDOM, POKE.fDOM$fDOM.RFU, "fDOM.RFU", 16)
plot(POKE$dat_filled, type="l")
names(POKE.fDOM) = c("DateTime", "fDOM.RFU")

poke.fdom.1 <- cut(POKE.fDOM$DateTime, breaks = "15 min")
poke.fdom.final <- as.data.frame(aggregate(fDOM.RFU ~ poke.fdom.1, data = POKE.fDOM, FUN = mean)) # Averaging 15 minute intervals
poke.fdom.final$DateTime <-as.POSIXct(poke.fdom.final$poke.fdom.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


poke.no3.1 <- cut(POKE.no3$DateTime, breaks="15 min")
poke.no3.final <- as.data.frame(aggregate(nitrateuM ~ poke.no3.1, data = POKE.no3, FUN = mean)) # Averaging 15 minute intervals
poke.no3.final$DateTime <-as.POSIXct(poke.no3.final$poke.no3.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


POKE = left_join(poke.final.discharge, poke.fdom.final, by="DateTime")
POKE = left_join(POKE, poke.no3.final, by="DateTime")


### VAUL ### 
VAUL.no3 <- subset(VAUL, select = c("DateTime", "nitrateuM"))
#plot(VAUL.no3$dat_filled, type="l")
#names(VAUL.no3) = c("nitrate_uM_filled", "DateTime")

VAUL.fDOM = subset(VAUL, select = c("DateTime","fDOM.QSU"))
#VAUL.fDOM = fillgaps15(VAUL.fDOM, VAUL.fDOM$fDOM.RFU, "fDOM.RFU", 16)
#plot(VAUL$dat_filled, type="l")
#names(VAUL.fDOM) = c("DateTime", "fDOM.QSU")

vaul.fdom.final = aggregate(fDOM.QSU ~ DateTime, FUN=mean, data = VAUL.fDOM) # Averaging 15 minute intervals


vaul.no3.1 <- cut(VAUL.no3$DateTime, breaks="15 min")
vaul.no3.final <- as.data.frame(aggregate(nitrateuM ~ vaul.no3.1, data = VAUL.no3, FUN = mean)) # Averaging 15 minute intervals
vaul.no3.final$DateTime <-as.POSIXct(vaul.no3.final$vaul.no3.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

#VAUL.no3.2 <-  fillgaps15(vaul.no3.final, vaul.no3.final$nitrateuM, "nitrateuM", 16)

VAUL = left_join(vaul.final.discharge, vaul.fdom.final, by="DateTime")
VAUL = left_join(VAUL, vaul.no3.final, by="DateTime")

write.csv(VAUL, "Output for analysis/VAUL_final_chem_2020.csv")

### MOOS ###
MOOS.no3 <- subset(MOOS, select = c("DateTime", "nitrateuM"))
#MOOS.no3 <-  fillgaps15(MOOS.no3, MOOS.no3$nitrateuM, "nitrateuM", 16)
plot(MOOS.no3$dat_filled, type="l")


MOOS.fDOM = subset(MOOS, select = c("DateTime","fDOM.QSU"))
names(MOOS.fDOM) = c("DateTime", "fDOM.QSU")
#MOOS.fDOM = fillgaps15(MOOS.fDOM, MOOS.fDOM$fDOM.QSU, "fDOM.QSU", 16)
plot(MOOS$dat_filled, type="l")

moos.fdom.final = aggregate(fDOM.QSU ~ DateTime, FUN = mean, data = MOOS.fDOM) # averaging every burst at 15 min intervals




moos.no3.1 <- cut(MOOS.no3$DateTime, breaks="15 min")
moos.no3.final <- as.data.frame(aggregate(nitrateuM ~ moos.no3.1, data = MOOS.no3, FUN = mean)) # Averaging 15 minute intervals
moos.no3.final$DateTime <-as.POSIXct(moos.no3.final$moos.no3.1, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


MOOS = left_join(moos.final.discharge, moos.fdom.final, by="DateTime")
MOOS = left_join(MOOS, moos.no3.final, by="DateTime")

write.csv(MOOS, "Output for analysis/MOOS_final_chem_2020.csv")


#### Baseflow Separation ####

any(is.na(FRCH_Q$day))
any(is.na(FRCH_Q$Discharge_Lsec))
FRCH_Q <- na.omit(FRCH_Q) # Remove 7 NaNs  # 132 rows to 125 rows

any(is.na(STRT_Q$day))
any(is.na(STRT_Q$Discharge_Lsec))
STRT_Q <- na.omit(STRT_Q) # Remove 19 NaNs

any(is.na(POKE_Q$day))
any(is.na(POKE_Q$Discharge_Lsec))
POKE_Q <- na.omit(POKE_Q) # Remove 4 NaNs

any(is.na(VAUL_Q$day))
any(is.na(VAUL_Q$Discharge_Lsec))
VAUL_Q <- na.omit(VAUL_Q) # Remove 21 NaNs

any(is.na(MOOS_Q$day))
any(is.na(MOOS_Q$Discharge_Lsec))
MOOS_Q <- na.omit(MOOS_Q) # Remove 11 NaNs


### examine the recursive digital filter at .9, .925, .95 levels ###
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type = "l", xlab = "", ylab = "Q (L/sec)",
    xlim =  as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
    ylim = c(0, 3000), col="blue")
#
plot(poke.final.discharge$MeanDischarge ~ poke.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(0,3000), col="blue")

plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(0,3000), col="blue")

plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(0,3000), col="blue")

plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(0,3000), col="blue")

### Hydrograph Separation ###
#
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(FRCH_Q, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt) 

#
strt.final.discharge <- strt.final.discharge[-c(10815:10817), ] # clean Nas.


STRT_Q_bf = BaseflowSeparation(strt.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(STRT_Q, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(POKE_Q, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt) 
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(VAUL_Q, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt) 

MOOS_Q_bf = BaseflowSeparation(moos.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(MOOS_Q, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt) 

###.925 ###
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(FRCH_Q, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt) 
#
STRT_Q_bf = BaseflowSeparation(strt.final.discharge$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(STRT_Q, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(POKE_Q, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt) 
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(VAUL_Q, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt) 

MOOS_Q_bf = BaseflowSeparation(moos.final.discharge$MeanDischarge, filter_parameter = 0.925, passes = 3)
hydrograph(input=subset(MOOS_Q, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt) 


### .95 ###
FRCH_Q_bf = BaseflowSeparation(frch.final.discharge$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(FRCH_Q, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt) 
#
STRT_Q_bf = BaseflowSeparation(strt.final.discharge$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(STRT_Q, select = c(day, Discharge_Lsec)), streamflow2=STRT_Q_bf$bt)
#
POKE_Q_bf = BaseflowSeparation(poke.final.discharge$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(POKE_Q, select = c(day, Discharge_Lsec)), streamflow2=POKE_Q_bf$bt) 
#
VAUL_Q_bf = BaseflowSeparation(vaul.final.discharge$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(VAUL_Q, select = c(day, Discharge_Lsec)), streamflow2=VAUL_Q_bf$bt) 

MOOS_Q_bf = BaseflowSeparation(moos.final.discharge$MeanDischarge, filter_parameter = 0.95, passes = 3)
hydrograph(input=subset(MOOS_Q, select = c(day, Discharge_Lsec)), streamflow2=MOOS_Q_bf$bt) 


#### Deliniate storms in FRCH ####

# ID storms: Any events where Q reached 2X mean base flow 
# Pick starting points: manually select inflection pt when Q began to rise
# Pick ending points: manually select pt when Q reached pre-storm baseflow OR when another event occurred


FRCH_bfQ_mn = mean(FRCH_Q_bf$bt)
FRCH_bfQ_mn
FRCH_bfQ_mn*2

STRT_bfQ_mn = mean(STRT_Q_bf$bt)
STRT_bfQ_mn
STRT_bfQ_mn*2

VAUL_bfQ_mn = mean(VAUL_Q_bf$bt)
VAUL_bfQ_mn
VAUL_bfQ_mn*2

POKE_bfQ_mn = mean(POKE_Q_bf$bt)
POKE_bfQ_mn
POKE_bfQ_mn*2

MOOS_bfQ_mn = mean(MOOS_Q_bf$bt)
MOOS_bfQ_mn
MOOS_bfQ_mn*2

### Merge Discharge and Precip ###
frch.precip.discharge <- full_join(frch.final.discharge, FRCH.st) # merging precip data and discharge
strt.precip.discharge <- full_join(strt.final.discharge, STRT.st.final) # merging precip data and discharge
vaul.precip.discharge <- full_join(vaul.final.discharge, VAUL.st.final) # merging precip data and discharge
poke.precip.discharge <- full_join(poke.final.discharge, poke.gauge) # merging precip data and discharge


### Sum daily discharge ###
frch.precip.discharge <- frch.precip.discharge[-c(1:3),] # Remove out of water discharge
frch.precip.discharge$twentyfour <- rollapplyr(frch.precip.discharge$inst_rainfall_mm, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
frch.precip.discharge$fourtyeight <- rollapplyr(frch.precip.discharge$inst_rainfall_mm, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)

strt.precip.discharge$twentyfour <- rollapplyr(strt.precip.discharge$Precip, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
strt.precip.discharge$fourtyeight <- rollapplyr(strt.precip.discharge$Precip, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)

vaul.precip.discharge$twentyfour <- rollapplyr(vaul.precip.discharge$inst_rainfall_mm, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
vaul.precip.discharge$fourtyeight <- rollapplyr(vaul.precip.discharge$inst_rainfall_mm, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)

poke.precip.discharge$twentyfour <- rollapplyr(poke.precip.discharge$Precip, 96, sum, na.rm = TRUE, fill = NA, partial = TRUE)
poke.precip.discharge$fourtyeight <- rollapplyr(poke.precip.discharge$Precip, 192, sum, na.rm = TRUE, fill = NA, partial = TRUE)

# Greater than 5 #
frch.five.twenty.four <- frch.precip.discharge[which(frch.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
frch.five.fourty.eight <- frch.precip.discharge[which(frch.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10

strt.five.twenty.four <- strt.precip.discharge[which(strt.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
strt.five.fourty.eight <- strt.precip.discharge[which(strt.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10

vaul.five.twenty.four <- vaul.precip.discharge[which(vaul.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
vaul.five.fourty.eight <- vaul.precip.discharge[which(vaul.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10

poke.five.twenty.four <- poke.precip.discharge[which(poke.precip.discharge$twentyfour >= 5),] # twenty four hour period where the precip is 5
poke.five.fourty.eight <- poke.precip.discharge[which(poke.precip.discharge$fourtyeight >= 5),] # fourty eight hour period where the precip is greater than 10


# Greater than 10 #
frch.ten.twenty.four <- frch.precip.discharge[which(frch.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
frch.ten.fourty.eight <- frch.precip.discharge[which(frch.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10

strt.ten.twenty.four <- strt.precip.discharge[which(strt.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
strt.ten.fourty.eight <- strt.precip.discharge[which(strt.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10

vaul.ten.twenty.four <- vaul.precip.discharge[which(vaul.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
vaul.ten.fourty.eight <- vaul.precip.discharge[which(vaul.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10

poke.ten.twenty.four <- poke.precip.discharge[which(poke.precip.discharge$twentyfour >= 10),] # twenty four hour period where the precip is 10
poke.ten.fourty.eight <- poke.precip.discharge[which(poke.precip.discharge$fourtyeight >= 10),] # fourty eight hour period where the precip is greater than 10

write.csv(frch.precip.discharge, "frch.precip.discharge.csv", row.names = FALSE)
write.csv(strt.precip.discharge, "strt.precip.discharge.csv", row.names = FALSE)
write.csv(vaul.precip.discharge, "vaul.precip.discharge.csv", row.names = FALSE)
write.csv(poke.precip.discharge, "poke.precip.discharge.csv", row.names = FALSE)

#
#frch.gauge$date <- as.Date(frch.gauge$DateTime)# breaking into days
#daily.sum <- aggregate(frch.gauge["inst_rainfall_mm"], by = frch.gauge["date"], sum) # summing days
#frch.ten <- daily.sum[which(daily.sum$inst_rainfall_mm >= 10),] # anything greater than 10 is filtered 

#strt.gauge$date <- as.Date(strt.gauge$DateTime)
#strt.daily.sum <- aggregate(strt.gauge["inst_rainfall_mm"], by = strt.gauge["date"], sum)
#strt.ten <- strt.daily.sum[which(strt.daily.sum$inst_rainfall_mm >= 10),]

#vaul.gauge$date <- as.Date(vaul.gauge$DateTime)
#vaul.daily.sum <- aggregate(vaul.gauge["inst_rainfall_mm"], by = vaul.gauge["date"], sum)
#vaul.ten <- vaul.daily.sum[which(vaul.daily.sum$inst_rainfall_mm >= 10),]
#par(mfrow=c(1,1))

#precip.cariboupeak$date <- as.Date(precip.cariboupeak$DateTime)
#poke.daily.sum <- aggregate(precip.cariboupeak["Precip"], by = precip.cariboupeak["date"], sum)
#poke.ten <- poke.daily.sum[which(poke.daily.sum$Precip >= 10),]


#plot(FRCH_Q$Discharge_Lsec ~ FRCH_Q$day, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="FRCH")
#lines(FRCH_Q_bf$bt ~ FRCH_Q$day, col="red")
#lines(FRCH_Q_bf$bt*1.3 ~ FRCH_Q$day, col="red", lty = 2)
#lines((FRCH_Q_bf$bt*5) ~ FRCH_Q$day, col="red", lty=2)
#abline(h = FRCH_bfQ_mn*2, col="red", lty=2)

### Discharge/Chem/Precip ###
# FRCH #
### Import precipitation data into the *ALL document ### 
# FRCH rain gauge installed on the 11th of June. 
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(20,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
par(mfrow=c(1,1))
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(25,0), 
     axes=F, xlab="", ylab="")
par(new = T)

plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
lines(FRCH$nitrateuM * 20 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"))
lines(FRCH$fDOM.QSU * 10 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"))


### Storms ###
# FRCH #
#Storm 1 
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-10 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-13 11:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-18 13:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm1_06_13 = FRCH[FRCH$DateTime > as.POSIXct("2020-06-13 11:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-06-18 13:30:00", tz="America/Anchorage"),]
plot(FRCH_storm1_06_13$MeanDischarge ~ as.POSIXct(FRCH_storm1_06_13$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="FRCH 200613 storm 1",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 2 
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-10 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-19 02:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-20 06:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm2_06_19 = FRCH[FRCH$DateTime > as.POSIXct("2020-06-19 02:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-06-20 06:30:00", tz="America/Anchorage"),]
plot(FRCH_storm2_06_19$MeanDischarge ~ as.POSIXct(FRCH_storm2_06_19$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="FRCH 200619 storm 2",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 3a 
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-10 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-20 08:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm3a_06_20 = FRCH[FRCH$DateTime > as.POSIXct("2020-06-20 08:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage"),]
plot(FRCH_storm3a_06_20$MeanDischarge ~ as.POSIXct(FRCH_storm3a_06_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,2000), col="blue", main="FRCH 200620 storm 3a",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 3b
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-10 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-28 04:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm3b_06_22 = FRCH[FRCH$DateTime > as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-06-28 04:30:00", tz="America/Anchorage"),]
plot(FRCH_storm3b_06_22$MeanDischarge ~ as.POSIXct(FRCH_storm3b_06_22$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1250,2250), col="blue", main="FRCH 200622 storm 3b",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 3c
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-10 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-28 04:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-29 10:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm3c_06_28 = FRCH[FRCH$DateTime > as.POSIXct("2020-06-28 04:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-06-29 10:30:00", tz="America/Anchorage"),]
plot(FRCH_storm3c_06_28$MeanDischarge ~ as.POSIXct(FRCH_storm3c_06_28$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2000), col="blue", main="FRCH 200628 storm 3c",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-10 0:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 4a
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-07 13:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-09 10:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm4a_07_07 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-07 13:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-07-09 10:30:00", tz="America/Anchorage"),]
plot(FRCH_storm4a_07_07$MeanDischarge ~ as.POSIXct(FRCH_storm4a_07_07$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2000), col="blue", main="FRCH 200707 storm 4a",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 4b
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-09 11:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-11 20:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm4b_07_09 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-09 11:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-07-11 20:30:00", tz="America/Anchorage"),]
plot(FRCH_storm4b_07_09$MeanDischarge ~ as.POSIXct(FRCH_storm4b_07_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(800,1500), col="blue", main="FRCH 200709 storm 4b",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 5
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
lines(FRCH$nitrateuM * 20 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
lines(FRCH$fDOM.QSU * 10 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))

par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-16 02:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-16 11:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm5_07_16 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-16 02:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-07-16 11:30:00", tz="America/Anchorage"),]
plot(FRCH_storm5_07_16$MeanDischarge ~ as.POSIXct(FRCH_storm5_07_16$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1000), col="blue", main="FRCH 200716 storm 5",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 6
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
lines(FRCH$nitrateuM * 20 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
lines(FRCH$fDOM.QSU * 10 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-17 12:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-19 12:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm6_07_17 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-17 12:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-07-19 12:30:00", tz="America/Anchorage"),]
plot(FRCH_storm6_07_17$MeanDischarge ~ as.POSIXct(FRCH_storm6_07_17$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1000), col="blue", main="FRCH 200717 storm 6",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#Storm 7
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
lines(FRCH$nitrateuM * 20 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
lines(FRCH$fDOM.QSU * 10 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-20 12:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-24 00:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm7_07_20 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-20 12:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-07-24 00:30:00", tz="America/Anchorage"),]
plot(FRCH_storm7_07_20$MeanDischarge ~ as.POSIXct(FRCH_storm7_07_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="FRCH 200720 storm 7",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 8
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")
lines(FRCH$nitrateuM * 20 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
lines(FRCH$fDOM.QSU * 10 ~ FRCH$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-26 08:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-30 00:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm8_07_26 = FRCH[FRCH$DateTime > as.POSIXct("2020-07-26 08:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-07-30 00:30:00", tz="America/Anchorage"),]
plot(FRCH_storm8_07_26$MeanDischarge ~ as.POSIXct(FRCH_storm8_07_26$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="FRCH 200726 storm 8",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9a
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-01 12:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-02 20:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm9a_08_01 = FRCH[FRCH$DateTime > as.POSIXct("2020-08-01 12:30:00", tz="America/Anchorage") &
                           FRCH$DateTime < as.POSIXct("2020-08-02 20:30:00", tz="America/Anchorage"),]
plot(FRCH_storm9a_08_01$MeanDischarge ~ as.POSIXct(FRCH_storm9a_08_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1500), col="blue", main="FRCH 200801 storm 9a",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9b
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-02 23:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-05 20:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm9b_08_02 = FRCH[FRCH$DateTime > as.POSIXct("2020-08-02 23:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-08-05 20:30:00", tz="America/Anchorage"),]
plot(FRCH_storm9b_08_02$MeanDischarge ~ as.POSIXct(FRCH_storm9b_08_02$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1500), col="blue", main="FRCH 200802 storm 9b",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 10a
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-09 10:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-12 06:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm10a_08_09 = FRCH[FRCH$DateTime > as.POSIXct("2020-08-09 10:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-08-12 06:30:00", tz="America/Anchorage"),]
plot(FRCH_storm10a_08_09$MeanDischarge ~ as.POSIXct(FRCH_storm10a_08_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1500), col="blue", main="FRCH 200809 storm 10a",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 10b
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-17 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-17 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-12 08:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-16 23:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm10b_08_12 = FRCH[FRCH$DateTime > as.POSIXct("2020-08-12 08:30:00", tz="America/Anchorage") &
                             FRCH$DateTime < as.POSIXct("2020-08-16 23:30:00", tz="America/Anchorage"),]
plot(FRCH_storm10b_08_12$MeanDischarge ~ as.POSIXct(FRCH_storm10b_08_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1500), col="blue", main="FRCH 200812 storm 10b",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-17 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-31 00:00:00","2020-08-17 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 11
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-20 08:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-21 11:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm11_08_20 = FRCH[FRCH$DateTime > as.POSIXct("2020-08-20 08:30:00", tz="America/Anchorage") &
                             FRCH$DateTime < as.POSIXct("2020-08-21 11:30:00", tz="America/Anchorage"),]
plot(FRCH_storm11_08_20$MeanDischarge ~ as.POSIXct(FRCH_storm11_08_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1000), col="blue", main="FRCH 200820 storm 11",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 12
plot(FRCH$MeanDischarge ~ FRCH$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=FRCH_bfQ_mn*2, col="red", lty=2)
abline(h=FRCH_bfQ_mn, col="red")

par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-06 16:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-07 15:30:00", tz="America/Anchorage"), col="purple")

FRCH_storm12_09_06 = FRCH[FRCH$DateTime > as.POSIXct("2020-09-06 16:30:00", tz="America/Anchorage") &
                            FRCH$DateTime < as.POSIXct("2020-09-07 15:30:00", tz="America/Anchorage"),]
plot(FRCH_storm12_09_06$MeanDischarge ~ as.POSIXct(FRCH_storm12_09_06$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(400,1000), col="blue", main="FRCH 200906 storm 12",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#### modify format and save FRCH storms ####

# nitrateuM, fDOM.QSU 

FRCH_storm1_06_13_Q = subset(FRCH_storm1_06_13, select = c("DateTime", "MeanDischarge"))

FRCH_storm1_06_13_Q = subset(FRCH_storm1_06_13, select = c("DateTime","MeanDischarge"))
names(FRCH_storm1_06_13_Q) = c("valuedatetime","datavalue")
FRCH_storm1_06_13_NO3 = subset(FRCH_storm1_06_13, select = c("DateTime","nitrateuM"))
names(FRCH_storm1_06_13_NO3) = c("valuedatetime","datavalue")
FRCH_storm1_06_13_fDOM = subset(FRCH_storm1_06_13, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm1_06_13_fDOM) = c("valuedatetime","datavalue")

FRCH_storm1_06_13_Q$valuedatetime <-as.POSIXct(FRCH_storm1_06_13_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm1_06_13_NO3$valuedatetime <-as.POSIXct(FRCH_storm1_06_13_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm1_06_13_fDOM$valuedatetime <-as.POSIXct(FRCH_storm1_06_13_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm2_06_19_Q = subset(FRCH_storm2_06_19, select = c("DateTime","MeanDischarge"))
names(FRCH_storm2_06_19_Q) = c("valuedatetime","datavalue")
FRCH_storm2_06_19_NO3 = subset(FRCH_storm2_06_19, select = c("DateTime","nitrateuM"))
names(FRCH_storm2_06_19_NO3) = c("valuedatetime","datavalue")
FRCH_storm2_06_19_fDOM = subset(FRCH_storm2_06_19, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm2_06_19_fDOM) = c("valuedatetime","datavalue")

FRCH_storm2_06_19_Q$valuedatetime <-as.POSIXct(FRCH_storm2_06_19_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm2_06_19_NO3$valuedatetime <-as.POSIXct(FRCH_storm2_06_19_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm2_06_19_fDOM$valuedatetime <-as.POSIXct(FRCH_storm2_06_19_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm3a_06_20_Q = subset(FRCH_storm3a_06_20, select = c("DateTime","MeanDischarge"))
names(FRCH_storm3a_06_20_Q) = c("valuedatetime","datavalue")
FRCH_storm3a_06_20_NO3 = subset(FRCH_storm3a_06_20, select = c("DateTime","nitrateuM"))
names(FRCH_storm3a_06_20_NO3) = c("valuedatetime","datavalue")
FRCH_storm3a_06_20_fDOM = subset(FRCH_storm3a_06_20, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm3a_06_20_fDOM) = c("valuedatetime","datavalue")

FRCH_storm3a_06_20_Q$valuedatetime <-as.POSIXct(FRCH_storm3a_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3a_06_20_NO3$valuedatetime <-as.POSIXct(FRCH_storm3a_06_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3a_06_20_fDOM$valuedatetime <-as.POSIXct(FRCH_storm3a_06_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm3b_06_22_Q = subset(FRCH_storm3b_06_22, select = c("DateTime","MeanDischarge"))
names(FRCH_storm3b_06_22_Q) = c("valuedatetime","datavalue")
FRCH_storm3b_06_22_NO3 = subset(FRCH_storm3b_06_22, select = c("DateTime","nitrateuM"))
names(FRCH_storm3b_06_22_NO3) = c("valuedatetime","datavalue")
FRCH_storm3b_06_22_fDOM = subset(FRCH_storm3b_06_22, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm3b_06_22_fDOM) = c("valuedatetime","datavalue")

FRCH_storm3b_06_22_Q$valuedatetime <-as.POSIXct(FRCH_storm3b_06_22_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3b_06_22_NO3$valuedatetime <-as.POSIXct(FRCH_storm3b_06_22_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3b_06_22_fDOM$valuedatetime <-as.POSIXct(FRCH_storm3b_06_22_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm3c_06_28_Q = subset(FRCH_storm3c_06_28, select = c("DateTime","MeanDischarge"))
names(FRCH_storm3c_06_28_Q) = c("valuedatetime","datavalue")
FRCH_storm3c_06_28_NO3 = subset(FRCH_storm3c_06_28, select = c("DateTime","nitrateuM"))
names(FRCH_storm3c_06_28_NO3) = c("valuedatetime","datavalue")
FRCH_storm3c_06_28_fDOM = subset(FRCH_storm3c_06_28, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm3c_06_28_fDOM) = c("valuedatetime","datavalue")

FRCH_storm3c_06_28_Q$valuedatetime <-as.POSIXct(FRCH_storm3c_06_28_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3c_06_28_NO3$valuedatetime <-as.POSIXct(FRCH_storm3c_06_28_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm3c_06_28_fDOM$valuedatetime <-as.POSIXct(FRCH_storm3c_06_28_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm4a_07_07_Q = subset(FRCH_storm4a_07_07, select = c("DateTime","MeanDischarge"))
names(FRCH_storm4a_07_07_Q) = c("valuedatetime","datavalue")
FRCH_storm4a_07_07_NO3 = subset(FRCH_storm4a_07_07, select = c("DateTime","nitrateuM"))
names(FRCH_storm4a_07_07_NO3) = c("valuedatetime","datavalue")
FRCH_storm4a_07_07_fDOM = subset(FRCH_storm4a_07_07, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm4a_07_07_fDOM) = c("valuedatetime","datavalue")

FRCH_storm4a_07_07_Q$valuedatetime <-as.POSIXct(FRCH_storm4a_07_07_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm4a_07_07_NO3$valuedatetime <-as.POSIXct(FRCH_storm4a_07_07_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm4a_07_07_fDOM$valuedatetime <-as.POSIXct(FRCH_storm4a_07_07_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm4b_07_09_Q = subset(FRCH_storm4b_07_09, select = c("DateTime","MeanDischarge"))
names(FRCH_storm4b_07_09_Q) = c("valuedatetime","datavalue")
FRCH_storm4b_07_09_NO3 = subset(FRCH_storm4b_07_09, select = c("DateTime","nitrateuM"))
names(FRCH_storm4b_07_09_NO3) = c("valuedatetime","datavalue")
FRCH_storm4b_07_09_fDOM = subset(FRCH_storm4b_07_09, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm4b_07_09_fDOM) = c("valuedatetime","datavalue")

FRCH_storm4b_07_09_Q$valuedatetime <-as.POSIXct(FRCH_storm4b_07_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm4b_07_09_NO3$valuedatetime <-as.POSIXct(FRCH_storm4b_07_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm4b_07_09_fDOM$valuedatetime <-as.POSIXct(FRCH_storm4b_07_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm5_07_16_Q = subset(FRCH_storm5_07_16, select = c("DateTime","MeanDischarge"))
names(FRCH_storm5_07_16_Q) = c("valuedatetime","datavalue")
FRCH_storm5_07_16_NO3 = subset(FRCH_storm5_07_16, select = c("DateTime","nitrateuM"))
names(FRCH_storm5_07_16_NO3) = c("valuedatetime","datavalue")
FRCH_storm5_07_16_fDOM = subset(FRCH_storm5_07_16, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm5_07_16_fDOM) = c("valuedatetime","datavalue")

FRCH_storm5_07_16_Q$valuedatetime <-as.POSIXct(FRCH_storm5_07_16_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm5_07_16_NO3$valuedatetime <-as.POSIXct(FRCH_storm5_07_16_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm5_07_16_fDOM$valuedatetime <-as.POSIXct(FRCH_storm5_07_16_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm6_07_17_Q = subset(FRCH_storm6_07_17, select = c("DateTime","MeanDischarge"))
names(FRCH_storm6_07_17_Q) = c("valuedatetime","datavalue")
FRCH_storm6_07_17_NO3 = subset(FRCH_storm6_07_17, select = c("DateTime","nitrateuM"))
names(FRCH_storm6_07_17_NO3) = c("valuedatetime","datavalue")
FRCH_storm6_07_17_fDOM = subset(FRCH_storm6_07_17, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm6_07_17_fDOM) = c("valuedatetime","datavalue")

FRCH_storm6_07_17_Q$valuedatetime <-as.POSIXct(FRCH_storm6_07_17_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm6_07_17_NO3$valuedatetime <-as.POSIXct(FRCH_storm6_07_17_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm6_07_17_fDOM$valuedatetime <-as.POSIXct(FRCH_storm6_07_17_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm7_07_20_Q = subset(FRCH_storm7_07_20, select = c("DateTime","MeanDischarge"))
names(FRCH_storm7_07_20_Q) = c("valuedatetime","datavalue")
FRCH_storm7_07_20_NO3 = subset(FRCH_storm7_07_20, select = c("DateTime","nitrateuM"))
names(FRCH_storm7_07_20_NO3) = c("valuedatetime","datavalue")
FRCH_storm7_07_20_fDOM = subset(FRCH_storm7_07_20, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm7_07_20_fDOM) = c("valuedatetime","datavalue")

FRCH_storm7_07_20_Q$valuedatetime <-as.POSIXct(FRCH_storm7_07_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm7_07_20_NO3$valuedatetime <-as.POSIXct(FRCH_storm7_07_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm7_07_20_fDOM$valuedatetime <-as.POSIXct(FRCH_storm7_07_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm8_07_26_Q = subset(FRCH_storm8_07_26, select = c("DateTime","MeanDischarge"))
names(FRCH_storm8_07_26_Q) = c("valuedatetime","datavalue")
FRCH_storm8_07_26_NO3 = subset(FRCH_storm8_07_26, select = c("DateTime","nitrateuM"))
names(FRCH_storm8_07_26_NO3) = c("valuedatetime","datavalue")
FRCH_storm8_07_26_fDOM = subset(FRCH_storm8_07_26, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm8_07_26_fDOM) = c("valuedatetime","datavalue")

FRCH_storm8_07_26_Q$valuedatetime <-as.POSIXct(FRCH_storm8_07_26_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm8_07_26_NO3$valuedatetime <-as.POSIXct(FRCH_storm8_07_26_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm8_07_26_fDOM$valuedatetime <-as.POSIXct(FRCH_storm8_07_26_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm9a_08_01_Q = subset(FRCH_storm9a_08_01, select = c("DateTime","MeanDischarge"))
names(FRCH_storm9a_08_01_Q) = c("valuedatetime","datavalue")
FRCH_storm9a_08_01_NO3 = subset(FRCH_storm9a_08_01, select = c("DateTime","nitrateuM"))
names(FRCH_storm9a_08_01_NO3) = c("valuedatetime","datavalue")
FRCH_storm9a_08_01_fDOM = subset(FRCH_storm9a_08_01, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm9a_08_01_fDOM) = c("valuedatetime","datavalue")

FRCH_storm9a_08_01_Q$valuedatetime <-as.POSIXct(FRCH_storm9a_08_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm9a_08_01_NO3$valuedatetime <-as.POSIXct(FRCH_storm9a_08_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm9a_08_01_fDOM$valuedatetime <-as.POSIXct(FRCH_storm9a_08_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm9b_08_02_Q = subset(FRCH_storm9b_08_02, select = c("DateTime","MeanDischarge"))
names(FRCH_storm9b_08_02_Q) = c("valuedatetime","datavalue")
FRCH_storm9b_08_02_NO3 = subset(FRCH_storm9b_08_02, select = c("DateTime","nitrateuM"))
names(FRCH_storm9b_08_02_NO3) = c("valuedatetime","datavalue")
FRCH_storm9b_08_02_fDOM = subset(FRCH_storm9b_08_02, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm9b_08_02_fDOM) = c("valuedatetime","datavalue")

FRCH_storm9b_08_02_Q$valuedatetime <-as.POSIXct(FRCH_storm9b_08_02_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm9b_08_02_NO3$valuedatetime <-as.POSIXct(FRCH_storm9b_08_02_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm9b_08_02_fDOM$valuedatetime <-as.POSIXct(FRCH_storm9b_08_02_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm10a_08_09_Q = subset(FRCH_storm10a_08_09, select = c("DateTime","MeanDischarge"))
names(FRCH_storm10a_08_09_Q) = c("valuedatetime","datavalue")
FRCH_storm10a_08_09_NO3 = subset(FRCH_storm10a_08_09, select = c("DateTime","nitrateuM"))
names(FRCH_storm10a_08_09_NO3) = c("valuedatetime","datavalue")
FRCH_storm10a_08_09_fDOM = subset(FRCH_storm10a_08_09, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm10a_08_09_fDOM) = c("valuedatetime","datavalue")

FRCH_storm10a_08_09_Q$valuedatetime <-as.POSIXct(FRCH_storm10a_08_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm10a_08_09_NO3$valuedatetime <-as.POSIXct(FRCH_storm10a_08_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm10a_08_09_fDOM$valuedatetime <-as.POSIXct(FRCH_storm10a_08_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm10b_08_12_Q = subset(FRCH_storm10b_08_12, select = c("DateTime","MeanDischarge"))
names(FRCH_storm10b_08_12_Q) = c("valuedatetime","datavalue")
FRCH_storm10b_08_12_NO3 = subset(FRCH_storm10b_08_12, select = c("DateTime","nitrateuM"))
names(FRCH_storm10b_08_12_NO3) = c("valuedatetime","datavalue")
FRCH_storm10b_08_12_fDOM = subset(FRCH_storm10b_08_12, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm10b_08_12_fDOM) = c("valuedatetime","datavalue")

FRCH_storm10b_08_12_Q$valuedatetime <-as.POSIXct(FRCH_storm10b_08_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm10b_08_12_NO3$valuedatetime <-as.POSIXct(FRCH_storm10b_08_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm10b_08_12_fDOM$valuedatetime <-as.POSIXct(FRCH_storm10b_08_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm11_08_20_Q = subset(FRCH_storm11_08_20, select = c("DateTime","MeanDischarge"))
names(FRCH_storm11_08_20_Q) = c("valuedatetime","datavalue")
FRCH_storm11_08_20_NO3 = subset(FRCH_storm11_08_20, select = c("DateTime","nitrateuM"))
names(FRCH_storm11_08_20_NO3) = c("valuedatetime","datavalue")
FRCH_storm11_08_20_fDOM = subset(FRCH_storm11_08_20, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm11_08_20_fDOM) = c("valuedatetime","datavalue")

FRCH_storm11_08_20_Q$valuedatetime <-as.POSIXct(FRCH_storm11_08_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm11_08_20_NO3$valuedatetime <-as.POSIXct(FRCH_storm11_08_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm11_08_20_fDOM$valuedatetime <-as.POSIXct(FRCH_storm11_08_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

FRCH_storm12_09_06_Q = subset(FRCH_storm12_09_06, select = c("DateTime","MeanDischarge"))
names(FRCH_storm12_09_06_Q) = c("valuedatetime","datavalue")
FRCH_storm12_09_06_NO3 = subset(FRCH_storm12_09_06, select = c("DateTime","nitrateuM"))
names(FRCH_storm12_09_06_NO3) = c("valuedatetime","datavalue")
FRCH_storm12_09_06_fDOM = subset(FRCH_storm12_09_06, select = c("DateTime","fDOM.QSU"))
names(FRCH_storm12_09_06_fDOM) = c("valuedatetime","datavalue")

FRCH_storm12_09_06_Q$valuedatetime <-as.POSIXct(FRCH_storm12_09_06_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm12_09_06_NO3$valuedatetime <-as.POSIXct(FRCH_storm12_09_06_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
FRCH_storm12_09_06_fDOM$valuedatetime <-as.POSIXct(FRCH_storm12_09_06_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


### Write csv ###
write.csv(FRCH_storm1_06_13, "Storms/FRCH_storm1_06_13.csv")
write.csv(FRCH_storm1_06_13_Q, "Storms/FRCH_storm1_06_13_Q.csv")
write.csv(FRCH_storm1_06_13_NO3, "Storms/FRCH_storm1_06_13_NO3.csv")
write.csv(FRCH_storm1_06_13_fDOM, "Storms/FRCH_storm1_06_13_fDOM.csv")

write.csv(FRCH_storm2_06_19, "Storms/FRCH_storm2_06_19.csv")
write.csv(FRCH_storm2_06_19_Q, "Storms/FRCH_storm2_06_19_Q.csv")
write.csv(FRCH_storm2_06_19_NO3, "Storms/FRCH_storm2_06_19_NO3.csv")
write.csv(FRCH_storm2_06_19_fDOM, "Storms/FRCH_storm2_06_19_fDOM.csv")

write.csv(FRCH_storm3a_06_20, "Storms/FRCH_storm3a_06_20.csv")
write.csv(FRCH_storm3a_06_20_Q, "Storms/FRCH_storm3a_06_20_Q.csv")
write.csv(FRCH_storm3a_06_20_NO3, "Storms/FRCH_storm3a_06_20_NO3.csv")
write.csv(FRCH_storm3a_06_20_fDOM, "Storms/FRCH_storm3a_06_20_fDOM.csv")

write.csv(FRCH_storm3b_06_22, "Storms/FRCH_storm3b_06_22.csv")
write.csv(FRCH_storm3b_06_22_Q, "Storms/FRCH_storm3b_06_22_Q.csv")
write.csv(FRCH_storm3b_06_22_NO3, "Storms/FRCH_storm3b_06_22_NO3.csv")
write.csv(FRCH_storm3b_06_22_fDOM, "Storms/FRCH_storm3b_06_22_fDOM.csv")

write.csv(FRCH_storm3c_06_28, "Storms/FRCH_storm3c_06_28.csv")
write.csv(FRCH_storm3c_06_28_Q, "Storms/FRCH_storm3c_06_28_Q.csv")
write.csv(FRCH_storm3c_06_28_NO3, "Storms/FRCH_storm3c_06_28_NO3.csv")
write.csv(FRCH_storm3c_06_28_fDOM, "Storms/FRCH_storm3c_06_28_fDOM.csv")

write.csv(FRCH_storm4a_07_07, "Storms/FRCH_storm4a_07_07.csv")
write.csv(FRCH_storm4a_07_07_Q, "Storms/FRCH_storm4a_07_07_Q.csv")
write.csv(FRCH_storm4a_07_07_NO3, "Storms/FRCH_storm4a_07_07_NO3.csv")
write.csv(FRCH_storm4a_07_07_fDOM, "Storms/FRCH_storm4a_07_07_fDOM.csv")

write.csv(FRCH_storm4b_07_09, "Storms/FRCH_storm4b_07_09.csv")
write.csv(FRCH_storm4b_07_09_Q, "Storms/FRCH_storm4b_07_09_Q.csv")
write.csv(FRCH_storm4b_07_09_NO3, "Storms/FRCH_storm4b_07_09_NO3.csv")
write.csv(FRCH_storm4b_07_09_fDOM, "Storms/FRCH_storm4b_07_09_fDOM.csv")

write.csv(FRCH_storm5_07_16, "Storms/FRCH_storm5_07_16.csv")
write.csv(FRCH_storm5_07_16_Q, "Storms/FRCH_storm5_07_16_Q.csv")
write.csv(FRCH_storm5_07_16_NO3, "Storms/FRCH_storm5_07_16_NO3.csv")
write.csv(FRCH_storm5_07_16_fDOM, "Storms/FRCH_storm5_07_16_fDOM.csv")

write.csv(FRCH_storm6_07_17, "Storms/FRCH_storm6_07_17.csv")
write.csv(FRCH_storm6_07_17_Q, "Storms/FRCH_storm6_07_17_Q.csv")
write.csv(FRCH_storm6_07_17_NO3, "Storms/FRCH_storm6_07_17_NO3.csv")
write.csv(FRCH_storm6_07_17_fDOM, "Storms/FRCH_storm6_07_17_fDOM.csv")

write.csv(FRCH_storm7_07_20, "Storms/FRCH_storm7_07_20.csv")
write.csv(FRCH_storm7_07_20_Q, "Storms/FRCH_storm7_07_20_Q.csv")
write.csv(FRCH_storm7_07_20_NO3, "Storms/FRCH_storm7_07_20_NO3.csv")
write.csv(FRCH_storm7_07_20_fDOM, "Storms/FRCH_storm7_07_20_fDOM.csv")

write.csv(FRCH_storm8_07_26, "Storms/FRCH_storm8_07_26.csv")
write.csv(FRCH_storm8_07_26_Q, "Storms/FRCH_storm8_07_26_Q.csv")
write.csv(FRCH_storm8_07_26_NO3, "Storms/FRCH_storm8_07_26_NO3.csv")
write.csv(FRCH_storm8_07_26_fDOM, "Storms/FRCH_storm8_07_26_fDOM.csv")

write.csv(FRCH_storm9a_08_01, "Storms/FRCH_storm9a_08_016.csv")
write.csv(FRCH_storm9a_08_01_Q, "Storms/FRCH_storm9a_08_01_Q.csv")
write.csv(FRCH_storm9a_08_01_NO3, "Storms/FRCH_storm9a_08_01_NO3.csv")
write.csv(FRCH_storm9a_08_01_fDOM, "Storms/FRCH_storm9a_08_01_fDOM.csv")

write.csv(FRCH_storm9b_08_02, "Storms/FRCH_storm9b_08_02.csv")
write.csv(FRCH_storm9b_08_02_Q, "Storms/FRCH_storm9b_08_02_Q.csv")
write.csv(FRCH_storm9b_08_02_NO3, "Storms/FRCH_storm9b_08_02_NO3.csv")
write.csv(FRCH_storm9b_08_02_fDOM, "Storms/FRCH_storm9b_08_02_fDOM.csv")

write.csv(FRCH_storm10a_08_09, "Storms/FRCH_storm10a_08_09.csv")
write.csv(FRCH_storm10a_08_09_Q, "Storms/FRCH_storm10a_08_09_Q.csv")
write.csv(FRCH_storm10a_08_09_NO3, "Storms/FRCH_storm10a_08_09_NO3.csv")
write.csv(FRCH_storm10a_08_09_fDOM, "Storms/FRCH_storm10a_08_09_fDOM.csv")

write.csv(FRCH_storm10b_08_12, "Storms/FRCH_storm10b_08_12.csv")
write.csv(FRCH_storm10b_08_12_Q, "Storms/FRCH_storm10b_08_12_Q.csv")
write.csv(FRCH_storm10b_08_12_NO3, "Storms/FRCH_storm10b_08_12_NO3.csv")
write.csv(FRCH_storm10b_08_12_fDOM, "Storms/FRCH_storm10b_08_12_fDOM.csv")

write.csv(FRCH_storm11_08_20, "Storms/FRCH_storm11_08_20.csv")
write.csv(FRCH_storm11_08_20_Q, "Storms/FRCH_storm11_08_20_Q.csv")
write.csv(FRCH_storm11_08_20_NO3, "Storms/FRCH_storm11_08_20_NO3.csv")
write.csv(FRCH_storm11_08_20_fDOM, "Storms/FRCH_storm11_08_20_fDOM.csv")

write.csv(FRCH_storm12_09_06, "Storms/FRCH_storm12_09_060.csv")
write.csv(FRCH_storm12_09_06_Q, "Storms/FRCH_storm12_09_06_Q.csv")
write.csv(FRCH_storm12_09_06_NO3, "Storms/FRCH_storm12_09_06_NO3.csv")
write.csv(FRCH_storm12_09_06_fDOM, "Storms/FRCH_storm12_09_06_fDOM.csv")

# STRT #
# STRT rain gauge installed on the 29th of July #
plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-05 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'STRT precip. (mm)') 
par(new = T)
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)


abline(v = as.POSIXct(strt.ten.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.ten.twenty.four$DateTime), col="green", lwd = 0.1)
par(new = T)
plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-05 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
par(new = T)
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage")) 
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
lines(STRT$nitrateuM * 45 ~ STRT.no3$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))
lines(STRT$fDOM.QSU * 20 ~ STRT.fDOM$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))
plot(x = STRT.no3$DateTime, y = STRT$nitrateuM)

### Storms ###
# STRT #
# Storm 1a #
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)

plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-19 02:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-20 05:30:00", tz="America/Anchorage"), col="purple")

STRT_storm1_06_19 = STRT[STRT$DateTime > as.POSIXct("2020-06-19 00:00:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-06-28 20:00:00", tz="America/Anchorage"),]
plot(STRT_storm1_06_19$MeanDischarge ~ as.POSIXct(STRT_storm1_06_19$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2700), col="blue", main="STRT 200619 storm 1",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))

STRT_storm1a_06_19 = STRT[STRT$DateTime > as.POSIXct("2020-06-19 02:30:00", tz="America/Anchorage") &
                  STRT$DateTime < as.POSIXct("2020-06-20 05:30:00", tz="America/Anchorage"),]
plot(STRT_storm1a_06_19$MeanDischarge ~ as.POSIXct(STRT_storm1a_06_19$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200619 storm 1a",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 1b #
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-20 06:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-21 22:00:00", tz="America/Anchorage"), col="purple")

STRT_storm1b_06_20 = STRT[STRT$DateTime > as.POSIXct("2020-06-20 06:30:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-06-21 22:00:00", tz="America/Anchorage"),]
plot(STRT_storm1b_06_20$MeanDischarge ~ as.POSIXct(STRT_storm1b_06_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2700), col="blue", main="STRT 200619 storm 1b",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
par(new = T)
plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 1c #
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-23 03:00:00", tz="America/Anchorage"), col="purple")

STRT_storm1c_06_22 = STRT[STRT$DateTime > as.POSIXct("2020-06-22 00:30:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-06-23 03:00:00", tz="America/Anchorage"),]
plot(STRT_storm1c_06_22$MeanDischarge ~ as.POSIXct(STRT_storm1c_06_22$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(2000,2700), col="blue", main="STRT 200619 storm 1c",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)


# Storm 1d #
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-23 05:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-24 02:00:00", tz="America/Anchorage"), col="purple")

STRT_storm1d_06_23 = STRT[STRT$DateTime > as.POSIXct("2020-06-23 05:15:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-06-24 02:00:00", tz="America/Anchorage"),]
plot(STRT_storm1d_06_23$MeanDischarge ~ as.POSIXct(STRT_storm1d_06_23$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(2400,2700), col="blue", main="STRT 200619 storm 1d",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 1e #
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-19 00:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-24 05:45:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-28 18:00:00", tz="America/Anchorage"), col="purple")

STRT_storm1e_06_24 = STRT[STRT$DateTime > as.POSIXct("2020-06-24 05:45:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-06-28 18:00:00", tz="America/Anchorage"),]
plot(STRT_storm1e_06_24$MeanDischarge ~ as.POSIXct(STRT_storm1e_06_24$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,2700), col="blue", main="STRT 200619 storm 1e",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-19 0:00:00","2020-06-28 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)



# Alarm 2? # No discharge response
plot(STRT$MeanDischarge ~ STRT$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-28 00:00:00","2020-07-06 23:45:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)
lines(STRT$fDOM.QSU * 40 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-28 00:00:00","2020-07-06 20:00:00"), tz="America/Anchorage"))
lines(STRT$nitrateuM * 50 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-28 00:00:00","2020-07-06 20:00:00"), tz="America/Anchorage"))

par(new = T)

plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-28 0:00:00","2020-07-06 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
#abline(v= as.POSIXct("2020-06-24 02:15:00", tz="America/Anchorage"), col="purple")
#abline(v= as.POSIXct("2020-06-28 18:00:00", tz="America/Anchorage"), col="purple")


# Storm 2 #
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-07 00:00:00","2020-07-14 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-07 0:00:00","2020-07-14 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-09 10:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-11 00:00:00", tz="America/Anchorage"), col="purple")

STRT_storm2_07_09 = STRT[STRT$DateTime > as.POSIXct("2020-07-09 10:15:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-07-11 00:00:00", tz="America/Anchorage"),]
plot(STRT_storm2_07_09$MeanDischarge ~ as.POSIXct(STRT_storm2_07_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-07-07 0:00:00","2020-07-14 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-07 0:00:00","2020-07-14 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Alarm 3 # No response in discharge or chemistry
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-15 00:00:00","2020-07-20 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
lines(STRT$nitrateuM * 50 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-15 00:00:00","2020-07-20 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-15 0:00:00","2020-07-20 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)


abline(v= as.POSIXct("2020-07-09 10:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-11 00:00:00", tz="America/Anchorage"), col="purple")

# Storm 3 # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
lines(STRT$nitrateuM * 50 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
par(new = T)

plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-20 0:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-21 00:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-26 00:00:00", tz="America/Anchorage"), col="purple")

STRT_storm3_07_21 = STRT[STRT$DateTime > as.POSIXct("2020-07-21 00:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-07-26 00:00:00", tz="America/Anchorage"),]
plot(STRT_storm3_07_21$MeanDischarge ~ as.POSIXct(STRT_storm3_07_21$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-07-20 0:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-20 0:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4a # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-01 07:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-03 02:30:00", tz="America/Anchorage"), col="purple")

STRT_storm4a_08_01 = STRT[STRT$DateTime > as.POSIXct("2020-08-01 07:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-08-03 02:30:00", tz="America/Anchorage"),]
plot(STRT_storm4a_08_01$MeanDischarge ~ as.POSIXct(STRT_storm4a_08_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4b # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-03 04:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-06 03:00:00", tz="America/Anchorage"), col="purple")

STRT_storm4b_08_03 = STRT[STRT$DateTime > as.POSIXct("2020-08-03 04:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-08-06 03:00:00", tz="America/Anchorage"),]
plot(STRT_storm4b_08_03$MeanDischarge ~ as.POSIXct(STRT_storm4b_08_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-06 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 5 # Small response in discharge
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-06 00:00:00","2020-08-12 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-06 0:00:00","2020-08-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-09 05:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-12 02:00:00", tz="America/Anchorage"), col="purple")

STRT_storm5_08_09 = STRT[STRT$DateTime > as.POSIXct("2020-08-09 05:15:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-08-12 02:00:00", tz="America/Anchorage"),]
plot(STRT_storm5_08_09$MeanDischarge ~ as.POSIXct(STRT_storm5_08_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-06 0:00:00","2020-08-12 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-06 0:00:00","2020-08-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 6 # Small response in discharge
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-12 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-12 0:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-12 03:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-13 09:00:00", tz="America/Anchorage"), col="purple")

STRT_storm6_08_12 = STRT[STRT$DateTime > as.POSIXct("2020-08-12 03:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-08-13 09:00:00", tz="America/Anchorage"),]
plot(STRT_storm6_08_12$MeanDischarge ~ as.POSIXct(STRT_storm6_08_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-12 0:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-12 0:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7a # two storms
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-20 00:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-20 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-21 07:00:00", tz="America/Anchorage"), col="purple")

STRT_storm7a_08_20 = STRT[STRT$DateTime > as.POSIXct("2020-08-20 08:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-08-21 07:00:00", tz="America/Anchorage"),]
plot(STRT_storm7a_08_20$MeanDischarge ~ as.POSIXct(STRT_storm7a_08_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7b # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-20 00:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-21 09:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-22 07:00:00", tz="America/Anchorage"), col="purple")

STRT_storm7b_08_21 = STRT[STRT$DateTime > as.POSIXct("2020-08-21 09:00:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-08-22 07:00:00", tz="America/Anchorage"),]
plot(STRT_storm7b_08_21$MeanDischarge ~ as.POSIXct(STRT_storm7b_08_21$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-08-23 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)


# Storm 8 # Looks like there is a response after the 26th of August???
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-23 00:00:00","2020-09-01 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
lines(STRT$nitrateuM * 50 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
lines(STRT$fDOM.QSU * 20 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
par(new = T)

plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-23 0:00:00","2020-09-01 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-28 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-30 05:00:00", tz="America/Anchorage"), col="purple")

STRT_storm8_08_28= STRT[STRT$DateTime > as.POSIXct("2020-08-28 08:15:00", tz="America/Anchorage") &
                            STRT$DateTime < as.POSIXct("2020-08-30 05:00:00", tz="America/Anchorage"),]
plot(STRT_storm8_08_28$MeanDischarge ~ as.POSIXct(STRT_storm8_08_28$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-08-23 0:00:00","2020-09-01 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-23 0:00:00","2020-09-01 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9a # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 0:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-03 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-06 07:00:00", tz="America/Anchorage"), col="purple")

STRT_storm9a_09_03= STRT[STRT$DateTime > as.POSIXct("2020-09-03 08:15:00", tz="America/Anchorage") &
                          STRT$DateTime < as.POSIXct("2020-09-06 07:00:00", tz="America/Anchorage"),]
plot(STRT_storm9a_09_03$MeanDischarge ~ as.POSIXct(STRT_storm9a_09_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9b # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 0:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-06 22:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-07 23:00:00", tz="America/Anchorage"), col="purple")

STRT_storm9b_09_06= STRT[STRT$DateTime > as.POSIXct("2020-09-06 22:15:00", tz="America/Anchorage") &
                          STRT$DateTime < as.POSIXct("2020-09-07 23:00:00", tz="America/Anchorage"),]
plot(STRT_storm9b_09_06$MeanDischarge ~ as.POSIXct(STRT_storm9b_09_06$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-12 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9c # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-14 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 0:00:00","2020-09-14 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-09 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-14 07:00:00", tz="America/Anchorage"), col="purple")

STRT_storm9c_09_09= STRT[STRT$DateTime > as.POSIXct("2020-09-09 08:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-09-14 07:00:00", tz="America/Anchorage"),]
plot(STRT_storm9c_09_09$MeanDischarge ~ as.POSIXct(STRT_storm9c_09_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,2000), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-14 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-14 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Alarm 9.5 #  NO discharge or chem influence 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-13 00:00:00","2020-09-20 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
lines(STRT$nitrateuM * 50 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))
lines(STRT$fDOM.QSU * 20 ~ STRT$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-20 00:00:00","2020-07-27 20:00:00"), tz="America/Anchorage"))


par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-13 0:00:00","2020-09-20 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-09 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-12 20:00:00", tz="America/Anchorage"), col="purple")

# Storm 10 # 
plot(strt.final.discharge$MeanDischarge ~ strt.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-21 00:00:00","2020-09-30 20:00:00"), tz="America/Anchorage"))
abline(h=STRT_bfQ_mn*2, col="red", lty=2)
abline(h=STRT_bfQ_mn, col="red")
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-21 0:00:00","2020-09-30 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(strt.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(strt.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-23 18:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-26 12:00:00", tz="America/Anchorage"), col="purple")

STRT_storm10_09_23= STRT[STRT$DateTime > as.POSIXct("2020-09-23 18:15:00", tz="America/Anchorage") &
                           STRT$DateTime < as.POSIXct("2020-09-26 12:00:00", tz="America/Anchorage"),]
plot(STRT_storm10_09_23$MeanDischarge ~ as.POSIXct(STRT_storm10_09_23$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,1600), col="blue", main="STRT 200709 storm 2",
     xlim = as.POSIXct(c("2020-09-21 0:00:00","2020-09-30 20:00:00"), tz="America/Anchorage"))
par(new = T)


plot(STRT.st.final$Precip ~ STRT.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-21 0:00:00","2020-09-30 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

#### modify format and save STRT storms ####

# nitrateuM, fDOM.QSU 
#Storm 1 6-19-6-28 #
STRT_storm1_06_19_Q = subset(STRT_storm1_06_19, select = c("DateTime", "MeanDischarge"))

STRT_storm1a_06_19_Q = subset(STRT_storm1a_06_19, select = c("DateTime","MeanDischarge"))
names(STRT_storm1a_06_19_Q) = c("valuedatetime","datavalue")
STRT_storm1a_06_19_NO3 = subset(STRT_storm1a_06_19, select = c("DateTime","nitrateuM"))
names(STRT_storm1a_06_19_NO3) = c("valuedatetime","datavalue")
STRT_storm1a_06_19_fDOM = subset(STRT_storm1a_06_19, select = c("DateTime","fDOM.QSU"))
names(STRT_storm1a_06_19_fDOM) = c("valuedatetime","datavalue")

STRT_storm1a_06_19_Q$valuedatetime <-as.POSIXct(STRT_storm1a_06_19_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1a_06_19_NO3$valuedatetime <-as.POSIXct(STRT_storm1a_06_19_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1a_06_19_fDOM$valuedatetime <-as.POSIXct(STRT_storm1a_06_19_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

STRT_storm1b_06_20_Q = subset(STRT_storm1b_06_20, select = c("DateTime","MeanDischarge"))
names(STRT_storm1b_06_20_Q) = c("valuedatetime","datavalue")
STRT_storm1b_06_20_NO3 = subset(STRT_storm1b_06_20, select = c("DateTime","nitrateuM"))
names(STRT_storm1b_06_20_NO3) = c("valuedatetime","datavalue")
STRT_storm1b_06_20_fDOM = subset(STRT_storm1b_06_20, select = c("DateTime","fDOM.QSU"))
names(STRT_storm1b_06_20_Q) = c("valuedatetime","datavalue")

STRT_storm1b_06_20_Q$valuedatetime <-as.POSIXct(STRT_storm1b_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1b_06_20_NO3$valuedatetime <-as.POSIXct(STRT_storm1b_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1b_06_20_fDOM$valuedatetime <-as.POSIXct(STRT_storm1b_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")



STRT_storm1c_06_22_Q = subset(STRT_storm1c_06_22, select = c("DateTime","MeanDischarge"))
names(STRT_storm1c_06_22_Q) = c("valuedatetime","datavalue")
STRT_storm1c_06_22_NO3 = subset(STRT_storm1c_06_22, select = c("DateTime","nitrateuM"))
names(STRT_storm1c_06_22_NO3) = c("valuedatetime","datavalue")
STRT_storm1c_06_22_fDOM = subset(STRT_storm1c_06_22, select = c("DateTime","fDOM.QSU"))
names(STRT_storm1c_06_22_fDOM) = c("valuedatetime","datavalue")

STRT_storm1c_06_22_Q$valuedatetime <-as.POSIXct(STRT_storm1c_06_22_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1c_06_22_NO3$valuedatetime <-as.POSIXct(STRT_storm1c_06_22_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1c_06_22_fDOM$valuedatetime <-as.POSIXct(STRT_storm1c_06_22_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


STRT_storm1d_06_23_Q = subset(STRT_storm1d_06_23, select = c("DateTime","MeanDischarge"))
names(STRT_storm1d_06_23_Q) = c("valuedatetime","datavalue")
STRT_storm1d_06_23_Q$valuedatetime <-as.POSIXct(STRT_storm1d_06_23_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1d_06_23_NO3 = subset(STRT_storm1d_06_23, select = c("DateTime","nitrateuM"))
names(STRT_storm1d_06_23_NO3) = c("valuedatetime","datavalue")
STRT_storm1d_06_23_fDOM = subset(STRT_storm1d_06_23, select = c("DateTime","fDOM.QSU"))
names(STRT_storm1d_06_23_fDOM) = c("valuedatetime","datavalue")

STRT_storm1d_06_23_Q$valuedatetime <-as.POSIXct(STRT_storm1d_06_23_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1d_06_23_NO3$valuedatetime <-as.POSIXct(STRT_storm1d_06_23_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1d_06_23_fDOM$valuedatetime <-as.POSIXct(STRT_storm1d_06_23_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


STRT_storm1e_06_24_Q = subset(STRT_storm1e_06_24, select = c("DateTime","MeanDischarge"))
names(STRT_storm1e_06_24_Q) = c("valuedatetime","datavalue")
STRT_storm1e_06_24_NO3 = subset(STRT_storm1e_06_24, select = c("DateTime","nitrateuM"))
names(STRT_storm1e_06_24_NO3) = c("valuedatetime","datavalue")
STRT_storm1e_06_24_fDOM = subset(STRT_storm1e_06_24, select = c("DateTime","fDOM.QSU"))
names(STRT_storm1e_06_24_fDOM) = c("valuedatetime","datavalue")

STRT_storm1e_06_24_Q$valuedatetime <-as.POSIXct(STRT_storm1e_06_24_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1e_06_24_NO3$valuedatetime <-as.POSIXct(STRT_storm1e_06_24_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm1e_06_24_fDOM$valuedatetime <-as.POSIXct(STRT_storm1e_06_24_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 2 # 
STRT_storm2_07_09_Q = subset(STRT_storm2_07_09, select = c("DateTime","MeanDischarge"))
names(STRT_storm2_07_09_Q) = c("valuedatetime","datavalue")
STRT_storm2_07_09_NO3 = subset(STRT_storm2_07_09, select = c("DateTime", "nitrateuM"))
names(STRT_storm2_07_09_NO3) = c("valuedatetime","datavalue")
STRT_storm2_07_09_fDOM = subset(STRT_storm2_07_09, select = c("DateTime","fDOM.QSU"))
names(STRT_storm2_07_09_fDOM) = c("valuedatetime","datavalue")

STRT_storm2_07_09_Q$valuedatetime <-as.POSIXct(STRT_storm2_07_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm2_07_09_NO3$valuedatetime <-as.POSIXct(STRT_storm2_07_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm2_07_09_fDOM$valuedatetime <-as.POSIXct(STRT_storm2_07_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 3 #
STRT_storm3_07_21_Q = subset(STRT_storm3_07_21, select = c("DateTime","MeanDischarge"))
names(STRT_storm3_07_21_Q) = c("valuedatetime","datavalue")
STRT_storm3_07_21_NO3 = subset(STRT_storm3_07_21, select = c("DateTime", "nitrateuM"))
names(STRT_storm3_07_21_NO3) = c("valuedatetime","datavalue")
STRT_storm3_07_21_fDOM = subset(STRT_storm3_07_21, select = c("DateTime","fDOM.QSU"))
names(STRT_storm3_07_21_fDOM) = c("valuedatetime","datavalue")

STRT_storm3_07_21_Q$valuedatetime <-as.POSIXct(STRT_storm3_07_21_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm3_07_21_NO3$valuedatetime <-as.POSIXct(STRT_storm3_07_21_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm3_07_21_fDOM$valuedatetime <-as.POSIXct(STRT_storm3_07_21_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 4 #
STRT_storm4a_08_01_Q = subset(STRT_storm4a_08_01, select = c("DateTime","MeanDischarge"))
names(STRT_storm4a_08_01_Q) = c("valuedatetime","datavalue")
STRT_storm4a_08_01_NO3 = subset(STRT_storm4a_08_01, select = c("DateTime", "nitrateuM"))
names(STRT_storm4a_08_01_NO3) = c("valuedatetime","datavalue")
STRT_storm4a_08_01_fDOM = subset(STRT_storm4a_08_01, select = c("DateTime","fDOM.QSU"))
names(STRT_storm4a_08_01_fDOM) = c("valuedatetime","datavalue")

STRT_storm4b_08_03_Q = subset(STRT_storm4b_08_03, select = c("DateTime","MeanDischarge"))
names(STRT_storm4b_08_03_Q) = c("valuedatetime","datavalue")
STRT_storm4b_08_03_NO3 = subset(STRT_storm4b_08_03, select = c("DateTime", "nitrateuM"))
names(STRT_storm4b_08_03_NO3) = c("valuedatetime","datavalue")
STRT_storm4b_08_03_fDOM = subset(STRT_storm4b_08_03, select = c("DateTime","fDOM.QSU"))
names(STRT_storm4b_08_03_fDOM) = c("valuedatetime","datavalue")

STRT_storm4a_08_01_Q$valuedatetime <-as.POSIXct(STRT_storm4a_08_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm4a_08_01_NO3$valuedatetime <-as.POSIXct(STRT_storm4a_08_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm4a_08_01_fDOM$valuedatetime <-as.POSIXct(STRT_storm4a_08_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

STRT_storm4b_08_03_Q$valuedatetime <-as.POSIXct(STRT_storm4b_08_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm4b_08_03_NO3$valuedatetime <-as.POSIXct(STRT_storm4b_08_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm4b_08_03_fDOM$valuedatetime <-as.POSIXct(STRT_storm4b_08_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 5 #
STRT_storm5_08_09_Q = subset(STRT_storm5_08_09, select = c("DateTime","MeanDischarge"))
names(STRT_storm5_08_09_Q) = c("valuedatetime","datavalue")
STRT_storm5_08_09_NO3 = subset(STRT_storm5_08_09, select = c("DateTime", "nitrateuM"))
names(STRT_storm5_08_09_NO3) = c("valuedatetime","datavalue")
STRT_storm5_08_09_fDOM = subset(STRT_storm5_08_09, select = c("DateTime","fDOM.QSU"))
names(STRT_storm5_08_09_fDOM) = c("valuedatetime","datavalue")

STRT_storm5_08_09_Q$valuedatetime <-as.POSIXct(STRT_storm5_08_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm5_08_09_NO3$valuedatetime <-as.POSIXct(STRT_storm5_08_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm5_08_09_fDOM$valuedatetime <-as.POSIXct(STRT_storm5_08_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 6 #
STRT_storm6_08_12_Q = subset(STRT_storm6_08_12, select = c("DateTime","MeanDischarge"))
names(STRT_storm6_08_12_Q) = c("valuedatetime","datavalue")
STRT_storm6_08_12_NO3 = subset(STRT_storm6_08_12, select = c("DateTime", "nitrateuM"))
names(STRT_storm6_08_12_NO3) = c("valuedatetime","datavalue")
STRT_storm6_08_12_fDOM = subset(STRT_storm6_08_12, select = c("DateTime","fDOM.QSU"))
names(STRT_storm6_08_12_fDOM) = c("valuedatetime","datavalue")

STRT_storm6_08_12_Q$valuedatetime <-as.POSIXct(STRT_storm6_08_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm6_08_12_NO3$valuedatetime <-as.POSIXct(STRT_storm6_08_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm6_08_12_fDOM$valuedatetime <-as.POSIXct(STRT_storm6_08_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 7 #
STRT_storm7a_08_20_Q = subset(STRT_storm7a_08_20, select = c("DateTime","MeanDischarge"))
names(STRT_storm7a_08_20_Q) = c("valuedatetime","datavalue")
STRT_storm7a_08_20_NO3 = subset(STRT_storm7a_08_20, select = c("DateTime", "nitrateuM"))
names(STRT_storm7a_08_20_NO3) = c("valuedatetime","datavalue")
STRT_storm7a_08_20_fDOM = subset(STRT_storm7a_08_20, select = c("DateTime","fDOM.QSU"))
names(STRT_storm7a_08_20_fDOM) = c("valuedatetime","datavalue")

STRT_storm7b_08_21_Q = subset(STRT_storm7b_08_21, select = c("DateTime","MeanDischarge"))
names(STRT_storm7b_08_21_Q) = c("valuedatetime","datavalue")
STRT_storm7b_08_21_NO3 = subset(STRT_storm7b_08_21, select = c("DateTime", "nitrateuM"))
names(STRT_storm7b_08_21_NO3) = c("valuedatetime","datavalue")
STRT_storm7b_08_21_fDOM = subset(STRT_storm7b_08_21, select = c("DateTime","fDOM.QSU"))
names(STRT_storm7b_08_21_fDOM) = c("valuedatetime","datavalue")

STRT_storm7a_08_20_Q$valuedatetime <-as.POSIXct(STRT_storm7a_08_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm7a_08_20_NO3$valuedatetime <-as.POSIXct(STRT_storm7a_08_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm7a_08_20_fDOM$valuedatetime <-as.POSIXct(STRT_storm7a_08_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

STRT_storm7b_08_21_Q$valuedatetime <-as.POSIXct(STRT_storm7b_08_21_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm7b_08_21_NO3$valuedatetime <-as.POSIXct(STRT_storm7b_08_21_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm7b_08_21_fDOM$valuedatetime <-as.POSIXct(STRT_storm7b_08_21_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 8 #
STRT_storm8_08_28_Q = subset(STRT_storm8_08_28, select = c("DateTime","MeanDischarge"))
names(STRT_storm8_08_28_Q) = c("valuedatetime","datavalue")
STRT_storm8_08_28_NO3 = subset(STRT_storm8_08_28, select = c("DateTime", "nitrateuM"))
names(STRT_storm8_08_28_NO3) = c("valuedatetime","datavalue")
STRT_storm8_08_28_fDOM = subset(STRT_storm8_08_28, select = c("DateTime","fDOM.QSU"))
names(STRT_storm8_08_28_fDOM) = c("valuedatetime","datavalue")

STRT_storm8_08_28_Q$valuedatetime <-as.POSIXct(STRT_storm8_08_28_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm8_08_28_NO3$valuedatetime <-as.POSIXct(STRT_storm8_08_28_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm8_08_28_fDOM$valuedatetime <-as.POSIXct(STRT_storm8_08_28_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 9 #
STRT_storm9a_09_03_Q = subset(STRT_storm9a_09_03, select = c("DateTime","MeanDischarge"))
names(STRT_storm9a_09_03_Q) = c("valuedatetime","datavalue")
STRT_storm9a_09_03_NO3 = subset(STRT_storm9a_09_03, select = c("DateTime", "nitrateuM"))
names(STRT_storm9a_09_03_NO3) = c("valuedatetime","datavalue")
STRT_storm9a_09_03_fDOM = subset(STRT_storm9a_09_03, select = c("DateTime","fDOM.QSU"))
names(STRT_storm9a_09_03_fDOM) = c("valuedatetime","datavalue")

STRT_storm9b_09_06_Q = subset(STRT_storm9b_09_06, select = c("DateTime","MeanDischarge"))
names(STRT_storm9b_09_06_Q) = c("valuedatetime","datavalue")
STRT_storm9b_09_06_NO3 = subset(STRT_storm9b_09_06, select = c("DateTime", "nitrateuM"))
names(STRT_storm9b_09_06_NO3) = c("valuedatetime","datavalue")
STRT_storm9b_09_06_fDOM = subset(STRT_storm9b_09_06, select = c("DateTime","fDOM.QSU"))
names(STRT_storm9b_09_06_fDOM) = c("valuedatetime","datavalue")

STRT_storm9c_09_09_Q = subset(STRT_storm9c_09_09, select = c("DateTime","MeanDischarge"))
names(STRT_storm9c_09_09_Q) = c("valuedatetime","datavalue")
STRT_storm9c_09_09_NO3 = subset(STRT_storm9c_09_09, select = c("DateTime", "nitrateuM"))
names(STRT_storm9c_09_09_NO3) = c("valuedatetime","datavalue")
STRT_storm9c_09_09_fDOM = subset(STRT_storm9c_09_09, select = c("DateTime","fDOM.QSU"))
names(STRT_storm9c_09_09_fDOM) = c("valuedatetime","datavalue")


STRT_storm9a_09_03_Q$valuedatetime <-as.POSIXct(STRT_storm9a_09_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9a_09_03_NO3$valuedatetime <-as.POSIXct(STRT_storm9a_09_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9a_09_03_fDOM$valuedatetime <-as.POSIXct(STRT_storm9a_09_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

STRT_storm9b_09_06_Q$valuedatetime <-as.POSIXct(STRT_storm9b_09_06_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9b_09_06_NO3$valuedatetime <-as.POSIXct(STRT_storm9b_09_06_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9b_09_06_fDOM$valuedatetime <-as.POSIXct(STRT_storm9b_09_06_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

STRT_storm9c_09_09_Q$valuedatetime <-as.POSIXct(STRT_storm9c_09_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9c_09_09_NO3$valuedatetime <-as.POSIXct(STRT_storm9c_09_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm9c_09_09_fDOM$valuedatetime <-as.POSIXct(STRT_storm9c_09_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


# Storm 10 #
STRT_storm10_09_23_Q = subset(STRT_storm10_09_23, select = c("DateTime","MeanDischarge"))
names(STRT_storm10_09_23_Q) = c("valuedatetime","datavalue")
STRT_storm10_09_23_NO3 = subset(STRT_storm10_09_23, select = c("DateTime", "nitrateuM"))
names(STRT_storm10_09_23_NO3) = c("valuedatetime","datavalue")
STRT_storm10_09_23_fDOM = subset(STRT_storm10_09_23, select = c("DateTime","fDOM.QSU"))
names(STRT_storm10_09_23_fDOM) = c("valuedatetime","datavalue")

STRT_storm10_09_23_Q$valuedatetime <-as.POSIXct(STRT_storm10_09_23_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm10_09_23_NO3$valuedatetime <-as.POSIXct(STRT_storm10_09_23_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
STRT_storm10_09_23_fDOM$valuedatetime <-as.POSIXct(STRT_storm10_09_23_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


### Write csv ###
write.csv(STRT_storm1a_06_19, "Storms/STRT_storm1a_06_19.csv")
write.csv(STRT_storm1a_06_19_Q, "Storms/STRT_storm1a_06_19_Q.csv")
write.csv(STRT_storm1a_06_19_NO3, "Storms/STRT_storm1a_06_19_NO3.csv")
write.csv(STRT_storm1a_06_19_fDOM, "Storms/STRT_storm1a_06_19_fDOM.csv")

write.csv(STRT_storm1b_06_20, "Storms/STRT_storm1b_06_20.csv")
write.csv(STRT_storm1b_06_20_Q, "Storms/STRT_storm1b_06_20_Q.csv")
write.csv(STRT_storm1b_06_20_NO3, "Storms/STRT_storm1b_06_20_NO3.csv")
write.csv(STRT_storm1b_06_20_fDOM, "Storms/STRT_storm1b_06_20_fDOM.csv")

write.csv(STRT_storm1c_06_22, "Storms/STRT_storm1c_06_22.csv")
write.csv(STRT_storm1c_06_22_Q, "Storms/STRT_storm1c_06_22_Q.csv")
write.csv(STRT_storm1c_06_22_NO3, "Storms/STRT_storm1c_06_22_NO3.csv")
write.csv(STRT_storm1c_06_22_fDOM, "Storms/STRT_storm1c_06_22_fDOM.csv")

write.csv(STRT_storm1d_06_23, "Storms/STRT_storm1d_06_23.csv")
write.csv(STRT_storm1d_06_23_Q, "Storms/STRT_storm1d_06_23_Q.csv")
write.csv(STRT_storm1d_06_23_NO3, "Storms/STRT_storm1d_06_23_NO3.csv")
write.csv(STRT_storm1d_06_23_fDOM, "Storms/STRT_storm1d_06_23_fDOM.csv")

write.csv(STRT_storm1e_06_24, "Storms/STRT_storm1e_06_24.csv")
write.csv(STRT_storm1e_06_24_Q, "Storms/STRT_storm1e_06_24_Q.csv")
write.csv(STRT_storm1e_06_24_NO3, "Storms/STRT_storm1e_06_24_NO3.csv")
write.csv(STRT_storm1e_06_24_fDOM, "Storms/STRT_storm1e_06_24_fDOM.csv")

write.csv(STRT_storm2_07_09, "Storms/STRT_storm2_07_09.csv")
write.csv(STRT_storm2_07_09_Q, "Storms/STRT_storm2_07_09_Q.csv")
write.csv(STRT_storm2_07_09_NO3, "Storms/STRT_storm2_07_09_NO3.csv")
write.csv(STRT_storm2_07_09_fDOM, "Storms/STRT_storm2_07_09_fDOM.csv")

write.csv(STRT_storm3_07_21, "Storms/STRT_storm3_07_21.csv")
write.csv(STRT_storm3_07_21_Q, "Storms/STRT_storm3_07_21_Q.csv")
write.csv(STRT_storm3_07_21_NO3, "Storms/STRT_storm3_07_21_NO3.csv")
write.csv(STRT_storm3_07_21_fDOM, "Storms/STRT_storm3_07_21_fDOM.csv")

write.csv(STRT_storm4a_08_01, "Storms/STRT_storm4a_08_01.csv")
write.csv(STRT_storm4a_08_01_Q, "Storms/STRT_storm4a_08_01_Q.csv")
write.csv(STRT_storm4a_08_01_NO3, "Storms/STRT_storm4a_08_01_NO3.csv")
write.csv(STRT_storm4a_08_01_fDOM, "Storms/STRT_storm4a_08_01_fDOM.csv")

write.csv(STRT_storm4b_08_03, "Storms/STRT_storm4b_08_03.csv")
write.csv(STRT_storm4b_08_03_Q, "Storms/STRT_storm4b_08_03_Q.csv")
write.csv(STRT_storm4b_08_03_NO3, "Storms/STRT_storm4b_08_03_NO3.csv")
write.csv(STRT_storm4b_08_03_fDOM, "Storms/STRT_storm4b_08_03_fDOM.csv")

write.csv(STRT_storm5_08_09, "Storms/STRT_storm5_08_09.csv")
write.csv(STRT_storm5_08_09_Q, "Storms/STRT_storm5_08_09_Q.csv")
write.csv(STRT_storm5_08_09_NO3, "Storms/STRT_storm5_08_09_NO3.csv")
write.csv(STRT_storm5_08_09_fDOM, "Storms/STRT_storm5_08_09_fDOM.csv")

write.csv(STRT_storm6_08_12, "Storms/STRT_storm6_08_12.csv")
write.csv(STRT_storm6_08_12_Q, "Storms/STRT_storm6_08_12_Q.csv")
write.csv(STRT_storm6_08_12_NO3, "Storms/STRT_storm6_08_12_NO3.csv")
write.csv(STRT_storm6_08_12_fDOM, "Storms/STRT_storm6_08_12_fDOM.csv")

write.csv(STRT_storm7a_08_20, "Storms/STRT_storm7a_08_20.csv")
write.csv(STRT_storm7a_08_20_Q, "Storms/STRT_storm7a_08_20_Q.csv")
write.csv(STRT_storm7a_08_20_NO3, "Storms/STRT_storm7a_08_20_NO3.csv")
write.csv(STRT_storm7a_08_20_fDOM, "Storms/STRT_storm7a_08_20_fDOM.csv")

write.csv(STRT_storm7b_08_21, "Storms/STRT_storm7b_08_21.csv")
write.csv(STRT_storm7b_08_21_Q, "Storms/STRT_storm7b_08_21_Q.csv")
write.csv(STRT_storm7b_08_21_NO3, "Storms/STRT_storm7b_08_21_NO3.csv")
write.csv(STRT_storm7b_08_21_fDOM, "Storms/STRT_storm7b_08_21_fDOM.csv")

write.csv(STRT_storm8_08_28, "Storms/STRT_storm8_08_28.csv")
write.csv(STRT_storm8_08_28_Q, "Storms/STRT_storm8_08_28_Q.csv")
write.csv(STRT_storm8_08_28_NO3, "Storms/STRT_storm8_08_28_NO3.csv")
write.csv(STRT_storm8_08_28_fDOM, "Storms/STRT_storm8_08_28_fDOM.csv")

write.csv(STRT_storm9a_09_03, "Storms/STRT_storm9a_09_03.csv")
write.csv(STRT_storm9a_09_03_Q, "Storms/STRT_storm9a_09_03_Q.csv")
write.csv(STRT_storm9a_09_03_NO3, "Storms/STRT_storm9a_09_03_NO3.csv")
write.csv(STRT_storm9a_09_03_fDOM, "Storms/STRT_storm9a_09_03_fDOM.csv")

write.csv(STRT_storm9b_09_06, "Storms/STRT_storm9b_09_06.csv")
write.csv(STRT_storm9b_09_06_Q, "Storms/STRT_storm9b_09_06_Q.csv")
write.csv(STRT_storm9b_09_06_NO3, "Storms/STRT_storm9b_09_06_NO3.csv")
write.csv(STRT_storm9b_09_06_fDOM, "Storms/STRT_storm9b_09_06_fDOM.csv")

write.csv(STRT_storm9c_09_09, "Storms/STRT_storm9c_09_09.csv")
write.csv(STRT_storm9c_09_09_Q, "Storms/STRT_storm9c_09_09_Q.csv")
write.csv(STRT_storm9c_09_09_NO3, "Storms/STRT_storm9c_09_09_NO3.csv")
write.csv(STRT_storm9c_09_09_fDOM, "Storms/STRT_storm9c_09_09_fDOM.csv")

write.csv(STRT_storm10_09_23, "Storms/STRT_storm10_09_23.csv")
write.csv(STRT_storm10_09_23_Q, "Storms/STRT_storm10_09_23_Q.csv")
write.csv(STRT_storm10_09_23_NO3, "Storms/STRT_storm10_09_23_NO3.csv")
write.csv(STRT_storm10_09_23_fDOM, "Storms/STRT_storm10_09_23_fDOM.csv")

# VAUL #
# VAUL rain gauge installed on the 22nd of June but added FRCH rain gauge on for before that#
plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'VAUL precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
par(new = T)
plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
par(new = T)
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage")) 
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM * 5 ~ VAUL.no3$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.RFU * 5 ~ VAUL.fDOM$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))


### Storms ###
# VAUL #
# Storm 1a
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-19 05:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-20 12:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm1a_06_19= VAUL[VAUL$DateTime > as.POSIXct("2020-06-19 05:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-06-20 12:00:00", tz="America/Anchorage"),]
plot(VAUL_storm1a_06_19$MeanDischarge ~ as.POSIXct(VAUL_storm1a_06_19$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL 20619 storm 1",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 1b
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-20 12:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm1b_06_20= VAUL[VAUL$DateTime > as.POSIXct("2020-06-20 12:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage"),]
plot(VAUL_storm1b_06_20$MeanDischarge ~ as.POSIXct(VAUL_storm1b_06_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="VAUL 20619 storm 1",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 1c
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-22 23:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-28 05:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm1c_06_22= VAUL[VAUL$DateTime > as.POSIXct("2020-06-22 23:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-06-28 05:00:00", tz="America/Anchorage"),]
plot(VAUL_storm1c_06_22$MeanDischarge ~ as.POSIXct(VAUL_storm1c_06_22$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL 20622 storm 1c",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 2
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-28 05:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-30 09:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm2_06_28= VAUL[VAUL$DateTime > as.POSIXct("2020-06-28 05:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-06-30 09:00:00", tz="America/Anchorage"),]
plot(VAUL_storm2_06_28$MeanDischarge ~ as.POSIXct(VAUL_storm2_06_28$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL 20628 storm 2",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 2 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-09 05:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-12 17:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm3_07_09= VAUL[VAUL$DateTime > as.POSIXct("2020-07-09 05:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-07-12 17:00:00", tz="America/Anchorage"),]
plot(VAUL_storm3_07_09$MeanDischarge ~ as.POSIXct(VAUL_storm3_07_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,500), col="blue", main="VAUL 20709 storm 3",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-12 17:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-16 05:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm4_07_12= VAUL[VAUL$DateTime > as.POSIXct("2020-07-12 17:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-07-16 05:00:00", tz="America/Anchorage"),]
plot(VAUL_storm4_07_12$MeanDischarge ~ as.POSIXct(VAUL_storm4_07_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,500), col="blue", main="VAUL 20712 storm 4",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 5 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1500), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-27 01:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-29 09:00:00", tz="America/Anchorage"), col="purple")

VAUL_storm5_07_27= VAUL[VAUL$DateTime > as.POSIXct("2020-07-27 01:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-07-29 09:00:00", tz="America/Anchorage"),]
plot(VAUL_storm5_07_27$MeanDischarge ~ as.POSIXct(VAUL_storm5_07_27$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,500), col="blue", main="VAUL 20727 storm 5",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 6a #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-01 18:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-02 22:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm6a_08_01= VAUL[VAUL$DateTime > as.POSIXct("2020-08-01 18:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-08-02 22:15:00", tz="America/Anchorage"),]
plot(VAUL_storm6a_08_01$MeanDischarge ~ as.POSIXct(VAUL_storm6a_08_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL 20801 storm 6",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 6b #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-02 23:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-08 07:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm6b_08_02= VAUL[VAUL$DateTime > as.POSIXct("2020-08-02 23:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-08-08 07:15:00", tz="America/Anchorage"),]
plot(VAUL_storm6b_08_02$MeanDischarge ~ as.POSIXct(VAUL_storm6b_08_02$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL 20802 storm 6b",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-08 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-11 07:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm7_08_08= VAUL[VAUL$DateTime > as.POSIXct("2020-08-08 08:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-08-11 07:15:00", tz="America/Anchorage"),]
plot(VAUL_storm7_08_08$MeanDischarge ~ as.POSIXct(VAUL_storm7_08_08$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 20808 storm 7",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 8 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-11 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-12 07:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm8_08_11= VAUL[VAUL$DateTime > as.POSIXct("2020-08-11 08:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-08-12 07:15:00", tz="America/Anchorage"),]
plot(VAUL_storm8_08_11$MeanDischarge ~ as.POSIXct(VAUL_storm8_08_11$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200811 storm 8",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-12 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-13 07:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm9_08_12= VAUL[VAUL$DateTime > as.POSIXct("2020-08-12 08:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-08-13 07:15:00", tz="America/Anchorage"),]
plot(VAUL_storm9_08_12$MeanDischarge ~ as.POSIXct(VAUL_storm9_08_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200812 storm 9",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 10 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-25 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-27 09:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm10_08_25= VAUL[VAUL$DateTime > as.POSIXct("2020-08-25 08:15:00", tz="America/Anchorage") &
                          VAUL$DateTime < as.POSIXct("2020-08-27 09:15:00", tz="America/Anchorage"),]
plot(VAUL_storm10_08_25$MeanDischarge ~ as.POSIXct(VAUL_storm10_08_25$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200825 storm 10",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 11 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-27 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-31 12:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm11_08_27= VAUL[VAUL$DateTime > as.POSIXct("2020-08-27 08:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-08-31 12:15:00", tz="America/Anchorage"),]
plot(VAUL_storm11_08_27$MeanDischarge ~ as.POSIXct(VAUL_storm11_08_27$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200827 storm 11",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 12 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-01 12:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-03 07:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm12_09_01= VAUL[VAUL$DateTime > as.POSIXct("2020-09-01 12:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-09-03 07:15:00", tz="America/Anchorage"),]
plot(VAUL_storm12_09_01$MeanDischarge ~ as.POSIXct(VAUL_storm12_09_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200901 storm 12",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 13 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-03 08:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-06 16:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm13_09_03= VAUL[VAUL$DateTime > as.POSIXct("2020-09-03 08:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-09-06 16:15:00", tz="America/Anchorage"),]
plot(VAUL_storm13_09_03$MeanDischarge ~ as.POSIXct(VAUL_storm13_09_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,2000), col="blue", main="VAUL 200903 storm 13",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 14 #
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-06 18:15:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-09 03:15:00", tz="America/Anchorage"), col="purple")

VAUL_storm14_09_06= VAUL[VAUL$DateTime > as.POSIXct("2020-09-06 18:15:00", tz="America/Anchorage") &
                           VAUL$DateTime < as.POSIXct("2020-09-09 03:15:00", tz="America/Anchorage"),]
plot(VAUL_storm14_09_06$MeanDischarge ~ as.POSIXct(VAUL_storm14_09_06$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="VAUL 200906 storm 14",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
par(new = T)


plot(VAUL.st.final$inst_rainfall_mm ~ VAUL.st.final$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# no alarms # no response in discharge or chemistry
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-09-16 00:00:00","2020-09-30 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-16 00:00:00","2020-09-30 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-16 00:00:00","2020-09-30 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-16 00:00:00","2020-09-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)

# no alarms # no response in discharge or chemistry
plot(vaul.final.discharge$MeanDischarge ~ vaul.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,3000), col="blue", main="VAUL",
     xlim = as.POSIXct(c("2020-10-01 00:00:00","2020-10-16 23:45:00"), tz="America/Anchorage"))
abline(h=VAUL_bfQ_mn*2, col="red", lty=2)
abline(h=VAUL_bfQ_mn, col="red")
lines(VAUL$nitrateuM ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-10-01 00:00:00","2020-10-16 23:45:00"), tz="America/Anchorage"))
lines(VAUL$fDOM.QSU ~ VAUL$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-10-01 00:00:00","2020-10-16 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(VAUL.st$inst_rainfall_mm ~ VAUL.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-10-01 00:00:00","2020-10-16 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(vaul.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(vaul.five.twenty.four$DateTime), col="green", lwd = 0.1)


# nitrateuM, fDOM.QSU VAUL #
# Storm 1 #
VAUL_storm1a_06_19_Q = subset(VAUL_storm1a_06_19, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm1a_06_19_Q) = c("valuedatetime","datavalue")
VAUL_storm1a_06_19_NO3 = subset(VAUL_storm1a_06_19, select = c("DateTime","nitrateuM"))
names(VAUL_storm1a_06_19_NO3) = c("valuedatetime","datavalue")
VAUL_storm1a_06_19_fDOM = subset(VAUL_storm1a_06_19, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm1a_06_19_fDOM) = c("valuedatetime","datavalue")

VAUL_storm1a_06_19_Q$valuedatetime <-as.POSIXct(VAUL_storm1a_06_19_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1a_06_19_NO3$valuedatetime <-as.POSIXct(VAUL_storm1a_06_19_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1a_06_19_fDOM$valuedatetime <-as.POSIXct(VAUL_storm1a_06_19_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

VAUL_storm1b_06_20_Q = subset(VAUL_storm1b_06_20, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm1b_06_20_Q) = c("valuedatetime","datavalue")
VAUL_storm1b_06_20_NO3 = subset(VAUL_storm1b_06_20, select = c("DateTime","nitrateuM"))
names(VAUL_storm1b_06_20_NO3) = c("valuedatetime","datavalue")
VAUL_storm1b_06_20_fDOM = subset(VAUL_storm1b_06_20, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm1b_06_20_fDOM) = c("valuedatetime","datavalue")

VAUL_storm1b_06_20_Q$valuedatetime <-as.POSIXct(VAUL_storm1b_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1b_06_20_NO3$valuedatetime <-as.POSIXct(VAUL_storm1b_06_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1b_06_20_fDOM$valuedatetime <-as.POSIXct(VAUL_storm1b_06_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

VAUL_storm1c_06_22_Q = subset(VAUL_storm1c_06_22, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm1c_06_22_Q) = c("valuedatetime","datavalue")
VAUL_storm1c_06_22_NO3 = subset(VAUL_storm1c_06_22, select = c("DateTime","nitrateuM"))
names(VAUL_storm1c_06_22_NO3) = c("valuedatetime","datavalue")
VAUL_storm1c_06_22_fDOM = subset(VAUL_storm1c_06_22, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm1c_06_22_fDOM) = c("valuedatetime","datavalue")

VAUL_storm1c_06_22_Q$valuedatetime <-as.POSIXct(VAUL_storm1c_06_22_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1c_06_22_NO3$valuedatetime <-as.POSIXct(VAUL_storm1c_06_22_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm1c_06_22_fDOM$valuedatetime <-as.POSIXct(VAUL_storm1c_06_22_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 2 #
VAUL_storm2_06_28_Q = subset(VAUL_storm2_06_28, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm2_06_28_Q) = c("valuedatetime","datavalue")
VAUL_storm2_06_28_NO3 = subset(VAUL_storm2_06_28, select = c("DateTime","nitrateuM"))
names(VAUL_storm2_06_28_NO3) = c("valuedatetime","datavalue")
VAUL_storm2_06_28_fDOM = subset(VAUL_storm2_06_28, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm2_06_28_fDOM) = c("valuedatetime","datavalue")

VAUL_storm2_06_28_Q$valuedatetime <-as.POSIXct(VAUL_storm2_06_28_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm2_06_28_NO3$valuedatetime <-as.POSIXct(VAUL_storm2_06_28_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm2_06_28_fDOM$valuedatetime <-as.POSIXct(VAUL_storm2_06_28_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 3 #
VAUL_storm3_07_09_Q = subset(VAUL_storm3_07_09, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm3_07_09_Q) = c("valuedatetime","datavalue")
VAUL_storm3_07_09_NO3 = subset(VAUL_storm3_07_09, select = c("DateTime","nitrateuM"))
names(VAUL_storm3_07_09_NO3) = c("valuedatetime","datavalue")
VAUL_storm3_07_09_fDOM = subset(VAUL_storm3_07_09, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm3_07_09_fDOM) = c("valuedatetime","datavalue")

VAUL_storm3_07_09_Q$valuedatetime <-as.POSIXct(VAUL_storm3_07_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm3_07_09_NO3$valuedatetime <-as.POSIXct(VAUL_storm3_07_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm3_07_09_fDOM$valuedatetime <-as.POSIXct(VAUL_storm3_07_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 4 #
VAUL_storm4_07_12_Q = subset(VAUL_storm4_07_12, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm4_07_12_Q) = c("valuedatetime","datavalue")
VAUL_storm4_07_12_NO3 = subset(VAUL_storm4_07_12, select = c("DateTime","nitrateuM"))
names(VAUL_storm4_07_12_NO3) = c("valuedatetime","datavalue")
VAUL_storm4_07_12_fDOM = subset(VAUL_storm4_07_12, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm4_07_12_fDOM) = c("valuedatetime","datavalue")

VAUL_storm4_07_12_Q$valuedatetime <-as.POSIXct(VAUL_storm4_07_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm4_07_12_NO3$valuedatetime <-as.POSIXct(VAUL_storm4_07_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm4_07_12_fDOM$valuedatetime <-as.POSIXct(VAUL_storm4_07_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 5 #
VAUL_storm5_07_27_Q = subset(VAUL_storm5_07_27, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm5_07_27_Q) = c("valuedatetime","datavalue")
VAUL_storm5_07_27_NO3 = subset(VAUL_storm5_07_27, select = c("DateTime","nitrateuM"))
names(VAUL_storm5_07_27_NO3) = c("valuedatetime","datavalue")
VAUL_storm5_07_27_fDOM = subset(VAUL_storm5_07_27, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm5_07_27_fDOM) = c("valuedatetime","datavalue")

VAUL_storm5_07_27_Q$valuedatetime <-as.POSIXct(VAUL_storm5_07_27_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm5_07_27_NO3$valuedatetime <-as.POSIXct(VAUL_storm5_07_27_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm5_07_27_fDOM$valuedatetime <-as.POSIXct(VAUL_storm5_07_27_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 6a #
VAUL_storm6a_08_01_Q = subset(VAUL_storm6a_08_01, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm6a_08_01_Q) = c("valuedatetime","datavalue")
VAUL_storm6a_08_01_NO3 = subset(VAUL_storm6a_08_01, select = c("DateTime","nitrateuM"))
names(VAUL_storm6a_08_01_NO3) = c("valuedatetime","datavalue")
VAUL_storm6a_08_01_fDOM = subset(VAUL_storm6a_08_01, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm6a_08_01_fDOM) = c("valuedatetime","datavalue")

VAUL_storm6a_08_01_Q$valuedatetime <-as.POSIXct(VAUL_storm6a_08_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm6a_08_01_NO3$valuedatetime <-as.POSIXct(VAUL_storm6a_08_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm6a_08_01_fDOM$valuedatetime <-as.POSIXct(VAUL_storm6a_08_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 6b #
VAUL_storm6b_08_02_Q = subset(VAUL_storm6b_08_02, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm6b_08_02_Q) = c("valuedatetime","datavalue")
VAUL_storm6b_08_02_NO3 = subset(VAUL_storm6b_08_02, select = c("DateTime","nitrateuM"))
names(VAUL_storm6b_08_02_NO3) = c("valuedatetime","datavalue")
VAUL_storm6b_08_02_fDOM = subset(VAUL_storm6b_08_02, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm6b_08_02_fDOM) = c("valuedatetime","datavalue")

VAUL_storm6b_08_02_Q$valuedatetime <-as.POSIXct(VAUL_storm6b_08_02_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm6b_08_02_NO3$valuedatetime <-as.POSIXct(VAUL_storm6b_08_02_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm6b_08_02_fDOM$valuedatetime <-as.POSIXct(VAUL_storm6b_08_02_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 7 #
VAUL_storm7_08_08_Q = subset(VAUL_storm7_08_08, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm7_08_08_Q) = c("valuedatetime","datavalue")
VAUL_storm7_08_08_NO3 = subset(VAUL_storm7_08_08, select = c("DateTime","nitrateuM"))
names(VAUL_storm7_08_08_NO3) = c("valuedatetime","datavalue")
VAUL_storm7_08_08_fDOM = subset(VAUL_storm7_08_08, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm7_08_08_fDOM) = c("valuedatetime","datavalue")

VAUL_storm7_08_08_Q$valuedatetime <-as.POSIXct(VAUL_storm7_08_08_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm7_08_08_NO3$valuedatetime <-as.POSIXct(VAUL_storm7_08_08_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm7_08_08_fDOM$valuedatetime <-as.POSIXct(VAUL_storm7_08_08_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 8 #
VAUL_storm8_08_11_Q = subset(VAUL_storm8_08_11, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm8_08_11_Q) = c("valuedatetime","datavalue")
VAUL_storm8_08_11_NO3 = subset(VAUL_storm8_08_11, select = c("DateTime","nitrateuM"))
names(VAUL_storm8_08_11_NO3) = c("valuedatetime","datavalue")
VAUL_storm8_08_11_fDOM = subset(VAUL_storm8_08_11, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm8_08_11_fDOM) = c("valuedatetime","datavalue")

VAUL_storm8_08_11_Q$valuedatetime <-as.POSIXct(VAUL_storm8_08_11_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm8_08_11_NO3$valuedatetime <-as.POSIXct(VAUL_storm8_08_11_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm8_08_11_fDOM$valuedatetime <-as.POSIXct(VAUL_storm8_08_11_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 9 #
VAUL_storm9_08_12_Q = subset(VAUL_storm9_08_12, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm9_08_12_Q) = c("valuedatetime","datavalue")
VAUL_storm9_08_12_NO3 = subset(VAUL_storm9_08_12, select = c("DateTime","nitrateuM"))
names(VAUL_storm9_08_12_NO3) = c("valuedatetime","datavalue")
VAUL_storm9_08_12_fDOM = subset(VAUL_storm9_08_12, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm9_08_12_fDOM) = c("valuedatetime","datavalue")

VAUL_storm9_08_12_Q$valuedatetime <-as.POSIXct(VAUL_storm9_08_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm9_08_12_NO3$valuedatetime <-as.POSIXct(VAUL_storm9_08_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm9_08_12_fDOM$valuedatetime <-as.POSIXct(VAUL_storm9_08_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 10 #
VAUL_storm10_08_25_Q = subset(VAUL_storm10_08_25, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm10_08_25_Q) = c("valuedatetime","datavalue")
VAUL_storm10_08_25_NO3 = subset(VAUL_storm10_08_25, select = c("DateTime","nitrateuM"))
names(VAUL_storm10_08_25_NO3) = c("valuedatetime","datavalue")
VAUL_storm10_08_25_fDOM = subset(VAUL_storm10_08_25, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm10_08_25_fDOM) = c("valuedatetime","datavalue")

VAUL_storm10_08_25_Q$valuedatetime <-as.POSIXct(VAUL_storm10_08_25_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm10_08_25_NO3$valuedatetime <-as.POSIXct(VAUL_storm10_08_25_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm10_08_25_fDOM$valuedatetime <-as.POSIXct(VAUL_storm10_08_25_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 11 #
VAUL_storm11_08_27_Q = subset(VAUL_storm11_08_27, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm11_08_27_Q) = c("valuedatetime","datavalue")
VAUL_storm11_08_27_NO3 = subset(VAUL_storm11_08_27, select = c("DateTime","nitrateuM"))
names(VAUL_storm11_08_27_NO3) = c("valuedatetime","datavalue")
VAUL_storm11_08_27_fDOM = subset(VAUL_storm11_08_27, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm11_08_27_fDOM) = c("valuedatetime","datavalue")

VAUL_storm11_08_27_Q$valuedatetime <-as.POSIXct(VAUL_storm11_08_27_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm11_08_27_NO3$valuedatetime <-as.POSIXct(VAUL_storm11_08_27_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm11_08_27_fDOM$valuedatetime <-as.POSIXct(VAUL_storm11_08_27_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 12 #
VAUL_storm12_09_01_Q = subset(VAUL_storm12_09_01, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm12_09_01_Q) = c("valuedatetime","datavalue")
VAUL_storm12_09_01_NO3 = subset(VAUL_storm12_09_01, select = c("DateTime","nitrateuM"))
names(VAUL_storm12_09_01_NO3) = c("valuedatetime","datavalue")
VAUL_storm12_09_01_fDOM = subset(VAUL_storm12_09_01, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm12_09_01_fDOM) = c("valuedatetime","datavalue")

VAUL_storm12_09_01_Q$valuedatetime <-as.POSIXct(VAUL_storm12_09_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm12_09_01_NO3$valuedatetime <-as.POSIXct(VAUL_storm12_09_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm12_09_01_fDOM$valuedatetime <-as.POSIXct(VAUL_storm12_09_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 13 #
VAUL_storm13_09_03_Q = subset(VAUL_storm13_09_03, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm13_09_03_Q) = c("valuedatetime","datavalue")
VAUL_storm13_09_03_NO3 = subset(VAUL_storm13_09_03, select = c("DateTime","nitrateuM"))
names(VAUL_storm13_09_03_NO3) = c("valuedatetime","datavalue")
VAUL_storm13_09_03_fDOM = subset(VAUL_storm13_09_03, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm13_09_03_fDOM) = c("valuedatetime","datavalue")

VAUL_storm13_09_03_Q$valuedatetime <-as.POSIXct(VAUL_storm13_09_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm13_09_03_NO3$valuedatetime <-as.POSIXct(VAUL_storm13_09_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm13_09_03_fDOM$valuedatetime <-as.POSIXct(VAUL_storm13_09_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 14 #
VAUL_storm14_09_06_Q = subset(VAUL_storm14_09_06, select = c("DateTime", "MeanDischarge"))
names(VAUL_storm14_09_06_Q) = c("valuedatetime","datavalue")
VAUL_storm14_09_06_NO3 = subset(VAUL_storm14_09_06, select = c("DateTime","nitrateuM"))
names(VAUL_storm14_09_06_NO3) = c("valuedatetime","datavalue")
VAUL_storm14_09_06_fDOM = subset(VAUL_storm14_09_06, select = c("DateTime","fDOM.QSU"))
names(VAUL_storm14_09_06_fDOM) = c("valuedatetime","datavalue")

VAUL_storm14_09_06_Q$valuedatetime <-as.POSIXct(VAUL_storm14_09_06_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm14_09_06_NO3$valuedatetime <-as.POSIXct(VAUL_storm14_09_06_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
VAUL_storm14_09_06_fDOM$valuedatetime <-as.POSIXct(VAUL_storm14_09_06_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# write csv # 
write.csv(VAUL_storm1a_06_19, "Storms/VAUL_storm1a_06_19.csv")
write.csv(VAUL_storm1a_06_19_Q, "Storms/VAUL_storm1a_06_19_Q.csv")
write.csv(VAUL_storm1a_06_19_NO3, "Storms/VAUL_storm1a_06_19_NO3.csv")
write.csv(VAUL_storm1a_06_19_fDOM, "Storms/VAUL_storm1a_06_19_fDOM.csv")

write.csv(VAUL_storm1b_06_20, "Storms/VAUL_storm1b_06_20.csv")
write.csv(VAUL_storm1b_06_20_Q, "Storms/VAUL_storm1b_06_20_Q.csv")
write.csv(VAUL_storm1b_06_20_NO3, "Storms/VAUL_storm1b_06_20_NO3.csv")
write.csv(VAUL_storm1b_06_20_fDOM, "Storms/VAUL_storm1b_06_20_fDOM.csv")

write.csv(VAUL_storm1c_06_22, "Storms/VAUL_storm1c_06_22.csv")
write.csv(VAUL_storm1c_06_22_Q, "Storms/VAUL_storm1c_06_22_Q.csv")
write.csv(VAUL_storm1c_06_22_NO3, "Storms/VAUL_storm1c_06_22_NO3.csv")
write.csv(VAUL_storm1c_06_22_fDOM, "Storms/VAUL_storm1c_06_22_fDOM.csv")

write.csv(VAUL_storm2_06_28, "Storms/VAUL_storm2_06_28.csv")
write.csv(VAUL_storm2_06_28_Q, "Storms/VAUL_storm2_06_28_Q.csv")
write.csv(VAUL_storm2_06_28_NO3, "Storms/VAUL_storm2_06_28_NO3.csv")
write.csv(VAUL_storm2_06_28_fDOM, "Storms/VAUL_storm2_06_28_fDOM.csv")

write.csv(VAUL_storm3_07_09, "Storms/VAUL_storm3_07_09.csv")
write.csv(VAUL_storm3_07_09_Q, "Storms/VAUL_storm3_07_09_Q.csv")
write.csv(VAUL_storm3_07_09_NO3, "Storms/VAUL_storm3_07_09_NO3.csv")
write.csv(VAUL_storm3_07_09_fDOM, "Storms/VAUL_storm3_07_09_fDOM.csv")

write.csv(VAUL_storm4_07_12, "Storms/VAUL_storm4_07_12.csv")
write.csv(VAUL_storm4_07_12_Q, "Storms/VAUL_storm4_07_12_Q.csv")
write.csv(VAUL_storm4_07_12_NO3, "Storms/VAUL_storm4_07_12_NO3.csv")
write.csv(VAUL_storm4_07_12_fDOM, "Storms/VAUL_storm4_07_12_fDOM.csv")

write.csv(VAUL_storm5_07_27, "Storms/VAUL_storm5_07_27.csv")
write.csv(VAUL_storm5_07_27_Q, "Storms/VAUL_storm5_07_27_Q.csv")
write.csv(VAUL_storm5_07_27_NO3, "Storms/VAUL_storm5_07_27_NO3.csv")
write.csv(VAUL_storm5_07_27_fDOM, "Storms/VAUL_storm5_07_27_fDOM.csv")

write.csv(VAUL_storm6a_08_01, "Storms/VAUL_storm6a_08_01.csv")
write.csv(VAUL_storm6a_08_01_Q, "Storms/VAUL_storm6a_08_01_Q.csv")
write.csv(VAUL_storm6a_08_01_NO3, "Storms/VAUL_storm6a_08_01_NO3.csv")
write.csv(VAUL_storm6a_08_01_fDOM, "Storms/VAUL_storm6a_08_01_fDOM.csv")

write.csv(VAUL_storm6b_08_02, "Storms/VAUL_storm6b_08_02.csv")
write.csv(VAUL_storm6b_08_02_Q, "Storms/VAUL_storm6b_08_02_Q.csv")
write.csv(VAUL_storm6b_08_02_NO3, "Storms/VAUL_storm6b_08_02_NO3.csv")
write.csv(VAUL_storm6b_08_02_fDOM, "Storms/VAUL_storm6b_08_02_fDOM.csv")

write.csv(VAUL_storm7_08_08, "Storms/VAUL_storm7_08_08.csv")
write.csv(VAUL_storm7_08_08_Q, "Storms/VAUL_storm7_08_08_Q.csv")
write.csv(VAUL_storm7_08_08_NO3, "Storms/VAUL_storm7_08_08_NO3.csv")
write.csv(VAUL_storm7_08_08_fDOM, "Storms/VAUL_storm7_08_08_fDOM.csv")

write.csv(VAUL_storm8_08_11, "Storms/VAUL_storm8_08_11.csv")
write.csv(VAUL_storm8_08_11_Q, "Storms/VAUL_storm8_08_11_Q.csv")
write.csv(VAUL_storm8_08_11_NO3, "Storms/VAUL_storm8_08_11_NO3.csv")
write.csv(VAUL_storm8_08_11_fDOM, "Storms/VAUL_storm8_08_11_fDOM.csv")

write.csv(VAUL_storm9_08_12, "Storms/VAUL_storm9_08_12.csv")
write.csv(VAUL_storm9_08_12_Q, "Storms/VAUL_storm9_08_12_Q.csv")
write.csv(VAUL_storm9_08_12_NO3, "Storms/VAUL_storm9_08_12_NO3.csv")
write.csv(VAUL_storm9_08_12_fDOM, "Storms/VAUL_storm9_08_12_fDOM.csv")

write.csv(VAUL_storm10_08_25, "Storms/VAUL_storm10_08_25.csv")
write.csv(VAUL_storm10_08_25_Q, "Storms/VAUL_storm10_08_25_Q.csv")
write.csv(VAUL_storm10_08_25_NO3, "Storms/VAUL_storm10_08_25_NO3.csv")
write.csv(VAUL_storm10_08_25_fDOM, "Storms/VAUL_storm10_08_25_fDOM.csv")

write.csv(VAUL_storm11_08_27, "Storms/VAUL_storm11_08_27.csv")
write.csv(VAUL_storm11_08_27_Q, "Storms/VAUL_storm11_08_27_Q.csv")
write.csv(VAUL_storm11_08_27_NO3, "Storms/VAUL_storm11_08_27_NO3.csv")
write.csv(VAUL_storm11_08_27_fDOM, "Storms/VAUL_storm11_08_27_fDOM.csv")

write.csv(VAUL_storm12_09_01, "Storms/VAUL_storm12_09_01.csv")
write.csv(VAUL_storm12_09_01_Q, "Storms/VAUL_storm12_09_01_Q.csv")
write.csv(VAUL_storm12_09_01_NO3, "Storms/VAUL_storm12_09_01_NO3.csv")
write.csv(VAUL_storm12_09_01_fDOM, "Storms/VAUL_storm12_09_01_fDOM.csv")

write.csv(VAUL_storm13_09_03, "Storms/VAUL_storm13_09_03.csv")
write.csv(VAUL_storm13_09_03_Q, "Storms/VAUL_storm13_09_03_Q.csv")
write.csv(VAUL_storm13_09_03_NO3, "Storms/VAUL_storm13_09_03_NO3.csv")
write.csv(VAUL_storm13_09_03_fDOM, "Storms/VAUL_storm13_09_03_fDOM.csv")

write.csv(VAUL_storm14_09_06, "Storms/VAUL_storm14_09_06.csv")
write.csv(VAUL_storm14_09_06_Q, "Storms/VAUL_storm14_09_06_Q.csv")
write.csv(VAUL_storm14_09_06_NO3, "Storms/VAUL_storm14_09_06_NO3.csv")
write.csv(VAUL_storm14_09_06_fDOM, "Storms/VAUL_storm14_09_06_fDOM.csv")



## POKE ##
### Import precipitation data from LTER ### 
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 0:00:00","2020-10-31 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'POKE precip. (mm)') 
abline(v = as.POSIXct(poke.ten.fourty.eight$DateTime), col = "red", lwd = 0.1)
abline(v = as.POSIXct(poke.ten.twenty.four$DateTime), col="blue", lwd = 0.1)
par(new = T)

plot(poke.final.discharge$MeanDischarge ~ poke.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
lines(POKE$nitrateuM * 25 ~ POKE.no3$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))
lines(POKE$fDOM.RFU * 15 ~ POKE.no3$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))

### STORMS ###
# Storm 1 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-09 10:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-10 10:00:00", tz="America/Anchorage"), col="purple")

POKE_storm1_06_09 = POKE[POKE$DateTime > as.POSIXct("2020-06-09 10:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-06-10 10:00:00", tz="America/Anchorage"),]
plot(POKE_storm1_06_09$MeanDischarge ~ as.POSIXct(POKE_storm1_06_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="POKE 200609 storm 1",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 2 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-12 12:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-13 10:00:00", tz="America/Anchorage"), col="purple")

POKE_storm2_06_12 = POKE[POKE$DateTime > as.POSIXct("2020-06-12 12:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-06-13 10:00:00", tz="America/Anchorage"),]
plot(POKE_storm2_06_12$MeanDischarge ~ as.POSIXct(POKE_storm2_06_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="POKE 200612 storm 2",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-06-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 3 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-15 12:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-16 19:00:00", tz="America/Anchorage"), col="purple")

POKE_storm3_06_15 = POKE[POKE$DateTime > as.POSIXct("2020-06-15 12:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-06-16 19:00:00", tz="America/Anchorage"),]
plot(POKE_storm3_06_15$MeanDischarge ~ as.POSIXct(POKE_storm3_06_15$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,1000), col="blue", main="POKE 200615 storm 3",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4a #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-19 06:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-20 07:00:00", tz="America/Anchorage"), col="purple")

POKE_storm4a_06_19 = POKE[POKE$DateTime > as.POSIXct("2020-06-19 06:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-06-20 07:00:00", tz="America/Anchorage"),]
plot(POKE_storm4a_06_19$MeanDischarge ~ as.POSIXct(POKE_storm4a_06_19$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,2000), col="blue", main="POKE 200619 storm 4a",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4b #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-20 08:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-21 07:00:00", tz="America/Anchorage"), col="purple")

POKE_storm4b_06_20 = POKE[POKE$DateTime > as.POSIXct("2020-06-20 08:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-06-21 07:00:00", tz="America/Anchorage"),]
plot(POKE_storm4b_06_20$MeanDischarge ~ as.POSIXct(POKE_storm4b_06_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(0,2200), col="blue", main="POKE 200620 storm 4b",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4c #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-21 08:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage"), col="purple")

POKE_storm4c_06_21 = POKE[POKE$DateTime > as.POSIXct("2020-06-21 08:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage"),]
plot(POKE_storm4c_06_21$MeanDischarge ~ as.POSIXct(POKE_storm4c_06_21$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2200), col="blue", main="POKE 200621 storm 4c",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 5 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-25 05:00:00", tz="America/Anchorage"), col="purple")

POKE_storm5_06_22 = POKE[POKE$DateTime > as.POSIXct("2020-06-22 23:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-06-25 05:00:00", tz="America/Anchorage"),]
plot(POKE_storm5_06_22$MeanDischarge ~ as.POSIXct(POKE_storm5_06_22$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2200), col="blue", main="POKE 200622 storm 5",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 6 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-29 10:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-30 10:00:00", tz="America/Anchorage"), col="purple")

POKE_storm6_06_29 = POKE[POKE$DateTime > as.POSIXct("2020-06-29 10:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-06-30 10:00:00", tz="America/Anchorage"),]
plot(POKE_storm6_06_29$MeanDischarge ~ as.POSIXct(POKE_storm6_06_29$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200629 storm 6",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-15 00:00:00","2020-06-30 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-04 05:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-05 14:00:00", tz="America/Anchorage"), col="purple")

POKE_storm7_07_04 = POKE[POKE$DateTime > as.POSIXct("2020-07-04 05:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-07-05 14:00:00", tz="America/Anchorage"),]
plot(POKE_storm7_07_04$MeanDischarge ~ as.POSIXct(POKE_storm7_07_04$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200704 storm 7",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 8 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-09 05:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-10 14:00:00", tz="America/Anchorage"), col="purple")

POKE_storm8_07_09 = POKE[POKE$DateTime > as.POSIXct("2020-07-09 05:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-07-10 14:00:00", tz="America/Anchorage"),]
plot(POKE_storm8_07_09$MeanDischarge ~ as.POSIXct(POKE_storm8_07_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200709 storm 8",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 9 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-12 20:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-15 14:00:00", tz="America/Anchorage"), col="purple")

POKE_storm9_07_12 = POKE[POKE$DateTime > as.POSIXct("2020-07-12 20:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-07-15 14:00:00", tz="America/Anchorage"),]
plot(POKE_storm9_07_12$MeanDischarge ~ as.POSIXct(POKE_storm9_07_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200712 storm 9",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-01 00:00:00","2020-07-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 10 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-16 22:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-17 23:00:00", tz="America/Anchorage"), col="purple")

POKE_storm10_07_16 = POKE[POKE$DateTime > as.POSIXct("2020-07-16 20:00:00", tz="America/Anchorage") &
                           POKE$DateTime < as.POSIXct("2020-07-17 23:00:00", tz="America/Anchorage"),]
plot(POKE_storm10_07_16$MeanDischarge ~ as.POSIXct(POKE_storm10_07_16$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200716 storm 10",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 11 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-18 08:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-20 10:00:00", tz="America/Anchorage"), col="purple")

POKE_storm11_07_18 = POKE[POKE$DateTime > as.POSIXct("2020-07-18 08:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-07-20 10:00:00", tz="America/Anchorage"),]
plot(POKE_storm11_07_18$MeanDischarge ~ as.POSIXct(POKE_storm11_07_18$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200718 storm 11",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 12 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-20 18:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-24 00:00:00", tz="America/Anchorage"), col="purple")

POKE_storm12_07_20 = POKE[POKE$DateTime > as.POSIXct("2020-07-20 18:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-07-24 00:00:00", tz="America/Anchorage"),]
plot(POKE_storm12_07_20$MeanDischarge ~ as.POSIXct(POKE_storm12_07_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200720 storm 12",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 13 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-24 08:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-26 06:00:00", tz="America/Anchorage"), col="purple")

POKE_storm13_07_24 = POKE[POKE$DateTime > as.POSIXct("2020-07-24 08:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-07-26 06:00:00", tz="America/Anchorage"),]
plot(POKE_storm13_07_24$MeanDischarge ~ as.POSIXct(POKE_storm13_07_24$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200724 storm 13",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 14 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-26 22:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-30 22:00:00", tz="America/Anchorage"), col="purple")

POKE_storm14_07_26 = POKE[POKE$DateTime > as.POSIXct("2020-07-26 22:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-07-30 22:00:00", tz="America/Anchorage"),]
plot(POKE_storm14_07_26$MeanDischarge ~ as.POSIXct(POKE_storm14_07_26$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1500), col="blue", main="POKE 200726 storm 14",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 15 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-02 22:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-06 11:00:00", tz="America/Anchorage"), col="purple")

POKE_storm15_08_02 = POKE[POKE$DateTime > as.POSIXct("2020-08-02 22:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-08-06 11:00:00", tz="America/Anchorage"),]
plot(POKE_storm15_08_02$MeanDischarge ~ as.POSIXct(POKE_storm15_08_02$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,5000), col="blue", main="POKE 200802 storm 15",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 16 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
lines(POKE$nitrateuM * 45 ~ POKE$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))
lines(POKE$fDOM.RFU * 50 ~ POKE$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-12 13:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-13 13:00:00", tz="America/Anchorage"), col="purple")

POKE_storm16_08_12 = POKE[POKE$DateTime > as.POSIXct("2020-08-12 13:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-08-13 13:00:00", tz="America/Anchorage"),]
plot(POKE_storm16_08_12$MeanDischarge ~ as.POSIXct(POKE_storm16_08_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2000), col="blue", main="POKE 200812 storm 16",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 17 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-24 00:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-25 05:00:00", tz="America/Anchorage"), col="purple")

POKE_storm17_08_24 = POKE[POKE$DateTime > as.POSIXct("2020-08-24 00:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-08-25 05:00:00", tz="America/Anchorage"),]
plot(POKE_storm17_08_24$MeanDischarge ~ as.POSIXct(POKE_storm17_08_24$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,1500), col="blue", main="POKE 200824 storm 17",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 18 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-25 05:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-26 05:00:00", tz="America/Anchorage"), col="purple")

POKE_storm18_08_25 = POKE[POKE$DateTime > as.POSIXct("2020-08-25 05:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-08-26 05:00:00", tz="America/Anchorage"),]
plot(POKE_storm18_08_25$MeanDischarge ~ as.POSIXct(POKE_storm18_08_25$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,1500), col="blue", main="POKE 200825 storm 18",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 19 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-08-27 10:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-28 20:00:00", tz="America/Anchorage"), col="purple")

POKE_storm19_08_27 = POKE[POKE$DateTime > as.POSIXct("2020-08-27 10:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-08-28 20:00:00", tz="America/Anchorage"),]
plot(POKE_storm19_08_27$MeanDischarge ~ as.POSIXct(POKE_storm19_08_27$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,1500), col="blue", main="POKE 200827 storm 19",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-16 00:00:00","2020-08-31 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 20 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-01 18:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-03 05:00:00", tz="America/Anchorage"), col="purple")

POKE_storm20_09_01 = POKE[POKE$DateTime > as.POSIXct("2020-09-01 18:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-09-03 05:00:00", tz="America/Anchorage"),]
plot(POKE_storm20_09_01$MeanDischarge ~ as.POSIXct(POKE_storm20_09_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,1500), col="blue", main="POKE 200901 storm 20",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 21 #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")
lines(POKE$nitrateuM * 45 ~ POKE$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
lines(POKE$fDOM.RFU * 50 ~ POKE$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))


par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-03 23:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-06 14:00:00", tz="America/Anchorage"), col="purple")

POKE_storm21_09_03 = POKE[POKE$DateTime > as.POSIXct("2020-09-03 23:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-09-06 14:00:00", tz="America/Anchorage"),]
plot(POKE_storm21_09_03$MeanDischarge ~ as.POSIXct(POKE_storm21_09_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,1500), col="blue", main="POKE 200903 storm 21",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 22a #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-07 19:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-08 23:00:00", tz="America/Anchorage"), col="purple")

POKE_storm22a_09_07 = POKE[POKE$DateTime > as.POSIXct("2020-09-07 19:00:00", tz="America/Anchorage") &
                            POKE$DateTime < as.POSIXct("2020-09-08 23:00:00", tz="America/Anchorage"),]
plot(POKE_storm22a_09_07$MeanDischarge ~ as.POSIXct(POKE_storm22a_09_07$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,2000), col="blue", main="POKE 200907 storm 22a",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 22b #
plot(POKE$MeanDischarge ~ POKE$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))
abline(h=POKE_bfQ_mn*2, col="red", lty=2)
abline(h=POKE_bfQ_mn, col="red")

par(new = T)

plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(poke.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(poke.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-09-09 05:45:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-11 10:00:00", tz="America/Anchorage"), col="purple")

POKE_storm22b_09_09 = POKE[POKE$DateTime > as.POSIXct("2020-09-09 05:45:00", tz="America/Anchorage") &
                             POKE$DateTime < as.POSIXct("2020-09-11 10:00:00", tz="America/Anchorage"),]
plot(POKE_storm22b_09_09$MeanDischarge ~ as.POSIXct(POKE_storm22b_09_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(750,2000), col="blue", main="POKE 200909 storm 22b",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(poke.gauge$Precip ~ poke.gauge$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-01 00:00:00","2020-09-15 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# nitrateuM, fDOM.RFU POKE #
# Storm 1 #
POKE_storm1_06_09_Q = subset(POKE_storm1_06_09, select = c("DateTime", "MeanDischarge"))
names(POKE_storm1_06_09_Q) = c("valuedatetime","datavalue")
POKE_storm1_06_09_NO3 = subset(POKE_storm1_06_09, select = c("DateTime","nitrateuM"))
names(POKE_storm1_06_09_NO3) = c("valuedatetime","datavalue")
POKE_storm1_06_09_fDOM = subset(POKE_storm1_06_09, select = c("DateTime","fDOM.RFU"))
names(POKE_storm1_06_09_fDOM) = c("valuedatetime","datavalue")

POKE_storm1_06_09_Q$valuedatetime <-as.POSIXct(POKE_storm1_06_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm1_06_09_NO3$valuedatetime <-as.POSIXct(POKE_storm1_06_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm1_06_09_fDOM$valuedatetime <-as.POSIXct(POKE_storm1_06_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm2_06_12_Q = subset(POKE_storm2_06_12, select = c("DateTime", "MeanDischarge"))
names(POKE_storm2_06_12_Q) = c("valuedatetime","datavalue")
POKE_storm2_06_12_NO3 = subset(POKE_storm2_06_12, select = c("DateTime","nitrateuM"))
names(POKE_storm2_06_12_NO3) = c("valuedatetime","datavalue")
POKE_storm2_06_12_fDOM = subset(POKE_storm2_06_12, select = c("DateTime","fDOM.RFU"))
names(POKE_storm2_06_12_fDOM) = c("valuedatetime","datavalue")

POKE_storm2_06_12_Q$valuedatetime <-as.POSIXct(POKE_storm2_06_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm2_06_12_NO3$valuedatetime <-as.POSIXct(POKE_storm2_06_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm2_06_12_fDOM$valuedatetime <-as.POSIXct(POKE_storm2_06_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm3_06_15_Q = subset(POKE_storm3_06_15, select = c("DateTime", "MeanDischarge"))
names(POKE_storm3_06_15_Q) = c("valuedatetime","datavalue")
POKE_storm3_06_15_NO3 = subset(POKE_storm3_06_15, select = c("DateTime","nitrateuM"))
names(POKE_storm3_06_15_NO3) = c("valuedatetime","datavalue")
POKE_storm3_06_15_fDOM = subset(POKE_storm3_06_15, select = c("DateTime","fDOM.RFU"))
names(POKE_storm3_06_15_fDOM) = c("valuedatetime","datavalue")

POKE_storm3_06_15_Q$valuedatetime <-as.POSIXct(POKE_storm3_06_15_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm3_06_15_NO3$valuedatetime <-as.POSIXct(POKE_storm3_06_15_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm3_06_15_fDOM$valuedatetime <-as.POSIXct(POKE_storm3_06_15_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm4a_06_19_Q = subset(POKE_storm4a_06_19, select = c("DateTime", "MeanDischarge"))
names(POKE_storm4a_06_19_Q) = c("valuedatetime","datavalue")
POKE_storm4a_06_19_NO3 = subset(POKE_storm4a_06_19, select = c("DateTime","nitrateuM"))
names(POKE_storm4a_06_19_NO3) = c("valuedatetime","datavalue")
POKE_storm4a_06_19_fDOM = subset(POKE_storm4a_06_19, select = c("DateTime","fDOM.RFU"))
names(POKE_storm4a_06_19_fDOM) = c("valuedatetime","datavalue")

POKE_storm4a_06_19_Q$valuedatetime <-as.POSIXct(POKE_storm4a_06_19_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4a_06_19_NO3$valuedatetime <-as.POSIXct(POKE_storm4a_06_19_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4a_06_19_fDOM$valuedatetime <-as.POSIXct(POKE_storm4a_06_19_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm4b_06_20_Q = subset(POKE_storm4b_06_20, select = c("DateTime", "MeanDischarge"))
names(POKE_storm4b_06_20_Q) = c("valuedatetime","datavalue")
POKE_storm4b_06_20_NO3 = subset(POKE_storm4b_06_20, select = c("DateTime","nitrateuM"))
names(POKE_storm4b_06_20_NO3) = c("valuedatetime","datavalue")
POKE_storm4b_06_20_fDOM = subset(POKE_storm4b_06_20, select = c("DateTime","fDOM.RFU"))
names(POKE_storm4b_06_20_fDOM) = c("valuedatetime","datavalue")

POKE_storm4b_06_20_Q$valuedatetime <-as.POSIXct(POKE_storm4b_06_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4b_06_20_NO3$valuedatetime <-as.POSIXct(POKE_storm4b_06_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4b_06_20_fDOM$valuedatetime <-as.POSIXct(POKE_storm4b_06_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm4c_06_21_Q = subset(POKE_storm4c_06_21, select = c("DateTime", "MeanDischarge"))
names(POKE_storm4c_06_21_Q) = c("valuedatetime","datavalue")
POKE_storm4c_06_21_NO3 = subset(POKE_storm4c_06_21, select = c("DateTime","nitrateuM"))
names(POKE_storm4c_06_21_NO3) = c("valuedatetime","datavalue")
POKE_storm4c_06_21_fDOM = subset(POKE_storm4c_06_21, select = c("DateTime","fDOM.RFU"))
names(POKE_storm4c_06_21_fDOM) = c("valuedatetime","datavalue")

POKE_storm4c_06_21_Q$valuedatetime <-as.POSIXct(POKE_storm4c_06_21_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4c_06_21_NO3$valuedatetime <-as.POSIXct(POKE_storm4c_06_21_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm4c_06_21_fDOM$valuedatetime <-as.POSIXct(POKE_storm4c_06_21_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm5_06_22_Q = subset(POKE_storm5_06_22, select = c("DateTime", "MeanDischarge"))
names(POKE_storm5_06_22_Q) = c("valuedatetime","datavalue")
POKE_storm5_06_22_NO3 = subset(POKE_storm5_06_22, select = c("DateTime","nitrateuM"))
names(POKE_storm5_06_22_NO3) = c("valuedatetime","datavalue")
POKE_storm5_06_22_fDOM = subset(POKE_storm5_06_22, select = c("DateTime","fDOM.RFU"))
names(POKE_storm5_06_22_fDOM) = c("valuedatetime","datavalue")

POKE_storm5_06_22_Q$valuedatetime <-as.POSIXct(POKE_storm5_06_22_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm5_06_22_NO3$valuedatetime <-as.POSIXct(POKE_storm5_06_22_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm5_06_22_fDOM$valuedatetime <-as.POSIXct(POKE_storm5_06_22_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm6_06_29_Q = subset(POKE_storm6_06_29, select = c("DateTime", "MeanDischarge"))
names(POKE_storm6_06_29_Q) = c("valuedatetime","datavalue")
POKE_storm6_06_29_NO3 = subset(POKE_storm6_06_29, select = c("DateTime","nitrateuM"))
names(POKE_storm6_06_29_NO3) = c("valuedatetime","datavalue")
POKE_storm6_06_29_fDOM = subset(POKE_storm6_06_29, select = c("DateTime","fDOM.RFU"))
names(POKE_storm6_06_29_fDOM) = c("valuedatetime","datavalue")

POKE_storm6_06_29_Q$valuedatetime <-as.POSIXct(POKE_storm6_06_29_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm6_06_29_NO3$valuedatetime <-as.POSIXct(POKE_storm6_06_29_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm6_06_29_fDOM$valuedatetime <-as.POSIXct(POKE_storm6_06_29_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm7_07_04_Q = subset(POKE_storm7_07_04, select = c("DateTime", "MeanDischarge"))
names(POKE_storm7_07_04_Q) = c("valuedatetime","datavalue")
POKE_storm7_07_04_NO3 = subset(POKE_storm7_07_04, select = c("DateTime","nitrateuM"))
names(POKE_storm7_07_04_NO3) = c("valuedatetime","datavalue")
POKE_storm7_07_04_fDOM = subset(POKE_storm7_07_04, select = c("DateTime","fDOM.RFU"))
names(POKE_storm7_07_04_fDOM) = c("valuedatetime","datavalue")

POKE_storm7_07_04_Q$valuedatetime <-as.POSIXct(POKE_storm7_07_04_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm7_07_04_NO3$valuedatetime <-as.POSIXct(POKE_storm7_07_04_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm7_07_04_fDOM$valuedatetime <-as.POSIXct(POKE_storm7_07_04_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm8_07_09_Q = subset(POKE_storm8_07_09, select = c("DateTime", "MeanDischarge"))
names(POKE_storm8_07_09_Q) = c("valuedatetime","datavalue")
POKE_storm8_07_09_NO3 = subset(POKE_storm8_07_09, select = c("DateTime","nitrateuM"))
names(POKE_storm8_07_09_NO3) = c("valuedatetime","datavalue")
POKE_storm8_07_09_fDOM = subset(POKE_storm8_07_09, select = c("DateTime","fDOM.RFU"))
names(POKE_storm8_07_09_fDOM) = c("valuedatetime","datavalue")

POKE_storm8_07_09_Q$valuedatetime <-as.POSIXct(POKE_storm8_07_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm8_07_09_NO3$valuedatetime <-as.POSIXct(POKE_storm8_07_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm8_07_09_fDOM$valuedatetime <-as.POSIXct(POKE_storm8_07_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm9_07_12_Q = subset(POKE_storm9_07_12, select = c("DateTime", "MeanDischarge"))
names(POKE_storm9_07_12_Q) = c("valuedatetime","datavalue")
POKE_storm9_07_12_NO3 = subset(POKE_storm9_07_12, select = c("DateTime","nitrateuM"))
names(POKE_storm9_07_12_NO3) = c("valuedatetime","datavalue")
POKE_storm9_07_12_fDOM = subset(POKE_storm9_07_12, select = c("DateTime","fDOM.RFU"))
names(POKE_storm9_07_12_fDOM) = c("valuedatetime","datavalue")

POKE_storm9_07_12_Q$valuedatetime <-as.POSIXct(POKE_storm9_07_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm9_07_12_NO3$valuedatetime <-as.POSIXct(POKE_storm9_07_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm9_07_12_fDOM$valuedatetime <-as.POSIXct(POKE_storm9_07_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm10_07_16_Q = subset(POKE_storm10_07_16, select = c("DateTime", "MeanDischarge"))
names(POKE_storm10_07_16_Q) = c("valuedatetime","datavalue")
POKE_storm10_07_16_NO3 = subset(POKE_storm10_07_16, select = c("DateTime","nitrateuM"))
names(POKE_storm10_07_16_NO3) = c("valuedatetime","datavalue")
POKE_storm10_07_16_fDOM = subset(POKE_storm10_07_16, select = c("DateTime","fDOM.RFU"))
names(POKE_storm10_07_16_fDOM) = c("valuedatetime","datavalue")

POKE_storm10_07_16_Q$valuedatetime <-as.POSIXct(POKE_storm10_07_16_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm10_07_16_NO3$valuedatetime <-as.POSIXct(POKE_storm10_07_16_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm10_07_16_fDOM$valuedatetime <-as.POSIXct(POKE_storm10_07_16_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm11_07_18_Q = subset(POKE_storm11_07_18, select = c("DateTime", "MeanDischarge"))
names(POKE_storm11_07_18_Q) = c("valuedatetime","datavalue")
POKE_storm11_07_18_NO3 = subset(POKE_storm11_07_18, select = c("DateTime","nitrateuM"))
names(POKE_storm11_07_18_NO3) = c("valuedatetime","datavalue")
POKE_storm11_07_18_fDOM = subset(POKE_storm11_07_18, select = c("DateTime","fDOM.RFU"))
names(POKE_storm11_07_18_fDOM) = c("valuedatetime","datavalue")

POKE_storm11_07_18_Q$valuedatetime <-as.POSIXct(POKE_storm11_07_18_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm11_07_18_NO3$valuedatetime <-as.POSIXct(POKE_storm11_07_18_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm11_07_18_fDOM$valuedatetime <-as.POSIXct(POKE_storm11_07_18_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm12_07_20_Q = subset(POKE_storm12_07_20, select = c("DateTime", "MeanDischarge"))
names(POKE_storm12_07_20_Q) = c("valuedatetime","datavalue")
POKE_storm12_07_20_NO3 = subset(POKE_storm12_07_20, select = c("DateTime","nitrateuM"))
names(POKE_storm12_07_20_NO3) = c("valuedatetime","datavalue")
POKE_storm12_07_20_fDOM = subset(POKE_storm12_07_20, select = c("DateTime","fDOM.RFU"))
names(POKE_storm12_07_20_fDOM) = c("valuedatetime","datavalue")

POKE_storm12_07_20_Q$valuedatetime <-as.POSIXct(POKE_storm12_07_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm12_07_20_NO3$valuedatetime <-as.POSIXct(POKE_storm12_07_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm12_07_20_fDOM$valuedatetime <-as.POSIXct(POKE_storm12_07_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm13_07_24_Q = subset(POKE_storm13_07_24, select = c("DateTime", "MeanDischarge"))
names(POKE_storm13_07_24_Q) = c("valuedatetime","datavalue")
POKE_storm13_07_24_NO3 = subset(POKE_storm13_07_24, select = c("DateTime","nitrateuM"))
names(POKE_storm13_07_24_NO3) = c("valuedatetime","datavalue")
POKE_storm13_07_24_fDOM = subset(POKE_storm13_07_24, select = c("DateTime","fDOM.RFU"))
names(POKE_storm13_07_24_fDOM) = c("valuedatetime","datavalue")

POKE_storm13_07_24_Q$valuedatetime <-as.POSIXct(POKE_storm13_07_24_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm13_07_24_NO3$valuedatetime <-as.POSIXct(POKE_storm13_07_24_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm13_07_24_fDOM$valuedatetime <-as.POSIXct(POKE_storm13_07_24_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm14_07_26_Q = subset(POKE_storm14_07_26, select = c("DateTime", "MeanDischarge"))
names(POKE_storm14_07_26_Q) = c("valuedatetime","datavalue")
POKE_storm14_07_26_NO3 = subset(POKE_storm14_07_26, select = c("DateTime","nitrateuM"))
names(POKE_storm14_07_26_NO3) = c("valuedatetime","datavalue")
POKE_storm14_07_26_fDOM = subset(POKE_storm14_07_26, select = c("DateTime","fDOM.RFU"))
names(POKE_storm14_07_26_fDOM) = c("valuedatetime","datavalue")

POKE_storm14_07_26_Q$valuedatetime <-as.POSIXct(POKE_storm14_07_26_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm14_07_26_NO3$valuedatetime <-as.POSIXct(POKE_storm14_07_26_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm14_07_26_fDOM$valuedatetime <-as.POSIXct(POKE_storm14_07_26_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm15_08_02_Q = subset(POKE_storm15_08_02, select = c("DateTime", "MeanDischarge"))
names(POKE_storm15_08_02_Q) = c("valuedatetime","datavalue")
POKE_storm15_08_02_NO3 = subset(POKE_storm15_08_02, select = c("DateTime","nitrateuM"))
names(POKE_storm15_08_02_NO3) = c("valuedatetime","datavalue")
POKE_storm15_08_02_fDOM = subset(POKE_storm15_08_02, select = c("DateTime","fDOM.RFU"))
names(POKE_storm15_08_02_fDOM) = c("valuedatetime","datavalue")

POKE_storm15_08_02_Q$valuedatetime <-as.POSIXct(POKE_storm15_08_02_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm15_08_02_NO3$valuedatetime <-as.POSIXct(POKE_storm15_08_02_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm15_08_02_fDOM$valuedatetime <-as.POSIXct(POKE_storm15_08_02_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm16_08_12_Q = subset(POKE_storm16_08_12, select = c("DateTime", "MeanDischarge"))
names(POKE_storm16_08_12_Q) = c("valuedatetime","datavalue")
POKE_storm16_08_12_NO3 = subset(POKE_storm16_08_12, select = c("DateTime","nitrateuM"))
names(POKE_storm16_08_12_NO3) = c("valuedatetime","datavalue")
POKE_storm16_08_12_fDOM = subset(POKE_storm16_08_12, select = c("DateTime","fDOM.RFU"))
names(POKE_storm16_08_12_fDOM) = c("valuedatetime","datavalue")

POKE_storm16_08_12_Q$valuedatetime <-as.POSIXct(POKE_storm16_08_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm16_08_12_NO3$valuedatetime <-as.POSIXct(POKE_storm16_08_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm16_08_12_fDOM$valuedatetime <-as.POSIXct(POKE_storm16_08_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm17_08_24_Q = subset(POKE_storm17_08_24, select = c("DateTime", "MeanDischarge"))
names(POKE_storm17_08_24_Q) = c("valuedatetime","datavalue")
POKE_storm17_08_24_NO3 = subset(POKE_storm17_08_24, select = c("DateTime","nitrateuM"))
names(POKE_storm17_08_24_NO3) = c("valuedatetime","datavalue")
POKE_storm17_08_24_fDOM = subset(POKE_storm17_08_24, select = c("DateTime","fDOM.RFU"))
names(POKE_storm17_08_24_fDOM) = c("valuedatetime","datavalue")

POKE_storm17_08_24_Q$valuedatetime <-as.POSIXct(POKE_storm17_08_24_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm17_08_24_NO3$valuedatetime <-as.POSIXct(POKE_storm17_08_24_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm17_08_24_fDOM$valuedatetime <-as.POSIXct(POKE_storm17_08_24_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm18_08_25_Q = subset(POKE_storm18_08_25, select = c("DateTime", "MeanDischarge"))
names(POKE_storm18_08_25_Q) = c("valuedatetime","datavalue")
POKE_storm18_08_25_NO3 = subset(POKE_storm18_08_25, select = c("DateTime","nitrateuM"))
names(POKE_storm18_08_25_NO3) = c("valuedatetime","datavalue")
POKE_storm18_08_25_fDOM = subset(POKE_storm18_08_25, select = c("DateTime","fDOM.RFU"))
names(POKE_storm18_08_25_fDOM) = c("valuedatetime","datavalue")

POKE_storm18_08_25_Q$valuedatetime <-as.POSIXct(POKE_storm18_08_25_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm18_08_25_NO3$valuedatetime <-as.POSIXct(POKE_storm18_08_25_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm18_08_25_fDOM$valuedatetime <-as.POSIXct(POKE_storm18_08_25_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm19_08_27_Q = subset(POKE_storm19_08_27, select = c("DateTime", "MeanDischarge"))
names(POKE_storm19_08_27_Q) = c("valuedatetime","datavalue")
POKE_storm19_08_27_NO3 = subset(POKE_storm19_08_27, select = c("DateTime","nitrateuM"))
names(POKE_storm19_08_27_NO3) = c("valuedatetime","datavalue")
POKE_storm19_08_27_fDOM = subset(POKE_storm19_08_27, select = c("DateTime","fDOM.RFU"))
names(POKE_storm19_08_27_fDOM) = c("valuedatetime","datavalue")

POKE_storm19_08_27_Q$valuedatetime <-as.POSIXct(POKE_storm19_08_27_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm19_08_27_NO3$valuedatetime <-as.POSIXct(POKE_storm19_08_27_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm19_08_27_fDOM$valuedatetime <-as.POSIXct(POKE_storm19_08_27_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm20_09_01_Q = subset(POKE_storm20_09_01, select = c("DateTime", "MeanDischarge"))
names(POKE_storm20_09_01_Q) = c("valuedatetime","datavalue")
POKE_storm20_09_01_NO3 = subset(POKE_storm20_09_01, select = c("DateTime","nitrateuM"))
names(POKE_storm20_09_01_NO3) = c("valuedatetime","datavalue")
POKE_storm20_09_01_fDOM = subset(POKE_storm20_09_01, select = c("DateTime","fDOM.RFU"))
names(POKE_storm20_09_01_fDOM) = c("valuedatetime","datavalue")

POKE_storm20_09_01_Q$valuedatetime <-as.POSIXct(POKE_storm20_09_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm20_09_01_NO3$valuedatetime <-as.POSIXct(POKE_storm20_09_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm20_09_01_fDOM$valuedatetime <-as.POSIXct(POKE_storm20_09_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm21_09_03_Q = subset(POKE_storm21_09_03, select = c("DateTime", "MeanDischarge"))
names(POKE_storm21_09_03_Q) = c("valuedatetime","datavalue")
POKE_storm21_09_03_NO3 = subset(POKE_storm21_09_03, select = c("DateTime","nitrateuM"))
names(POKE_storm21_09_03_NO3) = c("valuedatetime","datavalue")
POKE_storm21_09_03_fDOM = subset(POKE_storm21_09_03, select = c("DateTime","fDOM.RFU"))
names(POKE_storm21_09_03_fDOM) = c("valuedatetime","datavalue")

POKE_storm21_09_03_Q$valuedatetime <-as.POSIXct(POKE_storm21_09_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm21_09_03_NO3$valuedatetime <-as.POSIXct(POKE_storm21_09_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm21_09_03_fDOM$valuedatetime <-as.POSIXct(POKE_storm21_09_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm22a_09_07_Q = subset(POKE_storm22a_09_07, select = c("DateTime", "MeanDischarge"))
names(POKE_storm22a_09_07_Q) = c("valuedatetime","datavalue")
POKE_storm22a_09_07_NO3 = subset(POKE_storm22a_09_07, select = c("DateTime","nitrateuM"))
names(POKE_storm22a_09_07_NO3) = c("valuedatetime","datavalue")
POKE_storm22a_09_07_fDOM = subset(POKE_storm22a_09_07, select = c("DateTime","fDOM.RFU"))
names(POKE_storm22a_09_07_fDOM) = c("valuedatetime","datavalue")

POKE_storm22a_09_07_Q$valuedatetime <-as.POSIXct(POKE_storm22a_09_07_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm22a_09_07_NO3$valuedatetime <-as.POSIXct(POKE_storm22a_09_07_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm22a_09_07_fDOM$valuedatetime <-as.POSIXct(POKE_storm22a_09_07_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

POKE_storm22b_09_09_Q = subset(POKE_storm22b_09_09, select = c("DateTime", "MeanDischarge"))
names(POKE_storm22b_09_09_Q) = c("valuedatetime","datavalue")
POKE_storm22b_09_09_NO3 = subset(POKE_storm22b_09_09, select = c("DateTime","nitrateuM"))
names(POKE_storm22b_09_09_NO3) = c("valuedatetime","datavalue")
POKE_storm22b_09_09_fDOM = subset(POKE_storm22b_09_09, select = c("DateTime","fDOM.RFU"))
names(POKE_storm22b_09_09_fDOM) = c("valuedatetime","datavalue")

POKE_storm22b_09_09_Q$valuedatetime <-as.POSIXct(POKE_storm22b_09_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm22b_09_09_NO3$valuedatetime <-as.POSIXct(POKE_storm22b_09_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
POKE_storm22b_09_09_fDOM$valuedatetime <-as.POSIXct(POKE_storm22b_09_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

### Write csv ###
write.csv(POKE_storm1_06_09, "Storms/POKE_storm1_06_09.csv")
write.csv(POKE_storm1_06_09_Q, "Storms/POKE_storm1_06_09_Q.csv")
write.csv(POKE_storm1_06_09_NO3, "Storms/POKE_storm1_06_09_NO3.csv")
write.csv(POKE_storm1_06_09_fDOM, "Storms/POKE_storm1_06_09_fDOM.csv")

write.csv(POKE_storm2_06_12, "Storms/POKE_storm2_06_12.csv")
write.csv(POKE_storm2_06_12_Q, "Storms/POKE_storm2_06_12_Q.csv")
write.csv(POKE_storm2_06_12_NO3, "Storms/POKE_storm2_06_12_NO3.csv")
write.csv(POKE_storm2_06_12_fDOM, "Storms/POKE_storm2_06_12_fDOM.csv")

write.csv(POKE_storm3_06_15, "Storms/POKE_storm3_06_15.csv")
write.csv(POKE_storm3_06_15_Q, "Storms/POKE_storm3_06_15_Q.csv")
write.csv(POKE_storm3_06_15_NO3, "Storms/POKE_storm3_06_15_NO3.csv")
write.csv(POKE_storm3_06_15_fDOM, "Storms/POKE_storm3_06_15_fDOM.csv")

write.csv(POKE_storm4a_06_19, "Storms/POKE_storm4a_06_19.csv")
write.csv(POKE_storm4a_06_19_Q, "Storms/POKE_storm4a_06_19_Q.csv")
write.csv(POKE_storm4a_06_19_NO3, "Storms/POKE_storm4a_06_19_NO3.csv")
write.csv(POKE_storm4a_06_19_fDOM, "Storms/POKE_storm4a_06_19_fDOM.csv")

write.csv(POKE_storm4b_06_20, "Storms/POKE_storm4b_06_20.csv")
write.csv(POKE_storm4b_06_20_Q, "Storms/POKE_storm4b_06_20_Q.csv")
write.csv(POKE_storm4b_06_20_NO3, "Storms/POKE_storm4b_06_20_NO3.csv")
write.csv(POKE_storm4b_06_20_fDOM, "Storms/POKE_storm4b_06_20_fDOM.csv")

write.csv(POKE_storm4c_06_21, "Storms/POKE_storm4c_06_21.csv")
write.csv(POKE_storm4c_06_21_Q, "Storms/POKE_storm4c_06_21_Q.csv")
write.csv(POKE_storm4c_06_21_NO3, "Storms/POKE_storm4c_06_21_NO3.csv")
write.csv(POKE_storm4c_06_21_fDOM, "Storms/POKE_storm4c_06_21_fDOM.csv")

write.csv(POKE_storm5_06_22, "Storms/POKE_storm5_06_22.csv")
write.csv(POKE_storm5_06_22_Q, "Storms/POKE_storm5_06_22_Q.csv")
write.csv(POKE_storm5_06_22_NO3, "Storms/POKE_storm5_06_22_NO3.csv")
write.csv(POKE_storm5_06_22_fDOM, "Storms/POKE_storm5_06_22_fDOM.csv")

write.csv(POKE_storm6_06_29, "Storms/POKE_storm6_06_29.csv")
write.csv(POKE_storm6_06_29_Q, "Storms/POKE_storm6_06_29_Q.csv")
write.csv(POKE_storm6_06_29_NO3, "Storms/POKE_storm6_06_29_NO3.csv")
write.csv(POKE_storm6_06_29_fDOM, "Storms/POKE_storm6_06_29_fDOM.csv")

write.csv(POKE_storm7_07_04, "Storms/POKE_storm7_07_04.csv")
write.csv(POKE_storm7_07_04_Q, "Storms/POKE_storm7_07_04_Q.csv")
write.csv(POKE_storm7_07_04_NO3, "Storms/POKE_storm7_07_04_NO3.csv")
write.csv(POKE_storm7_07_04_fDOM, "Storms/POKE_storm7_07_04_fDOM.csv")

write.csv(POKE_storm8_07_09, "Storms/POKE_storm8_07_09.csv")
write.csv(POKE_storm8_07_09_Q, "Storms/POKE_storm8_07_09_Q.csv")
write.csv(POKE_storm8_07_09_NO3, "Storms/POKE_storm8_07_09_NO3.csv")
write.csv(POKE_storm8_07_09_fDOM, "Storms/POKE_storm8_07_09_fDOM.csv")

write.csv(POKE_storm9_07_12, "Storms/POKE_storm9_07_12.csv")
write.csv(POKE_storm9_07_12_Q, "Storms/POKE_storm9_07_12_Q.csv")
write.csv(POKE_storm9_07_12_NO3, "Storms/POKE_storm9_07_12_NO3.csv")
write.csv(POKE_storm9_07_12_fDOM, "Storms/POKE_storm9_07_12_fDOM.csv")

write.csv(POKE_storm10_07_16, "Storms/POKE_storm10_07_16.csv")
write.csv(POKE_storm10_07_16_Q, "Storms/POKE_storm10_07_16_Q.csv")
write.csv(POKE_storm10_07_16_NO3, "Storms/POKE_storm10_07_16_NO3.csv")
write.csv(POKE_storm10_07_16_fDOM, "Storms/POKE_storm10_07_16_fDOM.csv")

write.csv(POKE_storm11_07_18, "Storms/POKE_storm11_07_18.csv")
write.csv(POKE_storm11_07_18_Q, "Storms/POKE_storm11_07_18_Q.csv")
write.csv(POKE_storm11_07_18_NO3, "Storms/POKE_storm11_07_18_NO3.csv")
write.csv(POKE_storm11_07_18_fDOM, "Storms/POKE_storm11_07_18_fDOM.csv")

write.csv(POKE_storm12_07_20, "Storms/POKE_storm12_07_20.csv")
write.csv(POKE_storm12_07_20_Q, "Storms/POKE_storm12_07_20_Q.csv")
write.csv(POKE_storm12_07_20_NO3, "Storms/POKE_storm12_07_20_NO3.csv")
write.csv(POKE_storm12_07_20_fDOM, "Storms/POKE_storm12_07_20_fDOM.csv")

write.csv(POKE_storm13_07_24, "Storms/POKE_storm13_07_24.csv")
write.csv(POKE_storm13_07_24_Q, "Storms/POKE_storm13_07_24_Q.csv")
write.csv(POKE_storm13_07_24_NO3, "Storms/POKE_storm13_07_24_NO3.csv")
write.csv(POKE_storm13_07_24_fDOM, "Storms/POKE_storm13_07_24_fDOM.csv")

write.csv(POKE_storm14_07_26, "Storms/POKE_storm14_07_26.csv")
write.csv(POKE_storm14_07_26_Q, "Storms/POKE_storm14_07_26_Q.csv")
write.csv(POKE_storm14_07_26_NO3, "Storms/POKE_storm14_07_26_NO3.csv")
write.csv(POKE_storm14_07_26_fDOM, "Storms/POKE_storm14_07_26_fDOM.csv")

write.csv(POKE_storm15_08_02, "Storms/POKE_storm15_08_02.csv")
write.csv(POKE_storm15_08_02_Q, "Storms/POKE_storm15_08_02_Q.csv")
write.csv(POKE_storm15_08_02_NO3, "Storms/POKE_storm15_08_02_NO3.csv")
write.csv(POKE_storm15_08_02_fDOM, "Storms/POKE_storm15_08_02_fDOM.csv")

write.csv(POKE_storm16_08_12, "Storms/POKE_storm16_08_12.csv")
write.csv(POKE_storm16_08_12_Q, "Storms/POKE_storm16_08_12_Q.csv")
write.csv(POKE_storm16_08_12_NO3, "Storms/POKE_storm16_08_12_NO3.csv")
write.csv(POKE_storm16_08_12_fDOM, "Storms/POKE_storm16_08_12_fDOM.csv")

write.csv(POKE_storm17_08_24, "Storms/POKE_storm17_08_24.csv")
write.csv(POKE_storm17_08_24_Q, "Storms/POKE_storm17_08_24_Q.csv")
write.csv(POKE_storm17_08_24_NO3, "Storms/POKE_storm17_08_24_NO3.csv")
write.csv(POKE_storm17_08_24_fDOM, "Storms/POKE_storm17_08_24_fDOM.csv")

write.csv(POKE_storm18_08_25, "Storms/POKE_storm18_08_25.csv")
write.csv(POKE_storm18_08_25_Q, "Storms/POKE_storm18_08_25_Q.csv")
write.csv(POKE_storm18_08_25_NO3, "Storms/POKE_storm18_08_25_NO3.csv")
write.csv(POKE_storm18_08_25_fDOM, "Storms/POKE_storm18_08_25_fDOM.csv")

write.csv(POKE_storm19_08_27, "Storms/POKE_storm19_08_27.csv")
write.csv(POKE_storm19_08_27_Q, "Storms/POKE_storm19_08_27_Q.csv")
write.csv(POKE_storm19_08_27_NO3, "Storms/POKE_storm19_08_27_NO3.csv")
write.csv(POKE_storm19_08_27_fDOM, "Storms/POKE_storm19_08_27_fDOM.csv")

write.csv(POKE_storm20_09_01, "Storms/POKE_storm20_09_01.csv")
write.csv(POKE_storm20_09_01_Q, "Storms/POKE_storm20_09_01_Q.csv")
write.csv(POKE_storm20_09_01_NO3, "Storms/POKE_storm20_09_01_NO3.csv")
write.csv(POKE_storm20_09_01_fDOM, "Storms/POKE_storm20_09_01_fDOM.csv")

write.csv(POKE_storm21_09_03, "Storms/POKE_storm21_09_03.csv")
write.csv(POKE_storm21_09_03_Q, "Storms/POKE_storm21_09_03_Q.csv")
write.csv(POKE_storm21_09_03_NO3, "Storms/POKE_storm21_09_03_NO3.csv")
write.csv(POKE_storm21_09_03_fDOM, "Storms/POKE_storm21_09_03_fDOM.csv")

write.csv(POKE_storm22a_09_07, "Storms/POKE_storm22a_09_07.csv")
write.csv(POKE_storm22a_09_07_Q, "Storms/POKE_storm22a_09_07_Q.csv")
write.csv(POKE_storm22a_09_07_NO3, "Storms/POKE_storm22a_09_07_NO3.csv")
write.csv(POKE_storm22a_09_07_fDOM, "Storms/POKE_storm22a_09_07_fDOM.csv")

write.csv(POKE_storm22b_09_09, "Storms/POKE_storm22b_09_09.csv")
write.csv(POKE_storm22b_09_09_Q, "Storms/POKE_storm22b_09_09_Q.csv")
write.csv(POKE_storm22b_09_09_NO3, "Storms/POKE_storm22b_09_09_NO3.csv")
write.csv(POKE_storm22b_09_09_fDOM, "Storms/POKE_storm22b_09_09_fDOM.csv")


### MOOS ###
### Import precipitation data into the *ALL document ### 
# FRCH rain gauge installed on the 11th of June. 
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-05 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'FRCH precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-05 0:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"),
     ylim = c(15,0), 
     axes=F, xlab="", ylab="")
par(new = T)
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 00:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
lines(MOOS$nitrateuM * 40 ~ MOOS.no3$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))
lines(MOOS$fDOM.RFU * 20 ~ MOOS.fDOM$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-06-01 00:00:00","2020-10-15 01:00:00"), tz="America/Anchorage"))


### STORMS ###
# Storm 1 #
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-21 00:00:00","2020-07-10 00:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-21 0:00:00","2020-07-10 00:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-20 19:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-06-28 10:00:00", tz="America/Anchorage"), col="purple")

MOOS_storm1_06_21 = MOOS[MOOS$DateTime > as.POSIXct("2020-06-20 19:00:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-06-28 08:00:00", tz="America/Anchorage"),]
plot(MOOS_storm1_06_21$MeanDischarge ~ as.POSIXct(MOOS_storm1_06_21$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,2700), col="blue", main="MOOS 200621 storm 1",
     xlim = as.POSIXct(c("2020-06-20 0:00:00","2020-07-10 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-20 00:00:00","2020-07-10 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 2 #
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-06-21 00:00:00","2020-07-10 00:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-21 0:00:00","2020-07-10 00:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-06-28 10:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-01 20:00:00", tz="America/Anchorage"), col="purple")

MOOS_storm2_06_28 = MOOS[MOOS$DateTime > as.POSIXct("2020-06-28 10:00:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-07-01 20:00:00", tz="America/Anchorage"),]
plot(MOOS_storm2_06_28$MeanDischarge ~ as.POSIXct(MOOS_storm2_06_28$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1200,2000), col="blue", main="MOOS 200628 storm 2",
     xlim = as.POSIXct(c("2020-06-20 0:00:00","2020-07-10 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-06-20 00:00:00","2020-07-10 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Alarm # Doesnt show an increase in discharge or chem = NO STORM
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-14 00:00:00","2020-07-15 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)
lines(moos.no3.final$nitrateuM * 40 ~ moos.no3.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-14 00:00:00","2020-07-15 01:00:00"), tz="America/Anchorage"))
lines(moos.fdom.final$fDOM.QSU * 20 ~ moos.fdom.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-07-14 00:00:00","2020-07-15 01:00:00"), tz="America/Anchorage"))
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-14 0:00:00","2020-07-16 00:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)

# Storm 3 #
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-18 11:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-19 20:00:00", tz="America/Anchorage"), col="purple")

MOOS_storm3_07_18 = MOOS[MOOS$DateTime > as.POSIXct("2020-07-18 11:30:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-07-19 12:00:00", tz="America/Anchorage"),]
plot(MOOS_storm3_07_18$MeanDischarge ~ as.POSIXct(MOOS_storm3_07_18$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200718 storm 3",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 4 #
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-16 00:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)

plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-20 11:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-23 20:00:00", tz="America/Anchorage"), col="purple")

MOOS_storm4_07_20 = MOOS[MOOS$DateTime > as.POSIXct("2020-07-20 11:30:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-07-23 20:00:00", tz="America/Anchorage"),]
plot(MOOS_storm4_07_20$MeanDischarge ~ as.POSIXct(MOOS_storm4_07_20$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200720 storm 4",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-16 0:00:00","2020-07-24 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 5 # 
plot(MOOS$MeanDischarge ~ MOOS$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-07-24 00:00:00","2020-07-31 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-24 00:00:00","2020-07-31 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.1)
abline(v= as.POSIXct("2020-07-27 2:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-07-29 14:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm5_07_27 = MOOS[MOOS$DateTime > as.POSIXct("2020-07-27 02:30:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-07-29 16:45:00", tz="America/Anchorage"),]
plot(MOOS_storm5_07_27$MeanDischarge ~ as.POSIXct(MOOS_storm5_07_27$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200727 storm 5",
     xlim = as.POSIXct(c("2020-07-24 00:00:00","2020-07-31 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-07-24 00:00:00","2020-07-31 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)


# Storm 6a # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-08-01 20:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-02 23:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm6a_08_01 = MOOS[MOOS$DateTime > as.POSIXct("2020-08-01 01:30:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-08-02 21:45:00", tz="America/Anchorage"),]
plot(MOOS_storm6a_08_01$MeanDischarge ~ as.POSIXct(MOOS_storm6a_08_01$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1200), col="blue", main="MOOS 200801 storm 6a",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 6b # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-01 00:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-08-03 03:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-05 23:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm6b_08_03 = MOOS[MOOS$DateTime > as.POSIXct("2020-08-03 03:30:00", tz="America/Anchorage") &
                            MOOS$DateTime < as.POSIXct("2020-08-05 23:45:00", tz="America/Anchorage"),]
plot(MOOS_storm6b_08_03$MeanDischarge ~ as.POSIXct(MOOS_storm6b_08_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200803 storm 6b",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-01 0:00:00","2020-08-08 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7a # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-08-09 10:30:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-12 07:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm7a_08_09 = MOOS[MOOS$DateTime > as.POSIXct("2020-08-09 10:30:00", tz="America/Anchorage") &
                            MOOS$DateTime < as.POSIXct("2020-08-12 07:45:00", tz="America/Anchorage"),]
plot(MOOS_storm7a_08_09$MeanDischarge ~ as.POSIXct(MOOS_storm7a_08_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200809 storm 7a",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Storm 7b # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-08-12 09:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-14 07:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm7b_08_12 = MOOS[MOOS$DateTime > as.POSIXct("2020-08-12 09:00:00", tz="America/Anchorage") &
                            MOOS$DateTime < as.POSIXct("2020-08-14 07:45:00", tz="America/Anchorage"),]
plot(MOOS_storm7b_08_12$MeanDischarge ~ as.POSIXct(MOOS_storm7b_08_12$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(1000,1500), col="blue", main="MOOS 200812 storm 7b",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-09 00:00:00","2020-08-19 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# alarm # Not showing an increase in discharge or chemistry...no storm 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-09-02 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
lines(moos.no3.final$nitrateuM * 40 ~ moos.no3.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-09-02 20:00:00"), tz="America/Anchorage"))
lines(moos.fdom.final$fDOM.QSU * 20 ~ moos.fdom.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-09-02 20:00:00"), tz="America/Anchorage"))

par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-08-20 0:00:00","2020-09-02 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-08-12 08:00:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-08-16 19:45:00", tz="America/Anchorage"), col="purple")

# Storm 8 # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)
lines(moos.no3.final$nitrateuM * 40 ~ moos.no3.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"))
lines(moos.fdom.final$fDOM.QSU * 15 ~ moos.fdom.final$DateTime, type="l", xlab="", ylab="", col="purple",
      xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"))



plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-09-06 17:45:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-08 18:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm8_09_03 = MOOS[MOOS$DateTime > as.POSIXct("2020-09-06 17:45:00", tz="America/Anchorage") &
                           MOOS$DateTime < as.POSIXct("2020-09-08 18:45:00", tz="America/Anchorage"),]
plot(MOOS_storm8_09_03$MeanDischarge ~ as.POSIXct(MOOS_storm8_09_03$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(500,1000), col="blue", main="MOOS 200903 storm 8",
     xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-03 0:00:00","2020-09-08 23:45:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)


# Storm 9 # 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-08 00:00:00","2020-09-13 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-09 0:00:00","2020-09-13 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-09-09 16:45:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-11 17:45:00", tz="America/Anchorage"), col="purple")

MOOS_storm9_09_09 = MOOS[MOOS$DateTime > as.POSIXct("2020-09-09 16:45:00", tz="America/Anchorage") &
                            MOOS$DateTime < as.POSIXct("2020-09-11 17:45:00", tz="America/Anchorage"),]
plot(MOOS_storm9_09_09$MeanDischarge ~ as.POSIXct(MOOS_storm9_09_09$DateTime, tz="America/Anchorage"), type="l", xlab="", ylab="Q (L/sec)",ylim = c(900,1700), col="blue", main="MOOS 200909 storm 9",
     xlim = as.POSIXct(c("2020-09-09 0:00:00","2020-09-13 20:00:00"), tz="America/Anchorage"))

par(new = T)
plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-09 0:00:00","2020-09-13 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)

# Checking to see if the rest of the data set has a storm in it and it doesnt appear so 
plot(moos.final.discharge$MeanDischarge ~ moos.final.discharge$DateTime, type="l", xlab="", ylab="Q (L/sec)",
     xlim = as.POSIXct(c("2020-09-13 0:00:00","2020-10-13 20:00:00"), tz="America/Anchorage"))
abline(h=MOOS_bfQ_mn*2, col="red", lty=2)
abline(h=MOOS_bfQ_mn, col="red")
par(new = T)


plot(FRCH.st$inst_rainfall_mm ~ FRCH.st$DateTime, type="h",
     xlim = as.POSIXct(c("2020-09-13 0:00:00","2020-10-13 20:00:00"), tz="America/Anchorage"),
     ylim = c(5,0), 
     axes=F, xlab="", ylab="")
axis(side = 4)
mtext(side = 4, line = 3, 'CRREL Met Station precip. (mm)') 
abline(v = as.POSIXct(frch.five.fourty.eight$DateTime), col = "yellow", lwd = 0.1)
abline(v = as.POSIXct(frch.five.twenty.four$DateTime), col="green", lwd = 0.3)
abline(v= as.POSIXct("2020-09-09 08:45:00", tz="America/Anchorage"), col="purple")
abline(v= as.POSIXct("2020-09-13 18:45:00", tz="America/Anchorage"), col="purple")

#### modify format and save MOOS storms ####

# nitrateuM, fDOM.QSU 
# Storm 1 #
MOOS_storm1_06_21_Q = subset(MOOS_storm1_06_21, select = c("DateTime","MeanDischarge"))
names(MOOS_storm1_06_21_Q) = c("valuedatetime","datavalue")
MOOS_storm1_06_21_NO3 = subset(MOOS_storm1_06_21, select = c("DateTime", "nitrateuM"))
names(MOOS_storm1_06_21_NO3) = c("valuedatetime","datavalue")
MOOS_storm1_06_21_fDOM = subset(MOOS_storm1_06_21, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm1_06_21_fDOM) = c("valuedatetime","datavalue")

MOOS_storm1_06_21_Q$valuedatetime <-as.POSIXct(MOOS_storm1_06_21_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm1_06_21_NO3$valuedatetime <-as.POSIXct(MOOS_storm1_06_21_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm1_06_21_fDOM$valuedatetime <-as.POSIXct(MOOS_storm1_06_21_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 2 #
MOOS_storm2_06_28_Q = subset(MOOS_storm2_06_28, select = c("DateTime","MeanDischarge"))
names(MOOS_storm2_06_28_Q) = c("valuedatetime","datavalue")
MOOS_storm2_06_28_NO3 = subset(MOOS_storm2_06_28, select = c("DateTime", "nitrateuM"))
names(MOOS_storm2_06_28_NO3) = c("valuedatetime","datavalue")
MOOS_storm2_06_28_fDOM = subset(MOOS_storm2_06_28, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm2_06_28_fDOM) = c("valuedatetime","datavalue")

MOOS_storm2_06_28_Q$valuedatetime <-as.POSIXct(MOOS_storm2_06_28_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm2_06_28_NO3$valuedatetime <-as.POSIXct(MOOS_storm2_06_28_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm2_06_28_fDOM$valuedatetime <-as.POSIXct(MOOS_storm2_06_28_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 3 #
MOOS_storm3_07_18_Q = subset(MOOS_storm3_07_18, select = c("DateTime","MeanDischarge"))
names(MOOS_storm3_07_18_Q) = c("valuedatetime","datavalue")
MOOS_storm3_07_18_NO3 = subset(MOOS_storm3_07_18, select = c("DateTime", "nitrateuM"))
names(MOOS_storm3_07_18_NO3) = c("valuedatetime","datavalue")
MOOS_storm3_07_18_fDOM = subset(MOOS_storm3_07_18, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm3_07_18_fDOM) = c("valuedatetime","datavalue")

MOOS_storm3_07_18_Q$valuedatetime <-as.POSIXct(MOOS_storm3_07_18_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm3_07_18_NO3$valuedatetime <-as.POSIXct(MOOS_storm3_07_18_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm3_07_18_fDOM$valuedatetime <-as.POSIXct(MOOS_storm3_07_18_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 4 #
MOOS_storm4_07_20_Q = subset(MOOS_storm4_07_20, select = c("DateTime","MeanDischarge"))
names(MOOS_storm4_07_20_Q) = c("valuedatetime","datavalue")
MOOS_storm4_07_20_NO3 = subset(MOOS_storm4_07_20, select = c("DateTime", "nitrateuM"))
names(MOOS_storm4_07_20_NO3) = c("valuedatetime","datavalue")
MOOS_storm4_07_20_fDOM = subset(MOOS_storm4_07_20, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm4_07_20_fDOM) = c("valuedatetime","datavalue")

MOOS_storm4_07_20_Q$valuedatetime <-as.POSIXct(MOOS_storm4_07_20_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm4_07_20_NO3$valuedatetime <-as.POSIXct(MOOS_storm4_07_20_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm4_07_20_fDOM$valuedatetime <-as.POSIXct(MOOS_storm4_07_20_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 5 #
MOOS_storm5_07_27_Q = subset(MOOS_storm5_07_27, select = c("DateTime","MeanDischarge"))
names(MOOS_storm5_07_27_Q) = c("valuedatetime","datavalue")
MOOS_storm5_07_27_NO3 = subset(MOOS_storm5_07_27, select = c("DateTime", "nitrateuM"))
names(MOOS_storm5_07_27_NO3) = c("valuedatetime","datavalue")
MOOS_storm5_07_27_fDOM = subset(MOOS_storm5_07_27, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm5_07_27_fDOM) = c("valuedatetime","datavalue")

MOOS_storm5_07_27_Q$valuedatetime <-as.POSIXct(MOOS_storm5_07_27_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm5_07_27_NO3$valuedatetime <-as.POSIXct(MOOS_storm5_07_27_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm5_07_27_fDOM$valuedatetime <-as.POSIXct(MOOS_storm5_07_27_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 6a #
MOOS_storm6a_08_01_Q = subset(MOOS_storm6a_08_01, select = c("DateTime","MeanDischarge"))
names(MOOS_storm6a_08_01_Q) = c("valuedatetime","datavalue")
MOOS_storm6a_08_01_NO3 = subset(MOOS_storm6a_08_01, select = c("DateTime", "nitrateuM"))
names(MOOS_storm6a_08_01_NO3) = c("valuedatetime","datavalue")
MOOS_storm6a_08_01_fDOM = subset(MOOS_storm6a_08_01, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm6a_08_01_fDOM) = c("valuedatetime","datavalue")

MOOS_storm6a_08_01_Q$valuedatetime <-as.POSIXct(MOOS_storm6a_08_01_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm6a_08_01_NO3$valuedatetime <-as.POSIXct(MOOS_storm6a_08_01_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm6a_08_01_fDOM$valuedatetime <-as.POSIXct(MOOS_storm6a_08_01_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 6b #
MOOS_storm6b_08_03_Q = subset(MOOS_storm6b_08_03, select = c("DateTime","MeanDischarge"))
names(MOOS_storm6b_08_03_Q) = c("valuedatetime","datavalue")
MOOS_storm6b_08_03_NO3 = subset(MOOS_storm6b_08_03, select = c("DateTime", "nitrateuM"))
names(MOOS_storm6b_08_03_NO3) = c("valuedatetime","datavalue")
MOOS_storm6b_08_03_fDOM = subset(MOOS_storm6b_08_03, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm6b_08_03_fDOM) = c("valuedatetime","datavalue")

MOOS_storm6b_08_03_Q$valuedatetime <-as.POSIXct(MOOS_storm6b_08_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm6b_08_03_NO3$valuedatetime <-as.POSIXct(MOOS_storm6b_08_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm6b_08_03_fDOM$valuedatetime <-as.POSIXct(MOOS_storm6b_08_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")


# Storm 7a #
MOOS_storm7a_08_09_Q = subset(MOOS_storm7a_08_09, select = c("DateTime","MeanDischarge"))
names(MOOS_storm7a_08_09_Q) = c("valuedatetime","datavalue")
MOOS_storm7a_08_09_NO3 = subset(MOOS_storm7a_08_09, select = c("DateTime", "nitrateuM"))
names(MOOS_storm7a_08_09_NO3) = c("valuedatetime","datavalue")
MOOS_storm7a_08_09_fDOM = subset(MOOS_storm7a_08_09, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm7a_08_09_fDOM) = c("valuedatetime","datavalue")

MOOS_storm7a_08_09_Q$valuedatetime <-as.POSIXct(MOOS_storm7a_08_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm7a_08_09_NO3$valuedatetime <-as.POSIXct(MOOS_storm7a_08_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm7a_08_09_fDOM$valuedatetime <-as.POSIXct(MOOS_storm7a_08_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 7b #
MOOS_storm7b_08_12_Q = subset(MOOS_storm7b_08_12, select = c("DateTime","MeanDischarge"))
names(MOOS_storm7b_08_12_Q) = c("valuedatetime","datavalue")
MOOS_storm7b_08_12_NO3 = subset(MOOS_storm7b_08_12, select = c("DateTime", "nitrateuM"))
names(MOOS_storm7b_08_12_NO3) = c("valuedatetime","datavalue")
MOOS_storm7b_08_12_fDOM = subset(MOOS_storm7b_08_12, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm7b_08_12_fDOM) = c("valuedatetime","datavalue")

MOOS_storm7b_08_12_Q$valuedatetime <-as.POSIXct(MOOS_storm7b_08_12_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm7b_08_12_NO3$valuedatetime <-as.POSIXct(MOOS_storm7b_08_12_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm7b_08_12_fDOM$valuedatetime <-as.POSIXct(MOOS_storm7b_08_12_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm 8 #
MOOS_storm8_09_03_Q = subset(MOOS_storm8_09_03, select = c("DateTime","MeanDischarge"))
names(MOOS_storm8_09_03_Q) = c("valuedatetime","datavalue")
MOOS_storm8_09_03_NO3 = subset(MOOS_storm8_09_03, select = c("DateTime", "nitrateuM"))
names(MOOS_storm8_09_03_NO3) = c("valuedatetime","datavalue")
MOOS_storm8_09_03_fDOM = subset(MOOS_storm8_09_03, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm8_09_03_fDOM) = c("valuedatetime","datavalue")

MOOS_storm8_09_03_Q$valuedatetime <-as.POSIXct(MOOS_storm8_09_03_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm8_09_03_NO3$valuedatetime <-as.POSIXct(MOOS_storm8_09_03_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm8_09_03_fDOM$valuedatetime <-as.POSIXct(MOOS_storm8_09_03_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

# Storm =9 #
MOOS_storm9_09_09_Q = subset(MOOS_storm9_09_09, select = c("DateTime","MeanDischarge"))
names(MOOS_storm9_09_09_Q) = c("valuedatetime","datavalue")
MOOS_storm9_09_09_NO3 = subset(MOOS_storm9_09_09, select = c("DateTime", "nitrateuM"))
names(MOOS_storm9_09_09_NO3) = c("valuedatetime","datavalue")
MOOS_storm9_09_09_fDOM = subset(MOOS_storm9_09_09, select = c("DateTime","fDOM.QSU"))
names(MOOS_storm9_09_09_fDOM) = c("valuedatetime","datavalue")

MOOS_storm9_09_09_Q$valuedatetime <-as.POSIXct(MOOS_storm9_09_09_Q$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm9_09_09_NO3$valuedatetime <-as.POSIXct(MOOS_storm9_09_09_NO3$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
MOOS_storm9_09_09_fDOM$valuedatetime <-as.POSIXct(MOOS_storm9_09_09_fDOM$valuedatetime, "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")

### Write csv ###
write.csv(MOOS_storm1_06_21, "Storms/MOOS_storm1_06_21.csv")
write.csv(MOOS_storm1_06_21_Q, "Storms/MOOS_storm1_06_21_Q.csv")
write.csv(MOOS_storm1_06_21_NO3, "Storms/MOOS_storm1_06_21_NO3.csv")
write.csv(MOOS_storm1_06_21_fDOM, "Storms/MOOS_storm1_06_21_fDOM.csv")

write.csv(MOOS_storm2_06_28, "Storms/MOOS_storm2_06_28.csv")
write.csv(MOOS_storm2_06_28_Q, "Storms/MOOS_storm2_06_28_Q.csv")
write.csv(MOOS_storm2_06_28_NO3, "Storms/MOOS_storm2_06_28_NO3.csv")
write.csv(MOOS_storm2_06_28_fDOM, "Storms/MOOS_storm2_06_28_fDOM.csv")

write.csv(MOOS_storm3_07_18, "Storms/MOOS_storm3_07_18.csv")
write.csv(MOOS_storm3_07_18_Q, "Storms/MOOS_storm3_07_18_Q.csv")
write.csv(MOOS_storm3_07_18_NO3, "Storms/MOOS_storm3_07_18_NO3.csv")
write.csv(MOOS_storm3_07_18_fDOM, "Storms/MOOS_storm3_07_18_fDOM.csv")

write.csv(MOOS_storm4_07_20, "Storms/MOOS_storm4_07_20.csv")
write.csv(MOOS_storm4_07_20_Q, "Storms/MOOS_storm4_07_20_Q.csv")
write.csv(MOOS_storm4_07_20_NO3, "Storms/MOOS_storm4_07_20_NO3.csv")
write.csv(MOOS_storm4_07_20_fDOM, "Storms/MOOS_storm4_07_20_fDOM.csv")

write.csv(MOOS_storm5_07_27, "Storms/MOOS_storm5_07_27.csv")
write.csv(MOOS_storm5_07_27_Q, "Storms/MOOS_storm5_07_27_Q.csv")
write.csv(MOOS_storm5_07_27_NO3, "Storms/MOOS_storm5_07_27_NO3.csv")
write.csv(MOOS_storm5_07_27_fDOM, "Storms/MOOS_storm5_07_27_fDOM.csv")

write.csv(MOOS_storm6a_08_01, "Storms/MOOS_storm6a_08_01.csv")
write.csv(MOOS_storm6a_08_01_Q, "Storms/MOOS_storm6a_08_01_Q.csv")
write.csv(MOOS_storm6a_08_01_NO3, "Storms/MOOS_storm6a_08_01_NO3.csv")
write.csv(MOOS_storm6a_08_01_fDOM, "Storms/MOOS_storm6a_08_01_fDOM.csv")

write.csv(MOOS_storm6b_08_03, "Storms/MOOS_storm6b_08_03.csv")
write.csv(MOOS_storm6b_08_03_Q, "Storms/MOOS_storm6b_08_03_Q.csv")
write.csv(MOOS_storm6b_08_03_NO3, "Storms/MOOS_storm6b_08_03_NO3.csv")
write.csv(MOOS_storm6b_08_03_fDOM, "Storms/MOOS_storm6b_08_03_fDOM.csv")

write.csv(MOOS_storm7a_08_09, "Storms/MOOS_storm7a_08_09.csv")
write.csv(MOOS_storm7a_08_09_Q, "Storms/MOOS_storm7a_08_09_Q.csv")
write.csv(MOOS_storm7a_08_09_NO3, "Storms/MOOS_storm7a_08_09_NO3.csv")
write.csv(MOOS_storm7a_08_09_fDOM, "Storms/MOOS_storm7a_08_09_fDOM.csv")

write.csv(MOOS_storm7b_08_12, "Storms/MOOS_storm7b_08_12.csv")
write.csv(MOOS_storm7b_08_12_Q, "Storms/MOOS_storm7b_08_12_Q.csv")
write.csv(MOOS_storm7b_08_12_NO3, "Storms/MOOS_storm7b_08_12_NO3.csv")
write.csv(MOOS_storm7b_08_12_fDOM, "Storms/MOOS_storm7b_08_12_fDOM.csv")

write.csv(MOOS_storm8_09_03, "Storms/MOOS_storm8_09_03.csv")
write.csv(MOOS_storm8_09_03_Q, "Storms/MOOS_storm8_09_03_Q.csv")
write.csv(MOOS_storm8_09_03_NO3, "Storms/MOOS_storm8_09_03_NO3.csv")
write.csv(MOOS_storm8_09_03_fDOM, "Storms/MOOS_storm8_09_03_fDOM.csv")

write.csv(MOOS_storm9_09_09, "Storms/MOOS_storm9_09_09.csv")
write.csv(MOOS_storm9_09_09_Q, "Storms/MOOS_storm9_09_09_Q.csv")
write.csv(MOOS_storm9_09_09_NO3, "Storms/MOOS_storm9_09_09_NO3.csv")
write.csv(MOOS_storm9_09_09_fDOM, "Storms/MOOS_storm9_09_09_fDOM.csv")



#### load storm data ####

storm_file_list <- list.files(path="Storms/", 
                              recursive=F, 
                              pattern=".csv", 
                              full.names=TRUE)

storm_list<-do.call("list", lapply(storm_file_list, 
                                   read.csv, 
                                   stringsAsFactors=FALSE, 
                                   header=T, row.names=1))

storm_file_list = sub("Storms//", storm_file_list, replacement = "")
storm_file_list = sub(".csv", storm_file_list, replacement = "")
names(storm_list) = storm_file_list

for(i in 1:length(storm_list)){
  storm_list[[i]][["valuedatetime"]] = as.POSIXct(storm_list[[i]][["valuedatetime"]],
                                                  "%Y-%m-%d %H:%M:%S", tz="America/Anchorage")
}

#### organize storm data by site and solute ####
STRT_storm_list = storm_list[c(1:72)]

STRT_NO3_storm_list = STRT_storm_list[c(grep("NO3", names(STRT_storm_list)))]
STRT_fDOM_storm_list = STRT_storm_list[c(grep("fDOM", names(STRT_storm_list)))]

#### load burst SUNA data ####


STRTfile_list <- list.files(path="SUNA_raw/C2/", 
                          recursive=F, 
                          pattern=".CSV", 
                          full.names=TRUE)



###################################################################################################
############################## 2019 & 2020 data together #########################################
###################################################################################################
#import 2019 
FRCH_Q_2019 <- read_csv("~/Documents/DoD_2019/Storm Analysis/Plots/Hydrograph Separation /FRCH/FRCH_Q_2019.csv") # discharge per day
FRCH_final_2019 <- read_csv("~/Documents/DoD_2019/Q/Final_Q/FRCH/FRCH.csv") # predicted discharge
FRCH_final_2019 <- FRCH_final_2019[,-c(4:5)] # Remove PTs

#import 2020 discharge per day
FRCH_Q_2020 <- read_csv("Predicted_Discharge/Processed/FRCH_Q_2020.csv")
FRCH_final_2020 <- read_csv("Predicted_Discharge/Processed/FRCH.csv")
names(FRCH_final_2020) <- c("Site", "DateTime", "MeanDischarge")

#Combine data sets
FRCH_all <- full_join(FRCH_Q_2019, FRCH_Q_2020)
FRCH_ALL.final.discharge <- full_join(FRCH_final_2019, FRCH_final_2020)

any(is.na(FRCH_ALL.final.discharge))
FRCH_ALL.final.discharge <- na.omit(FRCH_ALL.final.discharge) # Removed 4 rows

any(is.na(FRCH_all))
FRCH_all <- na.omit(FRCH_all) # Removed 22 rows

FRCH_Q_bf_2019_2020 = BaseflowSeparation(FRCH_ALL.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(FRCH_all, select = c(day, Discharge_Lsec)), streamflow2 = FRCH_Q_bf_2019_2020$bt) 

FRCH_Q_bf = BaseflowSeparation(frch.final.discharge$MeanDischarge, filter_parameter = 0.90, passes = 3)
hydrograph(input=subset(FRCH_Q, select = c(day, Discharge_Lsec)), streamflow2=FRCH_Q_bf$bt) 
hydrograph(FRCH_Q_bf_2019_2020)

