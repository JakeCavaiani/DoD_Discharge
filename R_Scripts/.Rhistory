mutate(across(c(WaterPressure),
~ifelse(DateTimeAK >= "2022-05-09" & DateTimeAK <= "2022-05-18", NA, .))) # PT wasnt placed into the stream until 5/17
poke.stream.one.2022 <- poke.stream.one.2022 %>%
mutate(across(c(WaterPressure),
~ifelse(DateTimeAK >= "2022-08-27" & DateTimeAK <= "2022-08-31" & WaterPressure < 98.3, NA, .))) %>% filter( DateTimeAK <= "2022-10-07 15:30:00")
poke.stream.one.2022 <- poke.stream.one.2022 %>%
mutate(across(c(WaterPressure),
~ifelse(DateTimeAK >= "2022-10-05" & DateTimeAK <= "2022-10-07" & WaterPressure < 98, NA, .)))
poke.stream.one.2022 <- poke.stream.one.2022 %>%
mutate(across(c(WaterPressure),
~ifelse(DateTimeAK >= "2022-10-05" & DateTimeAK <= "2022-10-07" & WaterPressure < 98, NA, .))) %>%
filter(DateTimeAK > "2022-08-01 16:15:00" | DateTimeAK < "2022-08-01 00:00:00") %>%
filter(DateTimeAK != "2022-08-07 19:00:00")
# shifting small step change
poke.2.before <- poke.stream.one.2022[c(1:16756), ]
poke.2.after <- poke.stream.one.2022[c(16758:40000), ]
poke.stream.one.2022[16756, 2] - poke.stream.one.2022[16758, 2] # 0.39
poke.2.after$WaterPressure <- poke.2.after[, 2] + 0.39
poke.stream.one.2022 <- full_join(poke.2.before, poke.2.after)
# shifting larger step change
poke.1.before2 <- poke.stream.one.2022[c(1:8125), ]
poke.1.after2 <- poke.stream.one.2022[c(8150:40000), ]
poke.stream.one.2022[8150, 2] - poke.stream.one.2022[8125, 2] # 1.55
poke.1.after2$WaterPressure <- poke.1.after2[, 2] + 1.55
poke.stream.one.2022 <- full_join(poke.1.before2, poke.1.after2)
poke.stream.one.2022 %>% #filter(DateTimeAK > "2022-08-07" & DateTimeAK < "2022-08-15") %>%
ggplot(aes(x = DateTimeAK, y = WaterPressure))+
geom_point() +
theme_classic()
poke.stream.two.2022 <- poke.stream.two.2022 %>%
mutate(across(c(WaterPressure),
~ifelse(DateTimeAK >= "2022-09-17" & WaterPressure < 98, NA, .))) %>%
filter(DateTimeAK <= "2022-10-07 15:35:00")
poke.stream.two.2022 %>% ggplot(aes(x = DateTimeAK, y = WaterPressure))+
geom_point() +
theme_classic()
# merge to one
poke.final.pressure.2022 <- left_join(poke.stream.one.2022, poke.stream.two.2022, by = c("DateTimeAK"))
poke.final.pressure.2022$MeanPressure <- rowMeans(poke.final.pressure.2022[,c(2,6)], na.rm = TRUE)
poke.final.pressure.2022 %>% ggplot() + geom_point(aes(DateTimeAK, WaterPressure.x)) + geom_point(aes(DateTimeAK, WaterPressure.y), color = "red", cex = 0.5)
## Use PT1 before August 1st and PT2 after August 1st
# Shift PT2 up to match August PT1
poke.final.pressure.2022 %>% filter(DateTimeAK > "2022-08-01" & DateTimeAK < "2022-08-15") %>% summarise(mean(WaterPressure.x - WaterPressure.y)) #2.62398
poke.final.pressure.2022 <- poke.final.pressure.2022 %>%
mutate(WaterPressure.merged = ifelse(DateTimeAK <= "2022-08-01", WaterPressure.x, WaterPressure.y))
# September step change
poke.before <- poke.final.pressure.2022[c(1:37665), ]
poke.after <- poke.final.pressure.2022[c(37705:40000), ]
poke.final.pressure.2022[37705, 9] - poke.final.pressure.2022[37665, 9] # 0.374
poke.after$WaterPressure.merged <- poke.after[, 9] + 0.374
poke.final.pressure.2022 <- rbind(poke.before, poke.after)
# End of August step change... move after data down all the way?
poke.before <- poke.final.pressure.2022[c(1:29616), ]
poke.after <- poke.final.pressure.2022[c(29628:40000), ]
poke.final.pressure.2022[29628, 9] - poke.final.pressure.2022[29616, 9] # 1.037
poke.after$WaterPressure.merged <- poke.after[, 9] - 1.037
poke.final.pressure.2022 <- rbind(poke.before, poke.after)
poke.final.pressure.2022 %>% #filter(DateTimeAK > "2022-08-29" & DateTimeAK < "2022-08-29 17:00:00") %>%
ggplot() + geom_point(aes(DateTimeAK, WaterPressure.merged))
#poke.final.pressure.2022 %>% filter(DateTimeAK > "2022-06-05" & DateTimeAK < "2022-06-06 17:00:00") %>% View()
View(poke.final.pressure.2022)
# End of August step change... move after data down all the way?
poke.before <- poke.final.pressure.2022[c(1:29616), ]
poke.after <- poke.final.pressure.2022[c(29709:40000), ]
poke.final.pressure.2022[29709, 9] - poke.final.pressure.2022[29616, 9] # 1.037
# merge to one
poke.final.pressure.2022 <- left_join(poke.stream.one.2022, poke.stream.two.2022, by = c("DateTimeAK"))
poke.final.pressure.2022$MeanPressure <- rowMeans(poke.final.pressure.2022[,c(2,6)], na.rm = TRUE)
poke.final.pressure.2022 %>% ggplot() + geom_point(aes(DateTimeAK, WaterPressure.x)) + geom_point(aes(DateTimeAK, WaterPressure.y), color = "red", cex = 0.5)
## Use PT1 before August 1st and PT2 after August 1st
# Shift PT2 up to match August PT1
poke.final.pressure.2022 %>% filter(DateTimeAK > "2022-08-01" & DateTimeAK < "2022-08-15") %>% summarise(mean(WaterPressure.x - WaterPressure.y)) #2.62398
poke.final.pressure.2022 <- poke.final.pressure.2022 %>%
mutate(WaterPressure.merged = ifelse(DateTimeAK <= "2022-08-01", WaterPressure.x, WaterPressure.y))
# September step change
poke.before <- poke.final.pressure.2022[c(1:37665), ]
poke.after <- poke.final.pressure.2022[c(37705:40000), ]
poke.final.pressure.2022[37705, 9] - poke.final.pressure.2022[37665, 9] # 0.374
poke.after$WaterPressure.merged <- poke.after[, 9] + 0.374
poke.final.pressure.2022 <- rbind(poke.before, poke.after)
poke.final.pressure.2022 %>% #filter(DateTimeAK > "2022-08-29" & DateTimeAK < "2022-08-29 17:00:00") %>%
ggplot() + geom_point(aes(DateTimeAK, WaterPressure.merged))
# End of August step change... move after data down all the way?
poke.before <- poke.final.pressure.2022[c(1:29300), ]
poke.after <- poke.final.pressure.2022[c(29301:40000), ]
poke.final.pressure.2022[29301, 9] - poke.final.pressure.2022[29300, 9] # 1.037
poke.final.pressure.2022 %>% #filter(DateTimeAK > "2022-08-29" & DateTimeAK < "2022-08-29 17:00:00") %>%
ggplot() + geom_point(aes(DateTimeAK, WaterPressure.merged))
# End of August step change... move after data down all the way?
poke.before <- poke.final.pressure.2022[c(1:29720), ]
poke.after <- poke.final.pressure.2022[c(29721:40000), ]
poke.final.pressure.2022[29721, 9] - poke.final.pressure.2022[29720, 9] # 1.037
# End of August step change... move after data down all the way?
poke.before <- poke.final.pressure.2022[c(1:29719), ]
poke.after <- poke.final.pressure.2022[c(29720:40000), ]
poke.final.pressure.2022[29720, 9] - poke.final.pressure.2022[29719, 9] # 1.037
poke.after$WaterPressure.merged <- poke.after[, 9] - 0.858
poke.final.pressure.2022 <- rbind(poke.before, poke.after)
poke.final.pressure.2022 %>% #filter(DateTimeAK > "2022-08-29" & DateTimeAK < "2022-08-29 17:00:00") %>%
ggplot() + geom_point(aes(DateTimeAK, WaterPressure.merged))
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
before <- POKE.2022 %>% filter(DateTimeAK > "2022-07-22 16:00:00" & DateTimeAK < "2022-07-23 16:00:00") %>% summarise(mean(difference, na.rm = TRUE))
after <- POKE.2022 %>% filter(DateTimeAK > "2022-08-02 00:45:00" & DateTimeAK < "2022-08-03 00:45:00") %>% summarise(mean(difference, na.rm = TRUE))
before - after
# Move data
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 2.223993*.75, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
before - after
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
before <- POKE.2022 %>% filter(DateTimeAK > "2022-07-22 16:00:00" & DateTimeAK < "2022-07-23 16:00:00") %>% summarise(mean(difference, na.rm = TRUE))
after <- POKE.2022 %>% filter(DateTimeAK > "2022-08-02 00:45:00" & DateTimeAK < "2022-08-03 00:45:00") %>% summarise(mean(difference, na.rm = TRUE))
before - after
# Move data
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 2.20*.5, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.5, .)))
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.5, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
### Filter POKE ###
QSummary.PO.2022 <- QSummary.2022 %>% filter(Site =="POKE")
ggplot(QSummary.PO.2022) +
geom_point(aes(x = DateTimeAK, y = MeasuredQ_Ls, shape = Method, color = Site), size=3) +
theme_classic() +
scale_color_manual(values=c("#6A3D9A")) +
ggtitle("POKE")
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Remove two high Q points points
Poker1comb.2022.2 <- Poker1comb.2022 %>% filter(MeasuredQ_Ls < 700 | difference > 4)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022.2) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
### Rating Curve ###
poke.formula <- y ~ poly(x, 2, raw = TRUE)
Poker1comb.2022.2 %>% filter(Method == "Wading Rod", difference < 2.5 | MeasuredQ_Ls > 300) %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.25, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
### Filter POKE ###
QSummary.PO.2022 <- QSummary.2022 %>% filter(Site =="POKE")
ggplot(QSummary.PO.2022) +
geom_point(aes(x = DateTimeAK, y = MeasuredQ_Ls, shape = Method, color = Site), size=3) +
theme_classic() +
scale_color_manual(values=c("#6A3D9A")) +
ggtitle("POKE")
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.75, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Remove two high Q points points
Poker1comb.2022.2 <- Poker1comb.2022 %>% filter(MeasuredQ_Ls < 700 | difference > 4)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022.2) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.5, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.6, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
### Filter POKE ###
QSummary.PO.2022 <- QSummary.2022 %>% filter(Site =="POKE")
ggplot(QSummary.PO.2022) +
geom_point(aes(x = DateTimeAK, y = MeasuredQ_Ls, shape = Method, color = Site), size=3) +
theme_classic() +
scale_color_manual(values=c("#6A3D9A")) +
ggtitle("POKE")
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.5, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.55, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Join the two atmospheric and water pressure together
poke.final.pressure.2022.2 <- poke.final.pressure.2022 %>% filter(!WaterPressure.merged %in% NA)
POKE.2022 <- left_join(eielson.atmo.2022.compare, poke.final.pressure.2022.2, by = "DateTimeAK")
## Bring the last chunk up half way?
101.250-98.134
POKE.2022 <- POKE.2022 %>%
mutate(across(c(WaterPressure.merged),
~ifelse(DateTimeAK > "2022-07-30", WaterPressure.merged + 3.116*.5, .)))
# Water pressure - atmospheric pressure
POKE.2022$difference <- POKE.2022$WaterPressure.merged - POKE.2022$AirPressureCorrectedPOKE
# Plot air and water pressure
POKE.2022 %>% #filter(DateTimeAK >"2022-09-26 10:00:00" & DateTimeAK < "2022-09-26 20:00:00") %>%
filter(DateTimeAK > "2022-05-25") %>%
ggplot(aes(DateTimeAK, WaterPressure.merged)) + geom_point() + geom_point(aes(DateTimeAK, AirPressureCorrectedPOKE), color = "red") #+ geom_point(aes(color = Method, x = DateTimeAK, y = WaterPressure.merged), data = Poker1comb.2022[c(19,20),])
# Plot difference
POKE.2022 %>% filter(DateTimeAK > "2022-05-15") %>%
ggplot(aes(DateTimeAK, difference)) + geom_point()
# Merge by nearest date if we have an offset point
POKE.2022.dt <- setDT(POKE.2022) %>% filter(!difference %in% NA)
QSummary.PO.2022.dt <- QSummary.PO.2022 %>% filter(DateTimeAK > "2022-05-17")
Poker1comb.2022 <- POKE.2022.dt[QSummary.PO.2022.dt, on = "DateTimeAK", roll = 'nearest']
POKE1.lm.2022 <- lm(Poker1comb.2022$MeasuredQ_Ls ~ Poker1comb.2022$difference)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
# xlim(-2, 2) +
#ylim(0,1500) +
theme_light() +
ggtitle("Poker all measured Q")
# Remove two high Q points points
Poker1comb.2022.2 <- Poker1comb.2022 %>% filter(MeasuredQ_Ls < 700 | difference > 4)
### Rating Curve ###
poke.formula <- y ~ x
ggplot(aes(x = difference, y = MeasuredQ_Ls), data = Poker1comb.2022.2) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
### Rating Curve ###
poke.formula <- y ~ x
Poker1comb.2022.2 %>% filter(Method == "Wading Rod", difference < 2.5 | MeasuredQ_Ls > 300) %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
### Rating Curve ###
poke.formula <- y ~ poly(x, 2, raw = TRUE)
Poker1comb.2022.2 %>% filter(Method == "Wading Rod", difference < 2.5 | MeasuredQ_Ls > 300) %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
### Rating Curve ###
poke.formula <- y ~ poly(x, 2, raw = TRUE)
Poker1comb.2022.2 %>% filter(Method == "Wading Rod") %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
poke.formula <- y ~ x
Poker1comb.2022.2 %>% filter(difference > 2.5 | MeasuredQ_Ls < 450) %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
poke.formula <- y ~ poly(x, 2, raw = TRUE)
Poker1comb.2022.2 %>% filter(difference > 2.5 | MeasuredQ_Ls < 450) %>% ggplot(aes(x = difference, y = MeasuredQ_Ls)) +
geom_point(aes(color = Method), size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = poke.formula) +
stat_poly_eq(formula = poke.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_light() +
ggtitle("Poker measured Q")
