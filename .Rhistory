ggtitle("MOOS")
ggplot(QSummary.FR) +
geom_point(aes(x = DateTimeAK, y = Q..L.s., color = site), size=3) +
theme_classic() +
scale_color_manual(values=c("#FF7F00")) +
ggtitle("FRCH")
#join the atmospheric and water pressure together
frch.stream$site <- "French"
FRCH.2015.one <- left_join(eielson.atmo.2015, frch.stream, by = "DateTimeAK")
# Water pressure - atmospheric pressure
FRCH.2015.one$difference <- FRCH.2015.one$AbsolutePressure - FRCH.2015.one$AirPressureCorrectedFRCH
# trying to merge by nearest date if we have an offset point
FRCH.2015.one.dt <- setDT(FRCH.2015.one)
View(FRCH.2015.one.dt)
FRCH.2015.one.dt <- subset(FRCH.2015.one.dt, DateTimeAK < "2015-09-20 19:00:00") # removing rows that had dates corresponding to end of record that messed up the rolling nearest function
QSummary.FR.dt <- QSummary.FR
French1comb.2015 <- FRCH.2015.one.dt[QSummary.FR.dt, on = "DateTimeAK", roll = 'nearest']
View(French1comb.2015)
FRCH1.lm.2015 <- lm(French1comb.2015$Q..L.s. ~ French1comb.2015$difference)
# plot rating curve
frch.formula = y~x
ggplot(aes(x = difference, y = Q..L.s.), data = French1comb.2015) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE, formula = frch.formula) +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
#xlim(216, 216.4) +
#ylim(0,1500) +
theme_light() +
ggtitle("French all measured Q")
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(TZ='America/Anchorage')
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readr)
library(lubridate)
library(rio)
library(neonUtilities)
library(raster)
library(data.table)
library(scales)
library(psych)
library(here)
library(googledrive)
library(readxl)
library(cowplot)
library(zoo)
library(RColorBrewer)
library(gridExtra)
library(ggpmisc)
library(imputeTS)
library(itsmr)
# Import processed Q data
moos.stream.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTng8WWrBVNB4uN7DHZuq1EfBn8tZ7qA71F7J-2izJUgeTU34LMbyXd_si8ezwscQ/pub?output=csv"
frch.stream.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2WNuEj8PTKLO6OkySK--koXwL6h_f3_WmctQTWkTlyB7boYmX1GmbT1HiVle6nA/pub?output=csv"
moos.stream <- read.csv(url(moos.stream.url), skip = 1)
frch.stream <- read.csv(url(frch.stream.url), skip = 1)
moos.stream <- moos.stream[,-c(3:4)] # Remove Na columns
frch.stream <- frch.stream[,-c(3:4)] # Remove Na columns
# Import summary notes from field book
discharge.2015 <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQC9Bk0nS-Cx4Ec8MyLHd2xNuSv8JTobR8SSV_ODQHAvp4cUK8k3z9EmOs/pub?output=csv"
QSummary <- read.csv(url(discharge.2015))
# Import rain gauge data #
caribou.2015.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vSolN8YGaUlUlcQjw9EaklcgcJu3b5L80X8Y-xX_ePg-CDOzZ07LDpl-aGBYvLwnvIhLB8Gm5Q66BWk/pub?output=csv"
caribou.2015.gauge <- read.csv(url(caribou.2015.url), skip = 4)
names(caribou.2015.gauge) <- c("DateTimeGMT", "Precip")
caribou.2015.gauge$DateTimeGMT[caribou.2015.gauge$DateTimeGMT == ""] <- NA
caribou.2015.gauge$DateTime = as.POSIXct(caribou.2015.gauge$DateTimeGMT, "%m/%d/%y %H:%M", tz="America/Anchorage")
# Rename columns #
names(moos.stream) <- c("Date", "AbsolutePressure")
names(frch.stream) <- c("Date", "AbsolutePressure")
#Convert time and put in AK time
moos.stream$DateTime <- mdy_hm(moos.stream$Date)
attributes(moos.stream$DateTime)$tzone <-'America/Anchorage'
frch.stream$DateTime <- mdy_hm(frch.stream$Date)
attributes(frch.stream$DateTime)$tzone <-'America/Anchorage'
QSummary$date <- mdy(QSummary$date)
QSummary$DateTime <- as.POSIXct(paste(QSummary$date, QSummary$time), format = "%Y-%m-%d %H:%M", tz = "America/Anchorage")
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
moos.stream <- moos.stream %>% subset(moos.stream$DateTime < "2015-09-20 18:30:00") # PT was taken out on the 21st
#june to july
moos.stream.1 <- moos.stream %>% subset(moos.stream$DateTime < "2015-07-01 00:00:00" & moos.stream$DateTime > "2015-06-01 00:00:00")
plot(moos.stream.1$DateTime, moos.stream.1$AbsolutePressure, type = "l")
which(moos.stream.1$AbsolutePressure < 102)
moos.stream.1[c(4052, 5270:5277), 2] <- NA
#july to august
moos.stream.2 <- moos.stream %>% subset(moos.stream$DateTime < "2015-08-01 00:00:00" & moos.stream$DateTime > "2015-07-01 00:00:00")
plot(moos.stream.2$DateTime, moos.stream.2$AbsolutePressure, type = "l")
which(moos.stream.2$AbsolutePressure < 102)
moos.stream.2$AbsolutePressure[moos.stream.2$AbsolutePressure == "99.188"] <- NA
moos.stream.2[2047, 2] <- NA
#august to September
moos.stream.3 <- moos.stream %>% subset(moos.stream$DateTime < "2015-09-01 00:00:00" & moos.stream$DateTime > "2015-08-01 00:00:00")
plot(moos.stream.3$DateTime, moos.stream.3$AbsolutePressure, type = "l")
which(moos.stream.3$AbsolutePressure < 102)
moos.stream.3[c(2679,2680,2681,2683), 2] <- NA
#September to October
moos.stream.4 <- moos.stream %>% subset(moos.stream$DateTime < "2015-10-01 00:00:00" & moos.stream$DateTime > "2015-09-01 00:00:00")
plot(moos.stream.4$DateTime, moos.stream.4$AbsolutePressure, type = "l")
moos.stream[c(9187, 10405:10412, 15822, 25382:25384, 25386), 2] <- NA
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
moos.stream <- na_kalman(moos.stream)
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
frch.stream <- frch.stream %>%  subset(frch.stream$DateTime < "2015-09-20 18:30:00") # PT was taken out on the 21st
#May to june
frch.stream.1 <- frch.stream %>% subset(frch.stream$DateTime < "2015-06-01 00:00:00" & frch.stream$DateTime > "2015-05-20 00:00:00")
plot(frch.stream.1$DateTime, frch.stream.1$AbsolutePressure, type = "l")
which(frch.stream.1$AbsolutePressure < 102)
frch.stream.1[c(1535, 2047:2060), 2] <- NA
#Juneto july
frch.stream.2 <- frch.stream %>% subset(frch.stream$DateTime < "2015-07-01 00:00:00" & frch.stream$DateTime > "2015-06-01 00:00:00")
plot(frch.stream.2$DateTime, frch.stream.2$AbsolutePressure, type = "l")
which(frch.stream.2$AbsolutePressure < 100)
frch.stream.2[c(49,2052,4111,5213:5241), 2] <- NA
#July to August # no cleaning necessary
frch.stream.3 <- frch.stream %>% subset(frch.stream$DateTime < "2015-08-01 00:00:00" & frch.stream$DateTime > "2015-07-01 00:00:00")
plot(frch.stream.3$DateTime, frch.stream.3$AbsolutePressure, type = "l")
#August to September
frch.stream.4 <- frch.stream %>% subset(frch.stream$DateTime < "2015-09-01 00:00:00" & frch.stream$DateTime > "2015-08-01 00:00:00")
plot(frch.stream.4$DateTime, frch.stream.4$AbsolutePressure, type = "l")
which(frch.stream.4$AbsolutePressure < 100)
frch.stream.4[c(2641:2656, 4631:4654), 2] <- NA
#September to October # no cleaning necessary
frch.stream.5 <- frch.stream %>% subset(frch.stream$DateTime < "2015-10-01 00:00:00" & frch.stream$DateTime > "2015-09-01 00:00:00")
plot(frch.stream.5$DateTime, frch.stream.5$AbsolutePressure, type = "l")
frch.stream[c(3215,3727:3740,5185,7188,9247,10349:10377,25340:25355,27328:27353), 2] <- NA
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
frch.stream <- na_kalman(frch.stream)
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
# ALL Sites #
all <- ggplot(QSummary) +
geom_point(aes(x=date, y=Q..L.s., color=site), size=3) +
theme_classic() +
scale_color_brewer(palette = "Set1") +
ggtitle("ALL SITES")
all
a <- QSummary %>% filter(site == "Moose") %>%
ggplot() +
geom_point(aes(x=date, y=Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose")
a
b <- QSummary %>% filter(site == "French") %>%
ggplot() +
geom_point(aes(x=date, y=Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose")
b
plot_grid(all, NA,
a, b,
nrow = 2, ncol = 2)
QSummary.MO <- QSummary %>% filter(site =="Moose")
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose1comb <- full_join(moos.stream, QSummary.MO)
MOOS1.lm <- lm(Moose1comb$Q..L.s. ~ Moose1comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.1 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose1comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.1
QSummary.MO <- QSummary %>% filter(site =="Moose")
QSummary.MO <- QSummary.MO %>% filter(Q..L.s. < 2500)
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose2comb <- full_join(moos.stream, QSummary.MO)
MOOS2.lm <- lm(Moose2comb$Q..L.s. ~ Moose2comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.2 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose2comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.2
QSummary.MO <- QSummary.MO %>% filter(Q..L.s. < 1300)
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose3comb <- full_join(moos.stream, QSummary.MO)
MOOS3.lm <- lm(Moose3comb$Q..L.s. ~ Moose3comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.3 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose3comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.3
plot_grid(mrc.1, mrc.2,
mrc.3, NA,
ncol = 2, nrow = 2)
Moose1comb$pred.moos1.Q <- coef(MOOS1.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS1.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos1.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
Moose1comb$pred.moos2.Q <- coef(MOOS2.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS2.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos2.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
Moose1comb$pred.moos3.Q <- coef(MOOS3.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS3.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos3.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
ggplot(aes(x=DateTime, y=pred.moos1.Q), data=Moose1comb) +
geom_line(aes(x=DateTime, y=pred.moos1.Q), data=Moose1comb, color="#A6CEE3", size=1.25) +
geom_line(aes(x=DateTime, y=pred.moos2.Q), data=Moose1comb,color="#1F78B4", size=1.25, alpha = 0.75) +
geom_line(aes(x=DateTime, y=pred.moos3.Q), data=Moose1comb,color="brown", size=1.25, alpha = 0.75) +
geom_point(aes(x=DateTime, y=Q..L.s.), size=2) +
theme_classic() +
ggtitle("Moose1(light) & Moose2(dark) predicted all measured Q") +
scale_y_continuous(name="Predicted discharge L/s") +
scale_x_datetime(name = "Time")
QSummary.FR <- QSummary %>% filter(site =="French")
### Rating curve for FRCH PT1 ###
frch.stream$site <- "French" # Add a column identifier
French1comb <- full_join(frch.stream, QSummary.FR) # Join PT data with Discharge
French1.lm <- lm(French1comb$Q..L.s. ~ French1comb$AbsolutePressure) # linear model with discharge and water level
frch.formula <- y ~ x
frc.1 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = French1comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("French1 all measured Q")
frc.1
QSummary.FR <- QSummary %>% filter(site =="French")
QSummary.FR <- QSummary.FR %>% filter(Q..L.s. < 2500)
### Rating curve for FRCH PT1 ###
frch.stream$site <- "French" # Add a column identifier
French2comb <- full_join(frch.stream, QSummary.FR) # Join PT data with Discharge
French2.lm <- lm(French2comb$Q..L.s. ~ French2comb$AbsolutePressure) # linear model with discharge and water level
frch.formula <- y ~ x
frc.2 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = French2comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("French1 all measured Q")
frc.2
French1comb$pred.french1.Q <- coef(French1.lm)[2] * French1comb$AbsolutePressure+ coef(French1.lm)[1]
ggplot(aes(x = DateTime, y = pred.french1.Q), data=French1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("French1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(TZ='America/Anchorage')
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readr)
library(lubridate)
library(rio)
library(neonUtilities)
library(raster)
library(data.table)
library(scales)
library(psych)
library(here)
library(googledrive)
library(readxl)
library(cowplot)
library(zoo)
library(RColorBrewer)
library(gridExtra)
library(ggpmisc)
library(imputeTS)
library(itsmr)
# Import processed Q data
moos.stream.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vTng8WWrBVNB4uN7DHZuq1EfBn8tZ7qA71F7J-2izJUgeTU34LMbyXd_si8ezwscQ/pub?output=csv"
frch.stream.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2WNuEj8PTKLO6OkySK--koXwL6h_f3_WmctQTWkTlyB7boYmX1GmbT1HiVle6nA/pub?output=csv"
moos.stream <- read.csv(url(moos.stream.url), skip = 1)
frch.stream <- read.csv(url(frch.stream.url), skip = 1)
moos.stream <- moos.stream[,-c(3:4)] # Remove Na columns
frch.stream <- frch.stream[,-c(3:4)] # Remove Na columns
# Import summary notes from field book
discharge.2015 <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQC9Bk0nS-Cx4Ec8MyLHd2xNuSv8JTobR8SSV_ODQHAvp4cUK8k3z9EmOs/pub?output=csv"
QSummary <- read.csv(url(discharge.2015))
# Import rain gauge data #
caribou.2015.url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vSolN8YGaUlUlcQjw9EaklcgcJu3b5L80X8Y-xX_ePg-CDOzZ07LDpl-aGBYvLwnvIhLB8Gm5Q66BWk/pub?output=csv"
caribou.2015.gauge <- read.csv(url(caribou.2015.url), skip = 4)
names(caribou.2015.gauge) <- c("DateTimeGMT", "Precip")
caribou.2015.gauge$DateTimeGMT[caribou.2015.gauge$DateTimeGMT == ""] <- NA
caribou.2015.gauge$DateTime = as.POSIXct(caribou.2015.gauge$DateTimeGMT, "%m/%d/%y %H:%M", tz="America/Anchorage")
# Rename columns #
names(moos.stream) <- c("Date", "AbsolutePressure")
names(frch.stream) <- c("Date", "AbsolutePressure")
#Convert time and put in AK time
moos.stream$DateTime <- mdy_hm(moos.stream$Date)
attributes(moos.stream$DateTime)$tzone <-'America/Anchorage'
frch.stream$DateTime <- mdy_hm(frch.stream$Date)
attributes(frch.stream$DateTime)$tzone <-'America/Anchorage'
QSummary$date <- mdy(QSummary$date)
QSummary$DateTime <- as.POSIXct(paste(QSummary$date, QSummary$time), format = "%Y-%m-%d %H:%M", tz = "America/Anchorage")
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
moos.stream <- moos.stream %>% subset(moos.stream$DateTime < "2015-09-20 18:30:00") # PT was taken out on the 21st
#june to july
moos.stream.1 <- moos.stream %>% subset(moos.stream$DateTime < "2015-07-01 00:00:00" & moos.stream$DateTime > "2015-06-01 00:00:00")
plot(moos.stream.1$DateTime, moos.stream.1$AbsolutePressure, type = "l")
which(moos.stream.1$AbsolutePressure < 102)
moos.stream.1[c(4052, 5270:5277), 2] <- NA
#july to august
moos.stream.2 <- moos.stream %>% subset(moos.stream$DateTime < "2015-08-01 00:00:00" & moos.stream$DateTime > "2015-07-01 00:00:00")
plot(moos.stream.2$DateTime, moos.stream.2$AbsolutePressure, type = "l")
which(moos.stream.2$AbsolutePressure < 102)
moos.stream.2$AbsolutePressure[moos.stream.2$AbsolutePressure == "99.188"] <- NA
moos.stream.2[2047, 2] <- NA
#august to September
moos.stream.3 <- moos.stream %>% subset(moos.stream$DateTime < "2015-09-01 00:00:00" & moos.stream$DateTime > "2015-08-01 00:00:00")
plot(moos.stream.3$DateTime, moos.stream.3$AbsolutePressure, type = "l")
which(moos.stream.3$AbsolutePressure < 102)
moos.stream.3[c(2679,2680,2681,2683), 2] <- NA
#September to October
moos.stream.4 <- moos.stream %>% subset(moos.stream$DateTime < "2015-10-01 00:00:00" & moos.stream$DateTime > "2015-09-01 00:00:00")
plot(moos.stream.4$DateTime, moos.stream.4$AbsolutePressure, type = "l")
moos.stream[c(9187, 10405:10412, 15822, 25382:25384, 25386), 2] <- NA
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
moos.stream <- na_kalman(moos.stream)
plot(x = moos.stream$DateTime, y = moos.stream$AbsolutePressure, type = "l")
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
frch.stream <- frch.stream %>%  subset(frch.stream$DateTime < "2015-09-20 18:30:00") # PT was taken out on the 21st
#May to june
frch.stream.1 <- frch.stream %>% subset(frch.stream$DateTime < "2015-06-01 00:00:00" & frch.stream$DateTime > "2015-05-20 00:00:00")
plot(frch.stream.1$DateTime, frch.stream.1$AbsolutePressure, type = "l")
which(frch.stream.1$AbsolutePressure < 102)
frch.stream.1[c(1535, 2047:2060), 2] <- NA
#Juneto july
frch.stream.2 <- frch.stream %>% subset(frch.stream$DateTime < "2015-07-01 00:00:00" & frch.stream$DateTime > "2015-06-01 00:00:00")
plot(frch.stream.2$DateTime, frch.stream.2$AbsolutePressure, type = "l")
which(frch.stream.2$AbsolutePressure < 100)
frch.stream.2[c(49,2052,4111,5213:5241), 2] <- NA
#July to August # no cleaning necessary
frch.stream.3 <- frch.stream %>% subset(frch.stream$DateTime < "2015-08-01 00:00:00" & frch.stream$DateTime > "2015-07-01 00:00:00")
plot(frch.stream.3$DateTime, frch.stream.3$AbsolutePressure, type = "l")
#August to September
frch.stream.4 <- frch.stream %>% subset(frch.stream$DateTime < "2015-09-01 00:00:00" & frch.stream$DateTime > "2015-08-01 00:00:00")
plot(frch.stream.4$DateTime, frch.stream.4$AbsolutePressure, type = "l")
which(frch.stream.4$AbsolutePressure < 100)
frch.stream.4[c(2641:2656, 4631:4654), 2] <- NA
#September to October # no cleaning necessary
frch.stream.5 <- frch.stream %>% subset(frch.stream$DateTime < "2015-10-01 00:00:00" & frch.stream$DateTime > "2015-09-01 00:00:00")
plot(frch.stream.5$DateTime, frch.stream.5$AbsolutePressure, type = "l")
frch.stream[c(3215,3727:3740,5185,7188,9247,10349:10377,25340:25355,27328:27353), 2] <- NA
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
frch.stream <- na_kalman(frch.stream)
plot(caribou.2015.gauge$Precip~ caribou.2015.gauge$DateTime, type="h",
xlim = as.POSIXct(c("2015-05-14 04:05:00","2015-09-22 02:20:00"), tz="America/Anchorage"),
ylim = c(20,0),
axes=F, xlab="", ylab="")
par(new = T)
plot(x = frch.stream$DateTime, y = frch.stream$AbsolutePressure, type = "l")
# ALL Sites #
all <- ggplot(QSummary) +
geom_point(aes(x=date, y=Q..L.s., color=site), size=3) +
theme_classic() +
scale_color_brewer(palette = "Set1") +
ggtitle("ALL SITES")
all
a <- QSummary %>% filter(site == "Moose") %>%
ggplot() +
geom_point(aes(x=date, y=Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose")
a
b <- QSummary %>% filter(site == "French") %>%
ggplot() +
geom_point(aes(x=date, y=Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose")
b
plot_grid(all, NA,
a, b,
nrow = 2, ncol = 2)
QSummary.MO <- QSummary %>% filter(site =="Moose")
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose1comb <- full_join(moos.stream, QSummary.MO)
MOOS1.lm <- lm(Moose1comb$Q..L.s. ~ Moose1comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.1 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose1comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.1
QSummary.MO <- QSummary %>% filter(site =="Moose")
QSummary.MO <- QSummary.MO %>% filter(Q..L.s. < 2500)
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose2comb <- full_join(moos.stream, QSummary.MO)
MOOS2.lm <- lm(Moose2comb$Q..L.s. ~ Moose2comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.2 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose2comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.2
QSummary.MO <- QSummary.MO %>% filter(Q..L.s. < 1300)
# Rating curve for MOOS PT1 #
moos.stream$site <- "Moose"
Moose3comb <- full_join(moos.stream, QSummary.MO)
MOOS3.lm <- lm(Moose3comb$Q..L.s. ~ Moose3comb$AbsolutePressure)
moos.formula <- y ~ x
mrc.3 <- ggplot(aes(x = AbsolutePressure, y = Q..L.s.), data = Moose3comb) +
geom_point(size = 3) +
geom_smooth(method = "lm", se=FALSE) +
stat_poly_eq(formula = moos.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic() +
ggtitle("Moose1 all measured Q")
mrc.3
plot_grid(mrc.1, mrc.2,
mrc.3, NA,
ncol = 2, nrow = 2)
Moose1comb$pred.moos1.Q <- coef(MOOS1.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS1.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos1.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
Moose1comb$pred.moos2.Q <- coef(MOOS2.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS2.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos2.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
Moose1comb$pred.moos3.Q <- coef(MOOS3.lm)[2] * Moose1comb$AbsolutePressure+ coef(MOOS3.lm)[1]
ggplot(aes(x = DateTime, y = pred.moos3.Q), data = Moose1comb) +
geom_line(color="#A6CEE3", size=1.25) +
geom_point(aes(x = DateTime, y = Q..L.s.), size=3) +
theme_classic() +
ggtitle("Moose1 predicted all measured Q") +
xlab("Date") +
ylab("Predicted Discharge")
ggplot(aes(x=DateTime, y=pred.moos1.Q), data=Moose1comb) +
geom_line(aes(x=DateTime, y=pred.moos1.Q), data=Moose1comb, color="#A6CEE3", size=1.25) +
geom_line(aes(x=DateTime, y=pred.moos2.Q), data=Moose1comb,color="#1F78B4", size=1.25, alpha = 0.75) +
geom_line(aes(x=DateTime, y=pred.moos3.Q), data=Moose1comb,color="brown", size=1.25, alpha = 0.75) +
geom_point(aes(x=DateTime, y=Q..L.s.), size=2) +
theme_classic() +
ggtitle("Moose1(light) & Moose2(dark) predicted all measured Q") +
scale_y_continuous(name="Predicted discharge L/s") +
scale_x_datetime(name = "Time")
