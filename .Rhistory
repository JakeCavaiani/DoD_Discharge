ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
rlang::last_error()
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p)
multiplot(STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p)
str(STRT_storm2_07_09_NO3)
str(STRT_storm2_07_09_fDOM)
multiplot(STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p)
multiplot(STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p)
plot_grid(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
plot_grid(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
ncol = 7)
#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(datavalue),
y=(datavalue),
color = as.numeric(valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
STRT_storm1a_06_19_NO3.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_NO3, "STRT", "NO3", "1a")
STRT_storm1b_06_20_NO3.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_NO3, "STRT", "NO3", "1b")
STRT_storm1c_06_22_NO3.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_NO3, "STRT", "NO3", "1c")
STRT_storm1d_06_23_NO3.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_NO3, "STRT", "NO3", "1d")
STRT_storm1e_06_24_NO3.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_NO3, "STRT", "NO3", "1e")
STRT_storm2_07_09_NO3.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, "STRT", "NO3", "2")
STRT_storm3_07_21_NO3.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_NO3, "STRT", "NO3", "3")
STRT_storm4a_08_01_NO3.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, "STRT", "NO3", "4a")
STRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
STRT_storm5_08_09_NO3.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, "STRT", "NO3", "5")
STRT_storm6_08_12_NO3.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, "STRT", "NO3", "6")
STRT_storm7a_08_20_NO3.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, "STRT", "NO3", "7a")
STRT_storm7b_08_21_NO3.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, "STRT", "NO3", "7b")
STRT_storm8_08_28_NO3.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, "STRT", "NO3", "8")
STRT_storm9a_09_03_NO3.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, "STRT", "NO3", "9a")
STRT_storm9b_09_06_NO3.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, "STRT", "NO3", "9b")
STRT_storm9c_09_09_NO3.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, "STRT", "NO3", "9c")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "10")
STRT_storm1a_06_19_fDOM.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_fDOM, "STRT", "fDOM", "1a")
STRT_storm1b_06_20_fDOM.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_fDOM, "STRT", "fDOM", "1b")
STRT_storm1c_06_22_fDOM.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_fDOM, "STRT", "fDOM", "1c")
STRT_storm1d_06_23_fDOM.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_fDOM, "STRT", "fDOM", "1d")
STRT_storm1e_06_24_fDOM.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_fDOM, "STRT", "fDOM", "1e")
STRT_storm2_07_09_fDOM.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, "STRT", "fDOM", "2")
STRT_storm3_07_21_fDOM.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_fDOM, "STRT", "fDOM", "3")
STRT_storm4a_08_01_fDOM.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, "STRT", "fDOM", "4a")
STRT_storm4b_08_03_fDOM.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_fDOM, "STRT", "fDOM", "4b")
STRT_storm5_08_09_fDOM.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, "STRT", "fDOM", "5")
STRT_storm6_08_12_fDOM.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, "STRT", "fDOM", "6")
STRT_storm7a_08_20_fDOM.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, "STRT", "fDOM", "7a")
STRT_storm7b_08_21_fDOM.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, "STRT", "fDOM", "7b")
STRT_storm8_08_28_fDOM.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, "STRT", "fDOM", "8")
STRT_storm9a_09_03_fDOM.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, "STRT", "fDOM", "9a")
STRT_storm9b_09_06_fDOM.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, "STRT", "fDOM", "9b")
STRT_storm9c_09_09_fDOM.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, "STRT", "fDOM", "9c")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "10")
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(datavalue),
color = as.numeric(valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
STRT_storm1a_06_19_NO3.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_NO3, "STRT", "NO3", "1a")
STRT_storm1b_06_20_NO3.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_NO3, "STRT", "NO3", "1b")
STRT_storm1c_06_22_NO3.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_NO3, "STRT", "NO3", "1c")
STRT_storm1d_06_23_NO3.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_NO3, "STRT", "NO3", "1d")
STRT_storm1e_06_24_NO3.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_NO3, "STRT", "NO3", "1e")
STRT_storm2_07_09_NO3.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, "STRT", "NO3", "2")
STRT_storm3_07_21_NO3.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_NO3, "STRT", "NO3", "3")
STRT_storm4a_08_01_NO3.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, "STRT", "NO3", "4a")
STRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
STRT_storm5_08_09_NO3.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, "STRT", "NO3", "5")
STRT_storm6_08_12_NO3.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, "STRT", "NO3", "6")
STRT_storm7a_08_20_NO3.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, "STRT", "NO3", "7a")
STRT_storm7b_08_21_NO3.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, "STRT", "NO3", "7b")
STRT_storm8_08_28_NO3.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, "STRT", "NO3", "8")
STRT_storm9a_09_03_NO3.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, "STRT", "NO3", "9a")
STRT_storm9b_09_06_NO3.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, "STRT", "NO3", "9b")
STRT_storm9c_09_09_NO3.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, "STRT", "NO3", "9c")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "10")
STRT_storm1a_06_19_fDOM.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_fDOM, "STRT", "fDOM", "1a")
STRT_storm1b_06_20_fDOM.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_fDOM, "STRT", "fDOM", "1b")
STRT_storm1c_06_22_fDOM.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_fDOM, "STRT", "fDOM", "1c")
STRT_storm1d_06_23_fDOM.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_fDOM, "STRT", "fDOM", "1d")
STRT_storm1e_06_24_fDOM.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_fDOM, "STRT", "fDOM", "1e")
STRT_storm2_07_09_fDOM.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, "STRT", "fDOM", "2")
STRT_storm3_07_21_fDOM.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_fDOM, "STRT", "fDOM", "3")
STRT_storm4a_08_01_fDOM.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, "STRT", "fDOM", "4a")
STRT_storm4b_08_03_fDOM.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_fDOM, "STRT", "fDOM", "4b")
STRT_storm5_08_09_fDOM.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, "STRT", "fDOM", "5")
STRT_storm6_08_12_fDOM.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, "STRT", "fDOM", "6")
STRT_storm7a_08_20_fDOM.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, "STRT", "fDOM", "7a")
STRT_storm7b_08_21_fDOM.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, "STRT", "fDOM", "7b")
STRT_storm8_08_28_fDOM.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, "STRT", "fDOM", "8")
STRT_storm9a_09_03_fDOM.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, "STRT", "fDOM", "9a")
STRT_storm9b_09_06_fDOM.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, "STRT", "fDOM", "9b")
STRT_storm9c_09_09_fDOM.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, "STRT", "fDOM", "9c")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "10")
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
STRT_storm1a_06_19_NO3.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_NO3, "STRT", "NO3", "1a")
STRT_storm1b_06_20_NO3.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_NO3, "STRT", "NO3", "1b")
STRT_storm1c_06_22_NO3.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_NO3, "STRT", "NO3", "1c")
STRT_storm1d_06_23_NO3.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_NO3, "STRT", "NO3", "1d")
STRT_storm1e_06_24_NO3.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_NO3, "STRT", "NO3", "1e")
STRT_storm2_07_09_NO3.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, "STRT", "NO3", "2")
STRT_storm3_07_21_NO3.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_NO3, "STRT", "NO3", "3")
STRT_storm4a_08_01_NO3.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, "STRT", "NO3", "4a")
STRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
STRT_storm5_08_09_NO3.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, "STRT", "NO3", "5")
STRT_storm6_08_12_NO3.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, "STRT", "NO3", "6")
STRT_storm7a_08_20_NO3.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, "STRT", "NO3", "7a")
STRT_storm7b_08_21_NO3.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, "STRT", "NO3", "7b")
STRT_storm8_08_28_NO3.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, "STRT", "NO3", "8")
STRT_storm9a_09_03_NO3.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, "STRT", "NO3", "9a")
STRT_storm9b_09_06_NO3.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, "STRT", "NO3", "9b")
STRT_storm9c_09_09_NO3.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, "STRT", "NO3", "9c")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "10")
STRT_storm1a_06_19_fDOM.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_fDOM, "STRT", "fDOM", "1a")
STRT_storm1b_06_20_fDOM.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_fDOM, "STRT", "fDOM", "1b")
STRT_storm1c_06_22_fDOM.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_fDOM, "STRT", "fDOM", "1c")
STRT_storm1d_06_23_fDOM.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_fDOM, "STRT", "fDOM", "1d")
STRT_storm1e_06_24_fDOM.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_fDOM, "STRT", "fDOM", "1e")
STRT_storm2_07_09_fDOM.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, "STRT", "fDOM", "2")
STRT_storm3_07_21_fDOM.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_fDOM, "STRT", "fDOM", "3")
STRT_storm4a_08_01_fDOM.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, "STRT", "fDOM", "4a")
STRT_storm4b_08_03_fDOM.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_fDOM, "STRT", "fDOM", "4b")
STRT_storm5_08_09_fDOM.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, "STRT", "fDOM", "5")
STRT_storm6_08_12_fDOM.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, "STRT", "fDOM", "6")
STRT_storm7a_08_20_fDOM.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, "STRT", "fDOM", "7a")
STRT_storm7b_08_21_fDOM.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, "STRT", "fDOM", "7b")
STRT_storm8_08_28_fDOM.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, "STRT", "fDOM", "8")
STRT_storm9a_09_03_fDOM.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, "STRT", "fDOM", "9a")
STRT_storm9b_09_06_fDOM.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, "STRT", "fDOM", "9b")
STRT_storm9c_09_09_fDOM.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, "STRT", "fDOM", "9c")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "10")
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
multiplot(STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p)
head(STRT_storm1a_06_19_Q)
head(STRT_storm1a_06_19_NO3)
#### fxn: plot hysteresis loop ####
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(dat_Q$valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
STRT_storm1a_06_19_NO3.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_NO3, "STRT", "NO3", "1a")
STRT_storm1b_06_20_NO3.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_NO3, "STRT", "NO3", "1b")
STRT_storm1c_06_22_NO3.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_NO3, "STRT", "NO3", "1c")
STRT_storm1d_06_23_NO3.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_NO3, "STRT", "NO3", "1d")
STRT_storm1e_06_24_NO3.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_NO3, "STRT", "NO3", "1e")
STRT_storm2_07_09_NO3.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, "STRT", "NO3", "2")
STRT_storm3_07_21_NO3.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_NO3, "STRT", "NO3", "3")
STRT_storm4a_08_01_NO3.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, "STRT", "NO3", "4a")
STRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
STRT_storm5_08_09_NO3.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, "STRT", "NO3", "5")
STRT_storm6_08_12_NO3.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, "STRT", "NO3", "6")
STRT_storm7a_08_20_NO3.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, "STRT", "NO3", "7a")
STRT_storm7b_08_21_NO3.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, "STRT", "NO3", "7b")
STRT_storm8_08_28_NO3.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, "STRT", "NO3", "8")
STRT_storm9a_09_03_NO3.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, "STRT", "NO3", "9a")
STRT_storm9b_09_06_NO3.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, "STRT", "NO3", "9b")
STRT_storm9c_09_09_NO3.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, "STRT", "NO3", "9c")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "10")
STRT_storm1a_06_19_fDOM.p = hyst_plot(STRT_storm1a_06_19_Q, STRT_storm1a_06_19_fDOM, "STRT", "fDOM", "1a")
STRT_storm1b_06_20_fDOM.p = hyst_plot(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_fDOM, "STRT", "fDOM", "1b")
STRT_storm1c_06_22_fDOM.p = hyst_plot(STRT_storm1c_06_22_Q, STRT_storm1c_06_22_fDOM, "STRT", "fDOM", "1c")
STRT_storm1d_06_23_fDOM.p = hyst_plot(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_fDOM, "STRT", "fDOM", "1d")
STRT_storm1e_06_24_fDOM.p = hyst_plot(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_fDOM, "STRT", "fDOM", "1e")
STRT_storm2_07_09_fDOM.p = hyst_plot(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, "STRT", "fDOM", "2")
STRT_storm3_07_21_fDOM.p = hyst_plot(STRT_storm3_07_21_Q, STRT_storm3_07_21_fDOM, "STRT", "fDOM", "3")
STRT_storm4a_08_01_fDOM.p = hyst_plot(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, "STRT", "fDOM", "4a")
STRT_storm4b_08_03_fDOM.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_fDOM, "STRT", "fDOM", "4b")
STRT_storm5_08_09_fDOM.p = hyst_plot(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, "STRT", "fDOM", "5")
STRT_storm6_08_12_fDOM.p = hyst_plot(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, "STRT", "fDOM", "6")
STRT_storm7a_08_20_fDOM.p = hyst_plot(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, "STRT", "fDOM", "7a")
STRT_storm7b_08_21_fDOM.p = hyst_plot(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, "STRT", "fDOM", "7b")
STRT_storm8_08_28_fDOM.p = hyst_plot(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, "STRT", "fDOM", "8")
STRT_storm9a_09_03_fDOM.p = hyst_plot(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, "STRT", "fDOM", "9a")
STRT_storm9b_09_06_fDOM.p = hyst_plot(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, "STRT", "fDOM", "9b")
STRT_storm9c_09_09_fDOM.p = hyst_plot(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, "STRT", "fDOM", "9c")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "10")
STRT_storm10_09_23_NO3.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, "STRT", "NO3", "10")
STRT_storm10_09_23_fDOM.p = hyst_plot(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, "STRT", "fDOM", "10")
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p,
STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p,
STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p,
STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p,
STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p,
STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p,
STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p,
STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p,
STRT_storm4b_08_03_NO3.p, STRT_storm4b_08_03_fDOM.p,
STRT_storm5_08_09_NO3.p, STRT_storm5_08_09_fDOM.p,
STRT_storm6_08_12_NO3.p, STRT_storm6_08_12_fDOM.p,
STRT_storm7a_08_20_NO3.p, STRT_storm7a_08_20_fDOM.p,
STRT_storm7b_08_21_NO3.p, STRT_storm7b_08_21_fDOM.p,
STRT_storm8_08_28_NO3.p, STRT_storm8_08_28_fDOM.p,
STRT_storm9a_09_03_NO3.p, STRT_storm9a_09_03_fDOM.p,
STRT_storm9b_09_06_NO3.p, STRT_storm9b_09_06_fDOM.p,
STRT_storm9c_09_09_NO3.p, STRT_storm9c_09_09_fDOM.p,
STRT_storm10_09_23_NO3.p, STRT_storm10_09_23_fDOM.p,
cols = 7)
multiplot(STRT_storm1b_06_20_NO3.p, STRT_storm1b_06_20_fDOM.p)
multiplot(STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p)
multiplot(STRT_storm1a_06_19_NO3.p, STRT_storm1a_06_19_fDOM.p)
multiplot(STRT_storm1c_06_22_NO3.p, STRT_storm1c_06_22_fDOM.p)
multiplot(STRT_storm1d_06_23_NO3.p, STRT_storm1d_06_23_fDOM.p)
multiplot(STRT_storm1e_06_24_NO3.p, STRT_storm1e_06_24_fDOM.p)
multiplot(STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p)
multiplot(STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p)
multiplot(STRT_storm2_07_09_NO3.p, STRT_storm2_07_09_fDOM.p)
head(STRT_storm2_07_09_fDOM)
multiplot(STRT_storm3_07_21_NO3.p, STRT_storm3_07_21_fDOM.p)
multiplot(STRT_storm4a_08_01_NO3.p, STRT_storm4a_08_01_fDOM.p)
multiplot(STRT_storm4b_08_01_NO3.p, STRT_storm4b_08_01_fDOM.p)
xSTRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
STRT_storm4b_08_03_NO3.p = hyst_plot(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, "STRT", "NO3", "4b")
multiplot(STRT_storm4b_08_01_NO3.p, STRT_storm4b_08_01_fDOM.p)
### load packages ###
library(tidyverse)
library(lubridate)
library(data.table)
library(rio)
library(ggplot2)
library(scales)
library(psych)
library(here)
library(googledrive)
library(readxl)
library(cowplot)
library(zoo)
library(readr)
library(dplyr)
library(RColorBrewer)
library(gridExtra)
library(ggpmisc)
library(here)
dir.create(here("PT_data"))
dir.create(here("PT_data", "clean"))
setwd(here("PT_data", "clean"))
